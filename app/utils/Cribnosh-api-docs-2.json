{"openapi":"3.0.3","info":{"title":"CribNosh API","version":"1.0.0","description":"API documentation for CribNosh - Personalized meal platform with modern, glossy, culturally-aware design.","contact":{"name":"CribNosh Support","email":"support@cribnosh.com"},"license":{"name":"Cribnosh Private Collab Licence","url":""}},"servers":[{"url":"https://cribnosh.com/api","description":"Production server"}],"tags":[{"name":"Authentication","description":"User authentication and authorization endpoints"},{"name":"Admin","description":"Administrative operations and platform management"},{"name":"Customer","description":"Customer-specific operations and data management"},{"name":"Chef","description":"Chef-specific operations and meal management"},{"name":"Staff","description":"Staff operations and internal management"},{"name":"Orders","description":"Order management and processing"},{"name":"Payments","description":"Payment processing and financial operations"},{"name":"Reviews","description":"Review and rating system"},{"name":"Analytics","description":"Analytics and data tracking"},{"name":"Monitoring","description":"System monitoring and health checks"},{"name":"Live Streaming","description":"Live streaming and real-time features"},{"name":"Notifications","description":"User notification management"},{"name":"Webhooks","description":"Webhook endpoints for external integrations"},{"name":"Email","description":"Email service integration"},{"name":"AI","description":"AI-powered features and recommendations"},{"name":"Integrations","description":"External service integrations"},{"name":"Sync","description":"Data synchronization services"},{"name":"System","description":"System utilities and core operations"},{"name":"Delivery","description":"Delivery management and driver operations"},{"name":"Chat","description":"Real-time messaging and communication"},{"name":"Messaging","description":"User messaging and conversation management"},{"name":"Waitlist","description":"Waitlist management and user onboarding"},{"name":"Refunds","description":"Refund processing and eligibility management"},{"name":"Meals","description":"Meal creation and management"},{"name":"Profile","description":"User profile management"},{"name":"User Management","description":"User administration and management"},{"name":"Dishes","description":"Dish and menu item management"},{"name":"Notices","description":"Staff notices and announcements"},{"name":"Announcements","description":"System announcements and communications"},{"name":"Availability","description":"Chef availability and scheduling management"},{"name":"Tracking","description":"Delivery tracking and status updates"},{"name":"Custom Orders","description":"Custom order management and processing"},{"name":"History","description":"Payment and transaction history"},{"name":"Cards","description":"Payment card management"},{"name":"Status","description":"Payment and order status tracking"},{"name":"Applications","description":"Chef and staff application management"},{"name":"Onboarding","description":"User onboarding and application processes"},{"name":"Conversations","description":"Chat conversation management"},{"name":"Drivers","description":"Delivery driver management and tracking"},{"name":"Sales","description":"Sales analytics and revenue tracking"},{"name":"Documents","description":"Document upload and management"},{"name":"Order Management","description":"Order lifecycle and management operations"},{"name":"History","description":"Order and transaction history tracking"},{"name":"Messaging","description":"Order-related messaging and communication"},{"name":"Notes","description":"Order notes and annotations"},{"name":"Preparation","description":"Order preparation and cooking processes"},{"name":"Delivery","description":"Order delivery and fulfillment processes"},{"name":"Mattermost","description":"Mattermost team communication integration"},{"name":"Early Access","description":"Early access and waitlist management"}],"components":{"securitySchemes":{"bearerAuth":{"type":"http","scheme":"bearer","bearerFormat":"JWT","description":"JWT token for API authentication. Include as \"Bearer {token}\" in Authorization header."},"cookieAuth":{"type":"apiKey","in":"cookie","name":"convex-auth-token","description":"Session token stored in HTTP-only cookie for authentication."}},"schemas":{"Error":{"type":"object","properties":{"error":{"type":"string","description":"Error message"},"details":{"type":"object","description":"Additional error details"},"code":{"type":"string","description":"Error code"}},"required":["error"]},"Success":{"type":"object","properties":{"success":{"type":"boolean","description":"Success status"},"data":{"type":"object","description":"Response data"},"message":{"type":"string","description":"Success message"}},"required":["success"]}}},"security":[{"bearerAuth":[]},{"cookieAuth":[]}],"paths":{"/":{"get":{"summary":"API Welcome Endpoint","description":"Welcome endpoint that confirms the API is working and accessible","tags":["System"],"responses":{"200":{"description":"API is working successfully","content":{"application/json":{"schema":{"type":"object","properties":{"success":{"type":"boolean","example":true},"data":{"type":"object","properties":{"message":{"type":"string","example":"Welcome to the CribNosh API! The API is working."}}},"message":{"type":"string","example":"Success"}}}}}}},"security":[]}},"/reviews":{"get":{"summary":"Get All Reviews","description":"Get paginated list of all reviews with filtering options","tags":["Reviews"],"parameters":[{"in":"query","name":"limit","schema":{"type":"integer","minimum":1,"maximum":100,"default":20},"description":"Number of reviews to return","example":20},{"in":"query","name":"offset","schema":{"type":"integer","minimum":0,"default":0},"description":"Number of reviews to skip","example":0}],"responses":{"200":{"description":"Reviews retrieved successfully","content":{"application/json":{"schema":{"type":"object","properties":{"success":{"type":"boolean","example":true},"data":{"type":"object","properties":{"reviews":{"type":"array","description":"Array of reviews","items":{"type":"object","properties":{"_id":{"type":"string","description":"Review ID","example":"j1234567890abcdef"},"user_id":{"type":"string","description":"User ID who wrote the review","example":"j1234567890abcdef"},"meal_id":{"type":"string","description":"Meal ID being reviewed","example":"j1234567890abcdef"},"rating":{"type":"number","minimum":1,"maximum":5,"description":"Rating from 1 to 5","example":4},"comment":{"type":"string","nullable":true,"description":"Review comment","example":"Great meal, highly recommended!"},"status":{"type":"string","enum":["pending","approved","rejected"],"description":"Review status","example":"approved"},"createdAt":{"type":"number","description":"Review creation timestamp","example":1640995200000}}}},"total":{"type":"number","description":"Total number of reviews","example":150},"limit":{"type":"number","description":"Number of reviews returned","example":20},"offset":{"type":"number","description":"Number of reviews skipped","example":0}}},"message":{"type":"string","example":"Success"}}}}}},"401":{"description":"Unauthorized - invalid or missing authentication","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}},"500":{"description":"Internal server error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}}},"security":[{"bearerAuth":[]}]},"post":{"summary":"Create Review","description":"Create a new review for a meal (only for meals the user has ordered)","tags":["Reviews"],"requestBody":{"required":true,"content":{"application/json":{"schema":{"type":"object","required":["meal_id","rating"],"properties":{"meal_id":{"type":"string","description":"ID of the meal being reviewed","example":"j1234567890abcdef"},"rating":{"type":"number","minimum":1,"maximum":5,"description":"Rating from 1 to 5 stars","example":4},"comment":{"type":"string","nullable":true,"description":"Optional review comment","example":"Great meal, highly recommended!"}}}}}},"responses":{"200":{"description":"Review created successfully","content":{"application/json":{"schema":{"type":"object","properties":{"success":{"type":"boolean","example":true},"data":{"type":"object","properties":{"success":{"type":"boolean","example":true},"reviewId":{"type":"string","description":"Created review ID","example":"j1234567890abcdef"}}},"message":{"type":"string","example":"Success"}}}}}},"401":{"description":"Unauthorized - invalid or missing authentication","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}},"403":{"description":"Forbidden - can only review meals you have ordered","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}},"422":{"description":"Validation error - missing required fields or invalid rating","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}},"500":{"description":"Internal server error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}}},"security":[{"bearerAuth":[]}]}},"/api/reviews/index":{"get":{"summary":"Get reviews index","description":"Get the reviews index page with statistics and recent reviews","tags":["Reviews"],"responses":{"200":{"description":"Reviews index retrieved successfully","content":{"application/json":{"schema":{"type":"object","properties":{"success":{"type":"boolean"},"data":{"type":"object","properties":{"totalReviews":{"type":"number"},"averageRating":{"type":"number"},"recentReviews":{"type":"array","items":{"type":"object"}},"topRatedChefs":{"type":"array","items":{"type":"object"}},"topRatedDishes":{"type":"array","items":{"type":"object"}}}}}}}}},"500":{"description":"Internal server error"}}}},"/api/live-streaming/viewers":{"get":{"summary":"Get live viewers","description":"Get live stream viewers","tags":["Live Streaming"],"responses":{"200":{"description":"Live viewers retrieved successfully","content":{"application/json":{"schema":{"type":"object","properties":{"message":{"type":"string"},"data":{"type":"array"}}}}}},"500":{"description":"Internal server error"}}}},"/api/live-streaming/sessions":{"get":{"summary":"Get live streaming sessions","description":"Get all live streaming sessions with filtering and pagination","tags":["Live Streaming"],"parameters":[{"in":"query","name":"status","schema":{"type":"string","enum":["active","ended","scheduled"]},"description":"Filter sessions by status"},{"in":"query","name":"limit","schema":{"type":"integer","minimum":1,"maximum":100,"default":20},"description":"Number of sessions to return"},{"in":"query","name":"offset","schema":{"type":"integer","minimum":0,"default":0},"description":"Number of sessions to skip"}],"responses":{"200":{"description":"Live sessions retrieved successfully","content":{"application/json":{"schema":{"type":"object","properties":{"success":{"type":"boolean"},"data":{"type":"array","items":{"type":"object"}},"pagination":{"type":"object"}}}}}},"500":{"description":"Internal server error"}}}},"/live-streaming/comments":{"post":{"summary":"Send Live Comment","description":"Send a comment to a live streaming session","tags":["Live Streaming"],"requestBody":{"required":true,"content":{"application/json":{"schema":{"type":"object","required":["sessionId","content","commentType"],"properties":{"sessionId":{"type":"string","description":"ID of the live session","example":"j1234567890abcdef"},"content":{"type":"string","description":"Comment content","example":"This looks amazing! Can you share the recipe?"},"commentType":{"type":"string","enum":["general","question","reaction","tip","moderation"],"description":"Type of comment","example":"question"},"metadata":{"type":"object","nullable":true,"description":"Additional comment metadata","example":{"reaction":"heart","tipAmount":5}}}}}}},"responses":{"200":{"description":"Comment sent successfully","content":{"application/json":{"schema":{"type":"object","properties":{"success":{"type":"boolean","example":true},"data":{"type":"object","properties":{"success":{"type":"boolean","example":true},"sessionId":{"type":"string","example":"j1234567890abcdef"},"comment":{"type":"object","nullable":true,"description":"Created comment details","properties":{"id":{"type":"string","example":"j1234567890abcdef"},"content":{"type":"string","example":"This looks amazing! Can you share the recipe?"},"commentType":{"type":"string","example":"question"},"sentBy":{"type":"string","example":"j1234567890abcdef"},"sentByRole":{"type":"string","example":"customer"},"sentAt":{"type":"string","format":"date-time","example":"2024-01-15T10:30:00.000Z"},"metadata":{"type":"object","example":{"reaction":"heart","tipAmount":5}}}},"message":{"type":"string","example":"Live comment sent successfully."}}},"message":{"type":"string","example":"Success"}}}}}},"400":{"description":"Validation error - missing required fields or session not active","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}},"401":{"description":"Unauthorized - invalid or missing authentication","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}},"403":{"description":"Forbidden - user is muted in this session","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}},"404":{"description":"Live session not found","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}},"500":{"description":"Internal server error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}}},"security":[{"bearerAuth":[]}]}},"/api/live-streaming/chef":{"get":{"summary":"Get chef live streaming","description":"Get chef live streaming data","tags":["Live Streaming"],"responses":{"200":{"description":"Chef live streaming retrieved successfully","content":{"application/json":{"schema":{"type":"object","properties":{"message":{"type":"string"},"data":{"type":"object"}}}}}},"500":{"description":"Internal server error"}}}},"/api/live-streaming/moderator":{"get":{"summary":"Get moderator live streaming","description":"Get moderator live streaming data","tags":["Live Streaming"],"responses":{"200":{"description":"Moderator live streaming retrieved successfully","content":{"application/json":{"schema":{"type":"object","properties":{"message":{"type":"string"},"data":{"type":"object"}}}}}},"500":{"description":"Internal server error"}}}},"/api/live-streaming/orders":{"get":{"summary":"Get live orders","description":"Get orders from live streaming","tags":["Live Streaming"],"responses":{"200":{"description":"Live orders retrieved successfully","content":{"application/json":{"schema":{"type":"object","properties":{"message":{"type":"string"},"data":{"type":"array"}}}}}},"500":{"description":"Internal server error"}}}},"/api/live-streaming/customer":{"get":{"summary":"Get customer live streaming","description":"Get customer live streaming data","tags":["Live Streaming"],"responses":{"200":{"description":"Customer live streaming retrieved successfully","content":{"application/json":{"schema":{"type":"object","properties":{"message":{"type":"string"},"data":{"type":"object"}}}}}},"500":{"description":"Internal server error"}}}},"/api/live-streaming/admin":{"get":{"summary":"Get admin live streaming","description":"Get admin live streaming data","tags":["Live Streaming"],"responses":{"200":{"description":"Admin live streaming retrieved successfully","content":{"application/json":{"schema":{"type":"object","properties":{"message":{"type":"string"},"data":{"type":"object"}}}}}},"500":{"description":"Internal server error"}}}},"/api/live-streaming/chat":{"get":{"summary":"Get live chat","description":"Get live chat messages","tags":["Live Streaming"],"responses":{"200":{"description":"Live chat retrieved successfully","content":{"application/json":{"schema":{"type":"object","properties":{"message":{"type":"string"},"data":{"type":"array"}}}}}},"500":{"description":"Internal server error"}}}},"/mattermost":{"post":{"summary":"Send Mattermost Notification","description":"Send notifications to Mattermost channels for team communication and alerts","tags":["Integrations","Notifications"],"requestBody":{"required":true,"content":{"application/json":{"schema":{"type":"object","required":["type"],"properties":{"type":{"type":"string","enum":["test","custom","system-health"],"description":"Type of notification to send","example":"custom"},"channel":{"type":"string","nullable":true,"description":"Target channel ID (uses default if not provided)","example":"channel1234567890abcdef"},"message":{"type":"string","nullable":true,"description":"Custom message content (required for 'custom' type)","example":"New order received: #12345 for Â£25.99"},"data":{"type":"object","nullable":true,"description":"Additional data for system-health notifications","properties":{"status":{"type":"string","enum":["healthy","degraded","unhealthy"],"example":"healthy"},"message":{"type":"string","example":"System health check completed"},"details":{"type":"object","nullable":true,"description":"Additional health check details","example":{"uptime":86400,"memory":"512MB"}}}}}}}}},"responses":{"200":{"description":"Notification sent successfully","content":{"application/json":{"schema":{"type":"object","properties":{"success":{"type":"boolean","example":true},"data":{"type":"object","properties":{"success":{"type":"boolean","example":true},"message":{"type":"string","example":"Mattermost notification sent successfully"},"type":{"type":"string","example":"custom"}}},"message":{"type":"string","example":"Success"}}}}}},"400":{"description":"Validation error - invalid type or missing message","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}},"500":{"description":"Internal server error or external service error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}},"503":{"description":"Service unavailable - Mattermost not configured","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}}},"security":[],"x-integration":{"description":"This endpoint integrates with Mattermost for team notifications:\n\n**Notification Types:**\n- `test`: Send a test message to verify configuration\n- `custom`: Send a custom message with specified content\n- `system-health`: Send system health status notifications\n\n**Configuration:**\n- Requires either MATTERMOST_WEBHOOK_URL or MATTERMOST_BOT_TOKEN + MATTERMOST_SERVER_URL\n- Uses MATTERMOST_CHANNEL_ID as default channel if not specified\n- Supports both webhook and API-based messaging\n\n**Use Cases:**\n- Order notifications for kitchen staff\n- System alerts for admin team\n- Customer service notifications\n- Development team updates\n"}}},"/custom_orders":{"get":{"summary":"Get Custom Orders","description":"Retrieve paginated list of custom orders for the authenticated user","tags":["Custom Orders","Orders"],"parameters":[{"in":"query","name":"limit","schema":{"type":"integer","minimum":1,"maximum":100,"default":20},"description":"Number of orders to return","example":20},{"in":"query","name":"offset","schema":{"type":"integer","minimum":0,"default":0},"description":"Number of orders to skip","example":0}],"responses":{"200":{"description":"Custom orders retrieved successfully","content":{"application/json":{"schema":{"type":"object","properties":{"success":{"type":"boolean","example":true},"data":{"type":"object","properties":{"orders":{"type":"array","description":"Array of custom orders","items":{"type":"object","properties":{"_id":{"type":"string","description":"Custom order ID","example":"j1234567890abcdef"},"userId":{"type":"string","description":"User ID who created the order","example":"j1234567890abcdef"},"requirements":{"type":"string","description":"Custom order requirements","example":"Gluten-free pasta with vegan cheese"},"serving_size":{"type":"number","description":"Number of servings","example":4},"desired_delivery_time":{"type":"string","format":"date-time","description":"Preferred delivery time","example":"2024-01-15T18:00:00.000Z"},"custom_order_id":{"type":"string","description":"Public custom order ID","example":"CUST-12345"},"order_id":{"type":"string","description":"Associated regular order ID","example":"ORD-12345"},"status":{"type":"string","enum":["pending","processing","completed","cancelled"],"description":"Order status","example":"processing"},"dietary_restrictions":{"type":"string","nullable":true,"description":"Dietary restrictions","example":"gluten-free, vegan"},"createdAt":{"type":"number","description":"Creation timestamp","example":1640995200000},"updatedAt":{"type":"number","nullable":true,"description":"Last update timestamp","example":1640995200000}}}},"total":{"type":"number","description":"Total number of custom orders","example":25},"limit":{"type":"number","example":20},"offset":{"type":"number","example":0}}},"message":{"type":"string","example":"Success"}}}}}},"401":{"description":"Unauthorized - invalid or missing authentication","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}},"500":{"description":"Internal server error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}}},"security":[{"bearerAuth":[]}]}},"/api/messaging":{"get":{"summary":"Get messaging overview","description":"Get messaging system overview with statistics and recent activity","tags":["Messaging"],"responses":{"200":{"description":"Messaging overview retrieved successfully","content":{"application/json":{"schema":{"type":"object","properties":{"success":{"type":"boolean"},"data":{"type":"object","properties":{"totalChats":{"type":"number"},"activeUsers":{"type":"number"},"recentMessages":{"type":"array","items":{"type":"object"}},"messagingStats":{"type":"object"},"topChatters":{"type":"array","items":{"type":"object"}}}}}}}}},"500":{"description":"Internal server error"}}}},"/health":{"get":{"summary":"Health check endpoint","description":"Check the health status of all services and systems","tags":["System"],"responses":{"200":{"description":"Health check completed successfully","content":{"application/json":{"schema":{"type":"object","properties":{"timestamp":{"type":"string","format":"date-time","description":"Timestamp of the health check","example":"2024-01-15T10:30:00.000Z"},"status":{"type":"string","enum":["healthy","degraded","unhealthy"],"description":"Overall system health status","example":"healthy"},"version":{"type":"string","description":"Application version","example":"1.0.0"},"environment":{"type":"string","description":"Environment name","example":"production"},"services":{"type":"object","description":"Health status of individual services","properties":{"email":{"type":"object","properties":{"status":{"type":"string","enum":["healthy","unhealthy","unknown"]},"details":{"type":"string"}}},"notion":{"type":"object","properties":{"status":{"type":"string","enum":["healthy","unhealthy","unknown"]},"details":{"type":"string"}}},"monitoring":{"type":"object","properties":{"status":{"type":"string","enum":["healthy","unhealthy","unknown"]},"details":{"type":"string"}}},"convex":{"type":"object","properties":{"status":{"type":"string","enum":["healthy","unhealthy","unknown"]},"details":{"type":"string"}}}}},"api":{"type":"object","properties":{"status":{"type":"string","enum":["healthy","unhealthy","unknown"]},"metrics":{"type":"object","nullable":true},"uptime":{"type":"number"},"errorRate":{"type":"number"}}},"system":{"type":"object","properties":{"memory":{"type":"object","description":"Node.js memory usage"},"uptime":{"type":"number","description":"Process uptime in seconds"},"nodeVersion":{"type":"string","description":"Node.js version"}}}}}}}},"503":{"description":"Service unavailable","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}}},"security":[]}},"/waitlist":{"get":{"summary":"Get Waitlist Entries (Admin)","description":"Retrieve paginated list of waitlist entries (admin only)","tags":["Admin","Waitlist"],"parameters":[{"in":"query","name":"limit","schema":{"type":"integer","minimum":1,"maximum":100,"default":20},"description":"Number of waitlist entries to return","example":20},{"in":"query","name":"offset","schema":{"type":"integer","minimum":0,"default":0},"description":"Number of waitlist entries to skip","example":0}],"responses":{"200":{"description":"Waitlist entries retrieved successfully","content":{"application/json":{"schema":{"type":"object","properties":{"success":{"type":"boolean","example":true},"data":{"type":"object","properties":{"waitlist":{"type":"array","description":"Array of waitlist entries","items":{"type":"object","properties":{"_id":{"type":"string","description":"Waitlist entry ID","example":"j1234567890abcdef"},"email":{"type":"string","format":"email","description":"User email address","example":"user@example.com"},"source":{"type":"string","description":"How the user joined the waitlist","example":"website"},"location":{"type":"object","nullable":true,"description":"User's location information","properties":{"city":{"type":"string","example":"London"},"country":{"type":"string","example":"UK"},"coordinates":{"type":"array","items":{"type":"number"},"example":[-0.1276,51.5074]}}},"status":{"type":"string","enum":["pending","contacted","converted","removed"],"description":"Waitlist entry status","example":"pending"},"priority":{"type":"string","enum":["low","medium","high","vip"],"description":"Priority level","example":"medium"},"joinedAt":{"type":"number","description":"Timestamp when user joined waitlist","example":1640995200000},"contactedAt":{"type":"number","nullable":true,"description":"Timestamp when user was contacted","example":1641081600000},"convertedAt":{"type":"number","nullable":true,"description":"Timestamp when user converted to customer","example":1641168000000},"metadata":{"type":"object","nullable":true,"description":"Additional waitlist metadata","example":{"referralCode":"FRIEND123","interest":"italian_cuisine"}}}}},"total":{"type":"number","description":"Total number of waitlist entries","example":1250},"limit":{"type":"number","example":20},"offset":{"type":"number","example":0}}},"message":{"type":"string","example":"Success"}}}}}},"401":{"description":"Unauthorized - invalid or missing authentication","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}},"403":{"description":"Forbidden - only admins can access this endpoint","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}},"500":{"description":"Internal server error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}}},"security":[{"bearerAuth":[]}]}},"/csrf":{"get":{"summary":"Get CSRF Token","description":"Generate and return a CSRF token for form protection","tags":["System"],"responses":{"200":{"description":"CSRF token generated successfully","content":{"application/json":{"schema":{"type":"object","properties":{"success":{"type":"boolean","example":true},"data":{"type":"object","properties":{"csrfToken":{"type":"string","format":"uuid","description":"Generated CSRF token","example":"123e4567-e89b-12d3-a456-426614174000"}}},"message":{"type":"string","example":"Success"}}}}},"headers":{"Set-Cookie":{"description":"CSRF token cookie","schema":{"type":"string","example":"csrf_token=123e4567-e89b-12d3-a456-426614174000; Path=/; Max-Age=3600; SameSite=Lax"}}}}},"security":[]}},"/email":{"post":{"summary":"Send Email Optimistically","description":"Send email using optimistic delivery with fallback handling","tags":["Email"],"requestBody":{"required":true,"content":{"application/json":{"schema":{"type":"object","required":["to","subject","html"],"properties":{"to":{"type":"string","description":"Recipient email address","example":"user@example.com"},"subject":{"type":"string","description":"Email subject line","example":"Welcome to CribNosh!"},"html":{"type":"string","description":"HTML content of the email","example":"<h1>Welcome!</h1><p>Thank you for joining CribNosh.</p>"},"text":{"type":"string","nullable":true,"description":"Plain text version of the email","example":"Welcome! Thank you for joining CribNosh."},"from":{"type":"string","nullable":true,"description":"Sender email address","example":"noreply@cribnosh.com"},"replyTo":{"type":"string","nullable":true,"description":"Reply-to email address","example":"support@cribnosh.com"},"tags":{"type":"array","items":{"type":"object","properties":{"name":{"type":"string","example":"template_id"},"value":{"type":"string","example":"welcome_email"}}},"nullable":true,"description":"Email tags for tracking and categorization"},"attachments":{"type":"array","items":{"type":"object","properties":{"filename":{"type":"string","example":"menu.pdf"},"content":{"type":"string","format":"base64","example":"JVBERi0xLjQKJcOkw7zDtsO..."}}},"nullable":true,"description":"Email attachments"},"metadata":{"type":"object","nullable":true,"description":"Additional email metadata","example":{"userId":"j1234567890abcdef","orderId":"j1234567890abcdef"}}}}}}},"responses":{"202":{"description":"Email queued for sending successfully","content":{"application/json":{"schema":{"type":"object","properties":{"success":{"type":"boolean","example":true},"data":{"type":"object","properties":{"operationId":{"type":"string","description":"Unique operation ID for tracking","example":"op_1234567890abcdef"},"status":{"type":"string","enum":["queued","sending","sent","failed"],"description":"Current email status","example":"queued"},"estimatedDelivery":{"type":"string","format":"date-time","description":"Estimated delivery time","example":"2024-01-15T10:30:00.000Z"}}},"message":{"type":"string","example":"Email queued successfully"}}}}}},"400":{"description":"Validation error - missing required fields","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}},"500":{"description":"Internal server error or email service unavailable","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}}},"security":[]}},"/get-ip":{"get":{"summary":"Get Client IP Address","description":"Retrieve the real IP address of the client making the request","tags":["System"],"responses":{"200":{"description":"IP address retrieved successfully","content":{"application/json":{"schema":{"type":"object","properties":{"success":{"type":"boolean","example":true},"data":{"type":"object","properties":{"ip":{"type":"string","description":"Client IP address","example":"192.168.1.100"}}},"message":{"type":"string","example":"Success"}}}}}}},"security":[]}},"/notifications":{"get":{"summary":"Get User Notifications","description":"Get paginated list of notifications for the authenticated user","tags":["Notifications"],"parameters":[{"in":"query","name":"limit","schema":{"type":"integer","minimum":1,"maximum":100,"default":20},"description":"Number of notifications to return","example":20},{"in":"query","name":"offset","schema":{"type":"integer","minimum":0,"default":0},"description":"Number of notifications to skip","example":0}],"responses":{"200":{"description":"Notifications retrieved successfully","content":{"application/json":{"schema":{"type":"object","properties":{"success":{"type":"boolean","example":true},"data":{"type":"object","properties":{"notifications":{"type":"array","description":"Array of notifications","items":{"type":"object","properties":{"_id":{"type":"string","description":"Notification ID","example":"j1234567890abcdef"},"userId":{"type":"string","nullable":true,"description":"User ID (null for global notifications)","example":"j1234567890abcdef"},"type":{"type":"string","description":"Notification type","enum":["info","success","warning","error","order","payment","system"],"example":"order"},"title":{"type":"string","description":"Notification title","example":"Order Confirmed"},"message":{"type":"string","description":"Notification message","example":"Your order #12345 has been confirmed and is being prepared"},"isRead":{"type":"boolean","description":"Whether the notification has been read","example":false},"global":{"type":"boolean","description":"Whether this is a global notification","example":false},"role":{"type":"string","nullable":true,"description":"Target role for role-specific notifications","example":"customer"},"metadata":{"type":"object","nullable":true,"description":"Additional notification data","example":{"orderId":"j1234567890abcdef","amount":25.99}},"createdAt":{"type":"number","description":"Notification creation timestamp","example":1640995200000}}}},"total":{"type":"number","description":"Total number of notifications","example":45},"limit":{"type":"number","description":"Number of notifications returned","example":20},"offset":{"type":"number","description":"Number of notifications skipped","example":0}}},"message":{"type":"string","example":"Success"}}}}}},"401":{"description":"Unauthorized - invalid or missing authentication","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}},"500":{"description":"Internal server error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}}},"security":[{"bearerAuth":[]}]}},"/contact":{"post":{"summary":"Submit contact form","description":"Submit a contact form with user details and message","tags":["Contact"],"requestBody":{"required":true,"content":{"application/json":{"schema":{"type":"object","required":["firstName","lastName","email","subject","message"],"properties":{"firstName":{"type":"string","description":"User's first name","example":"John"},"lastName":{"type":"string","description":"User's last name","example":"Doe"},"email":{"type":"string","format":"email","description":"User's email address","example":"john.doe@example.com"},"subject":{"type":"string","description":"Subject of the contact message","example":"Question about CribNosh"},"message":{"type":"string","description":"The contact message","example":"I have a question about your meal platform..."}}}}}},"responses":{"202":{"description":"Contact form submitted successfully","content":{"application/json":{"schema":{"type":"object","properties":{"success":{"type":"boolean","example":true},"message":{"type":"string","example":"Contact form submitted successfully"},"messageId":{"type":"string","description":"Email message ID"}}}}}},"400":{"description":"Validation error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}},"503":{"description":"Service unavailable","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}}},"security":[]}},"/emotions-engine":{"post":{"summary":"Emotions Engine Processing","description":"Process user emotions and context to provide personalized meal recommendations","tags":["AI","Recommendations"],"requestBody":{"required":true,"content":{"application/json":{"schema":{"type":"object","properties":{"userId":{"type":"string","nullable":true,"description":"User ID for personalized recommendations","example":"j1234567890abcdef"},"location":{"type":"object","nullable":true,"description":"User's current location","properties":{"latitude":{"type":"number","example":51.5074},"longitude":{"type":"number","example":-0.1278},"address":{"type":"string","nullable":true,"example":"London, UK"}}},"emotions":{"type":"array","items":{"type":"string"},"nullable":true,"description":"Current emotional state","example":["happy","excited","hungry"]},"preferences":{"type":"object","nullable":true,"description":"User dietary preferences and restrictions","properties":{"dietaryRestrictions":{"type":"array","items":{"type":"string"},"example":["vegetarian","gluten-free"]},"allergies":{"type":"array","items":{"type":"string"},"example":["nuts","dairy"]},"cuisinePreferences":{"type":"array","items":{"type":"string"},"example":["italian","mexican","indian"]},"spiceLevel":{"type":"string","enum":["mild","medium","hot","extra-hot"],"example":"medium"}}},"context":{"type":"object","nullable":true,"description":"Additional context for recommendations","properties":{"timeOfDay":{"type":"string","example":"dinner"},"occasion":{"type":"string","example":"date_night"},"budget":{"type":"string","enum":["low","medium","high","premium"],"example":"medium"},"cookingTime":{"type":"number","description":"Available cooking time in minutes","example":30}}},"searchQuery":{"type":"string","nullable":true,"description":"Text search query","example":"spicy pasta"}}}}}},"responses":{"200":{"description":"Emotions processed successfully","content":{"application/json":{"schema":{"type":"object","properties":{"success":{"type":"boolean","example":true},"data":{"type":"object","description":"Empty object on success (processing is asynchronous)","example":{}},"message":{"type":"string","example":"Success"}}}}}},"500":{"description":"Internal server error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}}},"security":[],"x-ai-features":{"description":"This endpoint powers CribNosh's AI-driven recommendation system:\n\n**Context Aggregation:**\n- Merges frontend user input with backend user data\n- Fetches nearby chef specialties based on location\n- Considers user's historical preferences and behavior\n\n**Emotional Analysis:**\n- Processes user's current emotional state\n- Maps emotions to appropriate meal types and cuisines\n- Considers time of day and occasion context\n\n**Personalization:**\n- Takes into account dietary restrictions and allergies\n- Considers budget and cooking time constraints\n- Learns from user's past orders and ratings\n\n**Location Intelligence:**\n- Finds nearby chefs within 10km radius\n- Considers local cuisine availability\n- Factors in delivery time and logistics\n\n**AI Processing:**\n- Runs inference using aggregated context\n- Generates personalized meal recommendations\n- Updates user preference models\n"}}},"/notion-sync":{"post":{"summary":"Notion Sync Queue","description":"Add data to Notion synchronization queue for external data management","tags":["Integrations","Sync"],"requestBody":{"required":true,"content":{"application/json":{"schema":{"type":"object","required":["id","table"],"properties":{"id":{"type":"string","description":"ID of the record to sync","example":"j1234567890abcdef"},"table":{"type":"string","enum":["waitlist"],"description":"Table name to sync","example":"waitlist"}}}}}},"responses":{"200":{"description":"Record added to sync queue successfully","content":{"application/json":{"schema":{"type":"object","properties":{"success":{"type":"boolean","example":true},"data":{"type":"object","properties":{"success":{"type":"boolean","example":true},"message":{"type":"string","example":"Added to sync queue"}}},"message":{"type":"string","example":"Success"}}}}}},"400":{"description":"Validation error - invalid table","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}},"500":{"description":"Internal server error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}}},"security":[],"x-integration":{"description":"This endpoint manages data synchronization with Notion:\n\n**Supported Tables:**\n- `waitlist`: Sync waitlist entries to Notion database\n\n**Sync Process:**\n- Adds records to background sync queue\n- Processes synchronously to avoid blocking\n- Handles retries and error recovery\n- Maintains data consistency between systems\n\n**Use Cases:**\n- Customer waitlist management\n- Lead tracking and CRM integration\n- Data backup and external storage\n- Team collaboration and reporting\n"}}},"/timelogs":{"post":{"summary":"Create timelog","description":"Create a new timelog entry with activity watch logs","tags":["Timelogs"],"requestBody":{"required":true,"content":{"application/json":{"schema":{"type":"object","required":["user","bucket","logs"],"properties":{"user":{"type":"string","description":"Username or email of the staff member","example":"john.doe@example.com"},"bucket":{"type":"string","description":"Bucket name for the timelog","example":"work"},"logs":{"type":"array","description":"Array of activity watch logs","items":{"type":"object","required":["timestamp","duration","data"],"properties":{"timestamp":{"type":"string","description":"ISO timestamp of the activity","example":"2024-01-15T10:30:00.000Z"},"duration":{"type":"number","description":"Duration of the activity in seconds","example":3600},"data":{"type":"object","description":"Additional activity data","example":{"app":"vscode","title":"coding"}}}}}}}}}},"responses":{"200":{"description":"Timelog created successfully","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Success"}}}},"400":{"description":"Validation error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}},"404":{"description":"Staff member not found","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}}},"security":[{"bearerAuth":[]},{"cookieAuth":[]}]},"get":{"summary":"Get timelogs","description":"Retrieve timelogs with optional filtering by staff, bucket, and date range","tags":["Timelogs"],"parameters":[{"in":"query","name":"staffId","schema":{"type":"string"},"description":"Filter by staff member ID","example":"j1234567890abcdef"},{"in":"query","name":"bucket","schema":{"type":"string"},"description":"Filter by bucket name","example":"work"},{"in":"query","name":"start","schema":{"type":"number"},"description":"Start timestamp filter","example":1640995200000},{"in":"query","name":"end","schema":{"type":"number"},"description":"End timestamp filter","example":1641081600000},{"in":"query","name":"skip","schema":{"type":"number"},"description":"Number of records to skip","example":0},{"in":"query","name":"limit","schema":{"type":"number"},"description":"Maximum number of records to return","example":50}],"responses":{"200":{"description":"Timelogs retrieved successfully","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Success"}}}},"400":{"description":"Validation error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}}},"security":[{"bearerAuth":[]},{"cookieAuth":[]}]}},"/api/nosh-heaven/collections":{"post":{"summary":"Create video collection","description":"Creates a new video collection/playlist","tags":["Nosh Heaven","Collections"],"security":[{"Bearer":[]}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"type":"object","required":["name","videoIds"],"properties":{"name":{"type":"string","description":"Name of the collection","example":"My Favorite Recipes"},"description":{"type":"string","description":"Description of the collection","example":"A collection of my favorite cooking videos"},"isPublic":{"type":"boolean","description":"Whether the collection is public","default":true,"example":true},"videoIds":{"type":"array","items":{"type":"string"},"description":"Array of video IDs to include","example":["j1234567890abcdef","j0987654321fedcba"]},"coverImageUrl":{"type":"string","description":"URL of the cover image","example":"https://cdn.noshheaven.com/collections/cover.jpg"}}}}}},"responses":{"201":{"description":"Collection created successfully","content":{"application/json":{"schema":{"type":"object","properties":{"success":{"type":"boolean","example":true},"data":{"type":"object","properties":{"collectionId":{"type":"string","description":"ID of the created collection","example":"j1234567890abcdef"}}},"message":{"type":"string","example":"Collection created successfully"}}}}}},"400":{"description":"Validation error"},"401":{"description":"Unauthorized"}}},"get":{"summary":"Get collections","description":"Retrieves video collections with pagination","tags":["Nosh Heaven","Collections"],"parameters":[{"in":"query","name":"limit","schema":{"type":"integer","default":20},"description":"Number of collections to return"},{"in":"query","name":"cursor","schema":{"type":"string"},"description":"Cursor for pagination"},{"in":"query","name":"publicOnly","schema":{"type":"boolean","default":true},"description":"Whether to return only public collections"}],"responses":{"200":{"description":"Collections retrieved successfully","content":{"application/json":{"schema":{"type":"object","properties":{"success":{"type":"boolean","example":true},"data":{"type":"object","properties":{"collections":{"type":"array","items":{"$ref":"#/components/schemas/VideoCollection"}},"nextCursor":{"type":"string","description":"Cursor for next page"}}},"message":{"type":"string","example":"Collections retrieved successfully"}}}}}}}}},"/api/nosh-heaven/trending":{"get":{"summary":"Get trending videos","description":"Retrieves trending videos based on engagement metrics","tags":["Nosh Heaven","Videos","Trending"],"parameters":[{"in":"query","name":"limit","schema":{"type":"integer","default":20},"description":"Number of videos to return"},{"in":"query","name":"timeRange","schema":{"type":"string","enum":["24h","7d","30d","all"],"default":"7d"},"description":"Time range for trending calculation"}],"responses":{"200":{"description":"Trending videos retrieved successfully","content":{"application/json":{"schema":{"type":"object","properties":{"success":{"type":"boolean","example":true},"data":{"type":"array","items":{"allOf":[{"$ref":"#/components/schemas/VideoPost"},{"type":"object","properties":{"engagementScore":{"type":"number","description":"Calculated engagement score","example":0.75}}}]}},"message":{"type":"string","example":"Trending videos retrieved successfully"}}}}}}}}},"/api/nosh-heaven/videos":{"post":{"summary":"Create a new video post","description":"Creates a new video post in Nosh Heaven","tags":["Nosh Heaven","Videos"],"security":[{"Bearer":[]}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"type":"object","required":["title","videoUrl","duration","fileSize","resolution","tags"],"properties":{"title":{"type":"string","description":"Title of the video","example":"How to Make Perfect Pasta"},"description":{"type":"string","description":"Description of the video","example":"Learn the secret to making restaurant-quality pasta at home"},"videoUrl":{"type":"string","description":"S3 URL of the uploaded video","example":"https://cdn.noshheaven.com/videos/user123/1234567890_my-cooking-video.mp4"},"thumbnailUrl":{"type":"string","description":"S3 URL of the thumbnail image","example":"https://cdn.noshheaven.com/thumbnails/user123/video123_1234567890_thumbnail.jpg"},"duration":{"type":"number","description":"Duration in seconds","example":300},"fileSize":{"type":"number","description":"File size in bytes","example":52428800},"resolution":{"type":"object","properties":{"width":{"type":"number","example":1920},"height":{"type":"number","example":1080}}},"tags":{"type":"array","items":{"type":"string"},"example":["pasta","italian","cooking","tutorial"]},"cuisine":{"type":"string","description":"Type of cuisine","example":"Italian"},"difficulty":{"type":"string","enum":["beginner","intermediate","advanced"],"example":"intermediate"},"visibility":{"type":"string","enum":["public","followers","private"],"default":"public","example":"public"},"isLive":{"type":"boolean","description":"Whether this is a live cooking session","example":false},"liveSessionId":{"type":"string","description":"ID of associated live session","example":"j1234567890abcdef"}}}}}},"responses":{"201":{"description":"Video post created successfully","content":{"application/json":{"schema":{"type":"object","properties":{"success":{"type":"boolean","example":true},"data":{"type":"object","properties":{"videoId":{"type":"string","description":"ID of the created video post","example":"j1234567890abcdef"}}},"message":{"type":"string","example":"Video post created successfully"}}}}}},"400":{"description":"Validation error"},"401":{"description":"Unauthorized"},"403":{"description":"Forbidden"}}},"get":{"summary":"Get video feed","description":"Retrieves the video feed with pagination","tags":["Nosh Heaven","Videos"],"parameters":[{"in":"query","name":"limit","schema":{"type":"integer","default":20},"description":"Number of videos to return"},{"in":"query","name":"cursor","schema":{"type":"string"},"description":"Cursor for pagination"}],"responses":{"200":{"description":"Video feed retrieved successfully","content":{"application/json":{"schema":{"type":"object","properties":{"success":{"type":"boolean","example":true},"data":{"type":"object","properties":{"videos":{"type":"array","items":{"$ref":"#/components/schemas/VideoPost"}},"nextCursor":{"type":"string","description":"Cursor for next page"}}},"message":{"type":"string","example":"Video feed retrieved successfully"}}}}}}}}},"/monitoring/health":{"get":{"summary":"System Health Check","description":"Get system health status and monitoring information","tags":["Monitoring"],"parameters":[{"in":"query","name":"detailed","schema":{"type":"boolean","default":false},"description":"Whether to return detailed health information","example":true}],"responses":{"200":{"description":"Health check completed successfully","content":{"application/json":{"schema":{"type":"object","properties":{"success":{"type":"boolean","example":true},"data":{"type":"object","properties":{"status":{"type":"string","enum":["healthy","degraded","unhealthy"],"description":"Overall system health status","example":"healthy"},"timestamp":{"type":"string","format":"date-time","description":"Health check timestamp","example":"2024-01-15T10:30:00.000Z"},"uptime":{"type":"number","description":"System uptime in seconds","example":86400},"version":{"type":"string","description":"Application version","example":"1.0.0"},"services":{"type":"object","description":"Individual service health (detailed mode only)","properties":{"database":{"type":"object","properties":{"status":{"type":"string","example":"healthy"},"responseTime":{"type":"number","example":45}}},"redis":{"type":"object","properties":{"status":{"type":"string","example":"healthy"},"responseTime":{"type":"number","example":12}}},"stripe":{"type":"object","properties":{"status":{"type":"string","example":"healthy"},"responseTime":{"type":"number","example":234}}}}},"metrics":{"type":"object","description":"System metrics (detailed mode only)","properties":{"memory":{"type":"object","properties":{"used":{"type":"number","example":512},"total":{"type":"number","example":1024},"percentage":{"type":"number","example":50}}},"cpu":{"type":"object","properties":{"usage":{"type":"number","example":25.5}}},"requests":{"type":"object","properties":{"perMinute":{"type":"number","example":150},"averageResponseTime":{"type":"number","example":120}}}}}}},"message":{"type":"string","example":"Success"}}}}}},"500":{"description":"Health check failed","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}}},"security":[]},"post":{"summary":"Health Check Actions","description":"Perform health check actions like recording health data or triggering checks","tags":["Monitoring"],"requestBody":{"required":true,"content":{"application/json":{"schema":{"type":"object","required":["action"],"properties":{"action":{"type":"string","enum":["record_health","trigger_health_check"],"description":"Action to perform","example":"trigger_health_check"},"data":{"type":"object","nullable":true,"description":"Health data to record (for record_health action)","example":{"status":"healthy","uptime":86400}}}}}}},"responses":{"200":{"description":"Health check action completed successfully","content":{"application/json":{"schema":{"type":"object","properties":{"success":{"type":"boolean","example":true},"data":{"type":"object","properties":{"status":{"type":"string","example":"success"},"message":{"type":"string","description":"Action result message","example":"Health data recorded successfully"},"data":{"type":"object","nullable":true,"description":"Health data (for trigger_health_check action)","properties":{"status":{"type":"string","example":"healthy"},"uptime":{"type":"number","example":86400},"version":{"type":"string","example":"1.0.0"}}}}},"message":{"type":"string","example":"Success"}}}}}},"400":{"description":"Invalid action or validation error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}},"500":{"description":"Health check action failed","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}}},"security":[]}},"/payments/refund":{"post":{"summary":"Process Payment Refund","description":"Process a refund for a payment intent (admin only)","tags":["Payments"],"requestBody":{"required":true,"content":{"application/json":{"schema":{"type":"object","required":["payment_intent_id"],"properties":{"payment_intent_id":{"type":"string","description":"Stripe payment intent ID to refund","example":"pi_1234567890abcdef"},"amount":{"type":"number","nullable":true,"description":"Partial refund amount in smallest currency unit (optional for full refund)","example":1599}}}}}},"responses":{"200":{"description":"Refund processed successfully","content":{"application/json":{"schema":{"type":"object","properties":{"success":{"type":"boolean","example":true},"data":{"type":"object","properties":{"refund":{"type":"object","description":"Stripe refund object","properties":{"id":{"type":"string","example":"re_1234567890abcdef"},"amount":{"type":"number","example":3198},"currency":{"type":"string","example":"gbp"},"status":{"type":"string","enum":["pending","succeeded","failed","canceled"],"example":"succeeded"},"reason":{"type":"string","example":"requested_by_customer"},"created":{"type":"number","example":1640995200}}}}},"message":{"type":"string","example":"Success"}}}}}},"400":{"description":"Validation error - missing payment_intent_id","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}},"401":{"description":"Unauthorized - invalid or missing authentication","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}},"403":{"description":"Forbidden - only admins can process refunds","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}},"503":{"description":"Service unavailable - Stripe not configured","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}}},"security":[{"bearerAuth":[]}]}},"/payments/history":{"get":{"summary":"Get Payment History","description":"Retrieve payment history for the authenticated user","tags":["Payments","History"],"responses":{"200":{"description":"Payment history retrieved successfully","content":{"application/json":{"schema":{"type":"object","properties":{"success":{"type":"boolean","example":true},"data":{"type":"object","properties":{"payments":{"type":"array","description":"Array of payment intents","items":{"type":"object","properties":{"id":{"type":"string","description":"Payment intent ID","example":"pi_1234567890abcdef"},"amount":{"type":"number","description":"Amount in cents","example":2500},"currency":{"type":"string","description":"Currency code","example":"usd"},"status":{"type":"string","enum":["requires_payment_method","requires_confirmation","requires_action","processing","requires_capture","canceled","succeeded"],"description":"Payment status","example":"succeeded"},"client_secret":{"type":"string","description":"Client secret for frontend","example":"pi_1234567890abcdef_secret_abcdef"},"description":{"type":"string","nullable":true,"description":"Payment description","example":"Order #ORD-12345"},"metadata":{"type":"object","nullable":true,"description":"Payment metadata","example":{"order_id":"ORD-12345","user_id":"j1234567890abcdef"}},"created":{"type":"number","description":"Creation timestamp","example":1640995200},"amount_received":{"type":"number","nullable":true,"description":"Amount actually received","example":2500},"receipt_email":{"type":"string","nullable":true,"description":"Receipt email","example":"user@example.com"},"shipping":{"type":"object","nullable":true,"description":"Shipping information","properties":{"name":{"type":"string","example":"John Doe"},"address":{"type":"object","properties":{"line1":{"type":"string","example":"123 Main St"},"city":{"type":"string","example":"London"},"postal_code":{"type":"string","example":"SW1A 1AA"},"country":{"type":"string","example":"GB"}}}}}}}}}},"message":{"type":"string","example":"Success"}}}}}},"400":{"description":"Validation error - user email required","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}},"401":{"description":"Unauthorized - invalid or missing authentication","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}},"500":{"description":"Internal server error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}},"503":{"description":"Service unavailable - Stripe not configured","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}}},"security":[{"bearerAuth":[]}]}},"/payments/cards":{"get":{"summary":"Get Payment Cards","description":"Retrieve saved payment cards for the authenticated user","tags":["Payments","Cards"],"responses":{"200":{"description":"Payment cards retrieved successfully","content":{"application/json":{"schema":{"type":"object","properties":{"success":{"type":"boolean","example":true},"data":{"type":"object","properties":{"cards":{"type":"array","description":"Array of saved payment cards","items":{"type":"object","properties":{"id":{"type":"string","description":"Payment method ID","example":"pm_1234567890abcdef"},"type":{"type":"string","description":"Payment method type","example":"card"},"card":{"type":"object","description":"Card details","properties":{"brand":{"type":"string","description":"Card brand","example":"visa"},"last4":{"type":"string","description":"Last 4 digits of card","example":"4242"},"exp_month":{"type":"number","description":"Expiration month","example":12},"exp_year":{"type":"number","description":"Expiration year","example":2025},"funding":{"type":"string","description":"Card funding type","example":"credit"},"country":{"type":"string","description":"Country code","example":"US"},"fingerprint":{"type":"string","description":"Card fingerprint","example":"abcd1234"}}},"billing_details":{"type":"object","description":"Billing information","properties":{"name":{"type":"string","nullable":true,"example":"John Doe"},"email":{"type":"string","nullable":true,"example":"john@example.com"},"phone":{"type":"string","nullable":true,"example":"+1234567890"},"address":{"type":"object","nullable":true,"properties":{"line1":{"type":"string","example":"123 Main St"},"line2":{"type":"string","nullable":true,"example":"Apt 4B"},"city":{"type":"string","example":"London"},"state":{"type":"string","example":"England"},"postal_code":{"type":"string","example":"SW1A 1AA"},"country":{"type":"string","example":"GB"}}}}},"created":{"type":"number","description":"Creation timestamp","example":1640995200}}}}}},"message":{"type":"string","example":"Success"}}}}}},"400":{"description":"Validation error - user email required","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}},"401":{"description":"Unauthorized - invalid or missing authentication","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}},"500":{"description":"Internal server error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}}},"security":[{"bearerAuth":[]}]}},"/payments/status":{"get":{"summary":"Get Payment Status","description":"Retrieve payment status for an order or payment intent","tags":["Payments","Status"],"parameters":[{"in":"query","name":"orderId","schema":{"type":"string"},"description":"Order ID to check payment status for","example":"ORD-12345"},{"in":"query","name":"paymentIntentId","schema":{"type":"string"},"description":"Payment intent ID to check status for","example":"pi_1234567890abcdef"}],"responses":{"200":{"description":"Payment status retrieved successfully","content":{"application/json":{"schema":{"type":"object","properties":{"success":{"type":"boolean","example":true},"data":{"type":"object","properties":{"order":{"type":"object","nullable":true,"description":"Order details (if orderId provided)","properties":{"_id":{"type":"string","example":"j1234567890abcdef"},"order_id":{"type":"string","example":"ORD-12345"},"customer_id":{"type":"string","example":"j1234567890abcdef"},"total_amount":{"type":"number","example":25.99},"order_status":{"type":"string","example":"confirmed"},"payment_status":{"type":"string","example":"completed"}}},"paymentIntent":{"type":"object","nullable":true,"description":"Payment intent details","properties":{"id":{"type":"string","example":"pi_1234567890abcdef"},"amount":{"type":"number","example":2599},"currency":{"type":"string","example":"usd"},"status":{"type":"string","enum":["requires_payment_method","requires_confirmation","requires_action","processing","requires_capture","canceled","succeeded"],"example":"succeeded"},"client_secret":{"type":"string","example":"pi_1234567890abcdef_secret_abcdef"},"description":{"type":"string","nullable":true,"example":"Order #ORD-12345"},"metadata":{"type":"object","nullable":true,"example":{"order_id":"ORD-12345"}},"created":{"type":"number","example":1640995200},"amount_received":{"type":"number","nullable":true,"example":2599},"receipt_email":{"type":"string","nullable":true,"example":"user@example.com"}}},"paymentStatus":{"type":"string","description":"Overall payment status","example":"completed"},"canRefund":{"type":"boolean","description":"Whether payment can be refunded","example":true},"refundAmount":{"type":"number","nullable":true,"description":"Maximum refundable amount","example":25.99}}},"message":{"type":"string","example":"Success"}}}}}},"400":{"description":"Validation error - missing required parameters","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}},"401":{"description":"Unauthorized - invalid or missing authentication","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}},"403":{"description":"Forbidden - insufficient permissions","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}},"404":{"description":"Order or payment intent not found","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}},"500":{"description":"Internal server error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}}},"security":[{"bearerAuth":[]}]}},"/payments/create-payment-intent":{"post":{"summary":"Create Payment Intent","description":"Create a Stripe payment intent for processing payments","tags":["Payments"],"requestBody":{"required":true,"content":{"application/json":{"schema":{"type":"object","required":["amount"],"properties":{"amount":{"type":"number","minimum":50,"description":"Amount in smallest currency unit (e.g., pence for GBP)","example":3198},"currency":{"type":"string","default":"gbp","description":"Currency code","example":"gbp"},"payment_method_id":{"type":"string","nullable":true,"description":"Payment method ID for immediate confirmation","example":"pm_1234567890abcdef"},"metadata":{"type":"object","nullable":true,"description":"Additional metadata for the payment","example":{"source":"mobile_app"}},"orderId":{"type":"string","nullable":true,"description":"Associated order ID","example":"j1234567890abcdef"},"chefId":{"type":"string","nullable":true,"description":"Associated chef ID","example":"j1234567890abcdef"},"bookingId":{"type":"string","nullable":true,"description":"Associated booking ID","example":"j1234567890abcdef"}}}}}},"responses":{"200":{"description":"Payment intent created successfully","content":{"application/json":{"schema":{"type":"object","properties":{"success":{"type":"boolean","example":true},"data":{"type":"object","properties":{"clientSecret":{"type":"string","description":"Stripe client secret for payment confirmation","example":"pi_1234567890abcdef_secret_abcdef1234567890"},"paymentIntentId":{"type":"string","description":"Stripe payment intent ID","example":"pi_1234567890abcdef"}}},"message":{"type":"string","example":"Success"}}}}}},"400":{"description":"Validation error - invalid amount or missing required fields","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}},"401":{"description":"Unauthorized - invalid or missing authentication","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}},"500":{"description":"Internal server error or Stripe configuration error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}}},"security":[{"bearerAuth":[]}]}},"/payments/confirm-payment":{"post":{"summary":"Confirm Payment Intent","description":"Confirm a Stripe payment intent to complete the payment","tags":["Payments"],"requestBody":{"required":true,"content":{"application/json":{"schema":{"type":"object","required":["payment_intent_id"],"properties":{"payment_intent_id":{"type":"string","description":"Stripe payment intent ID to confirm","example":"pi_1234567890abcdef"},"payment_method_id":{"type":"string","nullable":true,"description":"Payment method ID to use for confirmation","example":"pm_1234567890abcdef"}}}}}},"responses":{"200":{"description":"Payment confirmed successfully","content":{"application/json":{"schema":{"type":"object","properties":{"success":{"type":"boolean","example":true},"data":{"type":"object","properties":{"status":{"type":"string","description":"Payment intent status","enum":["requires_payment_method","requires_confirmation","requires_action","processing","requires_capture","canceled","succeeded"],"example":"succeeded"},"paymentIntent":{"type":"object","description":"Complete payment intent object from Stripe","properties":{"id":{"type":"string","example":"pi_1234567890abcdef"},"status":{"type":"string","example":"succeeded"},"amount":{"type":"number","example":3198},"currency":{"type":"string","example":"gbp"},"client_secret":{"type":"string","example":"pi_1234567890abcdef_secret_abcdef1234567890"}}}}},"message":{"type":"string","example":"Payment confirmed successfully"}}}}}},"400":{"description":"Validation error - missing payment_intent_id","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}},"401":{"description":"Unauthorized - invalid or missing authentication","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}},"500":{"description":"Internal server error or Stripe configuration error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}}},"security":[{"bearerAuth":[]}]}},"/images/chef/profile":{"post":{"summary":"Upload Chef Profile Image","description":"Upload a profile image for the authenticated chef","tags":["Images","Chef","Profile"],"requestBody":{"required":true,"content":{"multipart/form-data":{"schema":{"type":"object","required":["file"],"properties":{"file":{"type":"string","format":"binary","description":"Image file to upload (max 5MB, image formats only)"}}}}}},"responses":{"200":{"description":"Profile image uploaded successfully","content":{"application/json":{"schema":{"type":"object","properties":{"success":{"type":"boolean","example":true},"data":{"type":"object","properties":{"success":{"type":"boolean","example":true},"fileUrl":{"type":"string","description":"URL of the uploaded profile image","example":"/api/files/storage123456"}}},"message":{"type":"string","example":"Success"}}}}}},"400":{"description":"Validation error - invalid file or missing parameters","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}},"401":{"description":"Unauthorized - invalid or missing authentication","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}},"403":{"description":"Forbidden - only chefs or admins can upload images","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}},"404":{"description":"Chef profile not found","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}},"422":{"description":"Validation error - file too large, wrong format, or no file uploaded","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}},"500":{"description":"Internal server error or file upload failed","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}}},"security":[{"bearerAuth":[]}]}},"/delivery/track":{"post":{"summary":"Update Delivery Status","description":"Update the status and location of a delivery assignment","tags":["Delivery","Tracking"],"requestBody":{"required":true,"content":{"application/json":{"schema":{"type":"object","required":["assignmentId","status"],"properties":{"assignmentId":{"type":"string","description":"Delivery assignment ID","example":"j1234567890abcdef"},"status":{"type":"string","enum":["accepted","picked_up","in_transit","delivered","failed"],"description":"New delivery status","example":"in_transit"},"location":{"type":"object","nullable":true,"description":"Current location coordinates","properties":{"latitude":{"type":"number","minimum":-90,"maximum":90,"description":"Latitude coordinate","example":51.5074},"longitude":{"type":"number","minimum":-180,"maximum":180,"description":"Longitude coordinate","example":-0.1276},"accuracy":{"type":"number","minimum":0,"description":"Location accuracy in meters","example":10}}},"notes":{"type":"string","nullable":true,"description":"Additional notes about the delivery status","example":"Delivered to front door as requested"},"metadata":{"type":"object","nullable":true,"description":"Additional delivery metadata","example":{"deliveryTime":"18:30","customerRating":5}}}}}}},"responses":{"200":{"description":"Delivery status updated successfully","content":{"application/json":{"schema":{"type":"object","properties":{"success":{"type":"boolean","example":true},"data":{"type":"object","properties":{"assignmentId":{"type":"string","example":"j1234567890abcdef"},"status":{"type":"string","example":"in_transit"},"location":{"type":"object","nullable":true,"properties":{"latitude":{"type":"number","example":51.5074},"longitude":{"type":"number","example":-0.1276},"accuracy":{"type":"number","example":10}}},"notes":{"type":"string","nullable":true,"example":"Delivered to front door as requested"},"updatedAt":{"type":"string","format":"date-time","description":"Status update timestamp","example":"2024-01-15T18:30:00.000Z"},"updatedBy":{"type":"string","description":"User who updated the status","example":"j1234567890abcdef"}}},"message":{"type":"string","example":"Success"}}}}}},"400":{"description":"Validation error - missing required fields or invalid status","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}},"401":{"description":"Unauthorized - invalid or missing authentication","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}},"404":{"description":"Delivery assignment not found","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}},"500":{"description":"Internal server error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}}},"security":[{"bearerAuth":[]}]}},"/delivery/drivers":{"get":{"summary":"Get Delivery Drivers","description":"Retrieve delivery drivers with filtering and pagination","tags":["Delivery","Drivers"],"parameters":[{"in":"query","name":"status","schema":{"type":"string","enum":["pending","approved","rejected","on_hold","active","inactive","suspended"]},"description":"Filter by driver status","example":"active"},{"in":"query","name":"availability","schema":{"type":"string","enum":["available","busy","offline","on_delivery"]},"description":"Filter by driver availability","example":"available"},{"in":"query","name":"limit","schema":{"type":"integer","minimum":1,"maximum":100,"default":50},"description":"Number of drivers to return","example":50},{"in":"query","name":"offset","schema":{"type":"integer","minimum":0,"default":0},"description":"Number of drivers to skip","example":0}],"responses":{"200":{"description":"Delivery drivers retrieved successfully","content":{"application/json":{"schema":{"type":"object","properties":{"success":{"type":"boolean","example":true},"data":{"type":"object","properties":{"drivers":{"type":"array","description":"Array of delivery drivers","items":{"type":"object","properties":{"_id":{"type":"string","description":"Driver ID","example":"j1234567890abcdef"},"userId":{"type":"string","description":"Associated user ID","example":"j1234567890abcdef"},"name":{"type":"string","description":"Driver name","example":"John Smith"},"email":{"type":"string","description":"Driver email","example":"driver@example.com"},"phone":{"type":"string","description":"Driver phone number","example":"+1234567890"},"status":{"type":"string","enum":["pending","approved","rejected","on_hold","active","inactive","suspended"],"description":"Driver status","example":"active"},"availability":{"type":"string","enum":["available","busy","offline","on_delivery"],"description":"Current availability","example":"available"},"location":{"type":"object","nullable":true,"description":"Current location","properties":{"latitude":{"type":"number","example":51.5074},"longitude":{"type":"number","example":-0.1276},"accuracy":{"type":"number","example":10},"lastUpdated":{"type":"string","format":"date-time","example":"2024-01-15T15:30:00.000Z"}}},"vehicle":{"type":"object","nullable":true,"description":"Vehicle information","properties":{"type":{"type":"string","example":"bicycle"},"make":{"type":"string","example":"Trek"},"model":{"type":"string","example":"FX 3"},"licensePlate":{"type":"string","nullable":true,"example":"ABC123"}}},"rating":{"type":"number","nullable":true,"description":"Average rating","example":4.8},"totalDeliveries":{"type":"number","description":"Total deliveries completed","example":150},"activeDeliveries":{"type":"number","description":"Currently active deliveries","example":2},"maxCapacity":{"type":"number","description":"Maximum delivery capacity","example":5},"serviceAreas":{"type":"array","items":{"type":"string"},"description":"Service area codes","example":["SW1","SW2","SW3"]},"certifications":{"type":"array","items":{"type":"string"},"description":"Driver certifications","example":["food_safety","first_aid"]},"createdAt":{"type":"string","format":"date-time","description":"Driver registration timestamp","example":"2024-01-15T10:00:00.000Z"},"updatedAt":{"type":"string","format":"date-time","description":"Last update timestamp","example":"2024-01-15T15:30:00.000Z"}}}},"total":{"type":"number","description":"Total number of drivers matching filters","example":25},"limit":{"type":"number","example":50},"offset":{"type":"number","example":0}}},"message":{"type":"string","example":"Success"}}}}}},"400":{"description":"Validation error - invalid parameters","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}},"500":{"description":"Internal server error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}}}},"post":{"summary":"Update Driver Location/Status","description":"Update driver location, availability, or status (admin/staff/driver only)","tags":["Delivery","Drivers"],"requestBody":{"required":true,"content":{"application/json":{"schema":{"type":"object","required":["driverId","location"],"properties":{"driverId":{"type":"string","description":"Driver ID to update","example":"j1234567890abcdef"},"location":{"type":"object","description":"Current location coordinates","properties":{"latitude":{"type":"number","minimum":-90,"maximum":90,"description":"Latitude coordinate","example":51.5074},"longitude":{"type":"number","minimum":-180,"maximum":180,"description":"Longitude coordinate","example":-0.1276},"accuracy":{"type":"number","minimum":0,"description":"Location accuracy in meters","example":10}}},"availability":{"type":"string","enum":["available","busy","offline","on_delivery"],"description":"Driver availability status","example":"available"},"metadata":{"type":"object","nullable":true,"description":"Additional update metadata","example":{"batteryLevel":85,"signalStrength":"strong"}}}}}}},"responses":{"200":{"description":"Driver location/status updated successfully","content":{"application/json":{"schema":{"type":"object","properties":{"success":{"type":"boolean","example":true},"data":{"type":"object","properties":{"driverId":{"type":"string","example":"j1234567890abcdef"},"location":{"type":"object","properties":{"latitude":{"type":"number","example":51.5074},"longitude":{"type":"number","example":-0.1276},"accuracy":{"type":"number","example":10}}},"availability":{"type":"string","example":"available"},"updatedAt":{"type":"string","format":"date-time","description":"Update timestamp","example":"2024-01-15T15:30:00.000Z"},"updatedBy":{"type":"string","description":"User who made the update","example":"j1234567890abcdef"},"updatedByRole":{"type":"string","example":"driver"}}},"message":{"type":"string","example":"Driver location updated successfully"}}}}}},"400":{"description":"Validation error - missing required fields","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}},"401":{"description":"Unauthorized - invalid or missing authentication","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}},"403":{"description":"Forbidden - insufficient permissions or trying to update another driver's location","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}},"404":{"description":"Driver not found","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}},"500":{"description":"Internal server error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}}},"security":[{"bearerAuth":[]}]}},"/delivery/assign":{"post":{"summary":"Assign Delivery Driver","description":"Assign a delivery driver to an order (admin/staff only)","tags":["Delivery","Orders"],"requestBody":{"required":true,"content":{"application/json":{"schema":{"type":"object","required":["orderId"],"properties":{"orderId":{"type":"string","description":"Order ID to assign delivery for","example":"j1234567890abcdef"},"driverId":{"type":"string","nullable":true,"description":"Specific driver ID (auto-assign if not provided)","example":"j1234567890abcdef"},"estimatedPickupTime":{"type":"string","format":"date-time","nullable":true,"description":"Estimated pickup time","example":"2024-01-15T18:00:00.000Z"},"estimatedDeliveryTime":{"type":"string","format":"date-time","nullable":true,"description":"Estimated delivery time","example":"2024-01-15T18:30:00.000Z"},"pickupInstructions":{"type":"string","nullable":true,"description":"Special pickup instructions","example":"Ring doorbell twice, ask for John"},"deliveryInstructions":{"type":"string","nullable":true,"description":"Special delivery instructions","example":"Leave at front door if no answer"},"metadata":{"type":"object","nullable":true,"description":"Additional delivery metadata","example":{"priority":"high","fragile":true}}}}}}},"responses":{"200":{"description":"Delivery assigned successfully","content":{"application/json":{"schema":{"type":"object","properties":{"success":{"type":"boolean","example":true},"data":{"type":"object","properties":{"assignmentId":{"type":"string","description":"Delivery assignment ID","example":"j1234567890abcdef"},"orderId":{"type":"string","example":"j1234567890abcdef"},"driverId":{"type":"string","description":"Assigned driver ID","example":"j1234567890abcdef"},"status":{"type":"string","enum":["assigned","picked_up","in_transit","delivered","failed"],"description":"Delivery status","example":"assigned"},"estimatedPickupTime":{"type":"string","format":"date-time","nullable":true,"example":"2024-01-15T18:00:00.000Z"},"estimatedDeliveryTime":{"type":"string","format":"date-time","nullable":true,"example":"2024-01-15T18:30:00.000Z"},"assignedAt":{"type":"string","format":"date-time","description":"Assignment timestamp","example":"2024-01-15T17:45:00.000Z"},"assignedBy":{"type":"string","description":"User who made the assignment","example":"j1234567890abcdef"}}},"message":{"type":"string","example":"Success"}}}}}},"400":{"description":"Validation error - missing required fields","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}},"401":{"description":"Unauthorized - invalid or missing authentication","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}},"403":{"description":"Forbidden - only admins and staff can assign deliveries","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}},"404":{"description":"Order not found","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}},"500":{"description":"Internal server error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}}},"security":[{"bearerAuth":[]}]}},"/staff/data":{"get":{"summary":"Get Staff Data","description":"Retrieve staff member's personal and employment data","tags":["Staff","Profile"],"responses":{"200":{"description":"Staff data retrieved successfully","content":{"application/json":{"schema":{"type":"object","properties":{"success":{"type":"boolean","example":true},"data":{"type":"object","properties":{"id":{"type":"string","description":"Staff user ID","example":"j1234567890abcdef"},"name":{"type":"string","description":"Staff member's full name","example":"John Smith"},"email":{"type":"string","format":"email","description":"Staff email address","example":"john.smith@cribnosh.com"},"roles":{"type":"array","items":{"type":"string"},"description":"Staff roles and permissions","example":["staff","customer_support"]},"position":{"type":"string","nullable":true,"description":"Job position/title","example":"Customer Support Manager"},"department":{"type":"string","nullable":true,"description":"Department assignment","example":"Customer Support"},"avatar":{"type":"string","nullable":true,"description":"Profile avatar URL","example":"https://example.com/avatar.jpg"},"status":{"type":"string","enum":["active","inactive","suspended","terminated"],"description":"Employment status","example":"active"},"onboarding":{"type":"object","nullable":true,"description":"Onboarding completion status","properties":{"completed":{"type":"boolean","example":true},"stepsCompleted":{"type":"array","items":{"type":"string"},"example":["profile_setup","training_completed"]}}},"mattermostActive":{"type":"boolean","description":"Whether staff is active on Mattermost","example":true},"mattermostProfile":{"type":"object","nullable":true,"description":"Mattermost profile information","properties":{"username":{"type":"string","example":"john.smith"},"displayName":{"type":"string","example":"John Smith"}}},"mattermostUserId":{"type":"string","nullable":true,"description":"Mattermost user ID","example":"mattermost_user_123"},"startDate":{"type":"string","format":"date","nullable":true,"description":"Employment start date","example":"2024-01-15"},"employmentType":{"type":"string","enum":["full_time","part_time","contract","intern"],"nullable":true,"description":"Type of employment","example":"full_time"},"salary":{"type":"object","nullable":true,"description":"Salary information","properties":{"amount":{"type":"number","example":50000},"currency":{"type":"string","example":"USD"},"frequency":{"type":"string","example":"annual"}}},"address":{"type":"object","nullable":true,"description":"Staff address","properties":{"street":{"type":"string","example":"123 Main St"},"city":{"type":"string","example":"London"},"postcode":{"type":"string","example":"SW1A 1AA"},"country":{"type":"string","example":"UK"}}}}},"message":{"type":"string","example":"Staff data retrieved successfully"}}}}}},"401":{"description":"Unauthorized - authentication required","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}},"404":{"description":"Staff user not found","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}},"500":{"description":"Internal server error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}}},"security":[{"cookieAuth":[]}]}},"/staff/notices":{"get":{"summary":"Get Staff Notices","description":"Retrieve active notices and announcements for the authenticated staff member","tags":["Staff","Notices","Announcements"],"responses":{"200":{"description":"Staff notices retrieved successfully","content":{"application/json":{"schema":{"type":"object","properties":{"success":{"type":"boolean","example":true},"data":{"type":"object","properties":{"notices":{"type":"array","description":"Array of active staff notices","items":{"type":"object","properties":{"_id":{"type":"string","description":"Notice ID","example":"j1234567890abcdef"},"title":{"type":"string","description":"Notice title","example":"System Maintenance Scheduled"},"content":{"type":"string","description":"Notice content","example":"Scheduled maintenance will occur on Sunday from 2-4 AM"},"type":{"type":"string","enum":["info","warning","urgent","maintenance","policy","training"],"description":"Notice type","example":"maintenance"},"priority":{"type":"string","enum":["low","medium","high","critical"],"description":"Notice priority","example":"high"},"department":{"type":"string","nullable":true,"description":"Target department (null for all departments)","example":"customer_support"},"position":{"type":"string","nullable":true,"description":"Target position (null for all positions)","example":"manager"},"isActive":{"type":"boolean","description":"Whether the notice is currently active","example":true},"startDate":{"type":"string","format":"date-time","description":"Notice start date","example":"2024-01-15T00:00:00.000Z"},"endDate":{"type":"string","format":"date-time","nullable":true,"description":"Notice end date (null for indefinite)","example":"2024-01-20T23:59:59.999Z"},"createdBy":{"type":"string","description":"User ID who created the notice","example":"j1234567890abcdef"},"createdAt":{"type":"string","format":"date-time","description":"Notice creation timestamp","example":"2024-01-15T10:00:00.000Z"},"updatedAt":{"type":"string","format":"date-time","nullable":true,"description":"Last update timestamp","example":"2024-01-15T15:30:00.000Z"},"metadata":{"type":"object","nullable":true,"description":"Additional notice metadata","example":{"requiresAcknowledgment":true,"externalLink":"https://example.com/more-info"}}}}}}},"message":{"type":"string","example":"Success"}}}}}},"401":{"description":"Unauthorized - authentication required","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}},"404":{"description":"Staff user not found","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}},"500":{"description":"Internal server error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}}},"security":[{"cookieAuth":[]}]}},"/api/functions/admin":{"get":{"summary":"Get admin functions","description":"Get available admin functions and system status","tags":["Functions"],"responses":{"200":{"description":"Admin functions retrieved successfully","content":{"application/json":{"schema":{"type":"object","properties":{"success":{"type":"boolean"},"data":{"type":"object","properties":{"availableFunctions":{"type":"array","items":{"type":"string"}},"systemStatus":{"type":"object"},"liveSessionStats":{"type":"object"},"adminStats":{"type":"object"}}}}}}}},"500":{"description":"Internal server error"}}}},"/stripe/webhook":{"post":{"summary":"Stripe Webhook Handler","description":"Handle Stripe webhook events for payment processing, refunds, and subscriptions","tags":["Payments","Webhooks"],"requestBody":{"required":true,"content":{"application/json":{"schema":{"type":"object","description":"Stripe webhook event payload","properties":{"id":{"type":"string","description":"Event ID","example":"evt_1234567890abcdef"},"object":{"type":"string","description":"Event object type","example":"event"},"type":{"type":"string","description":"Event type","enum":["payment_intent.succeeded","payment_intent.payment_failed","charge.refunded","customer.subscription.created","customer.subscription.deleted","charge.dispute.created"],"example":"payment_intent.succeeded"},"data":{"type":"object","description":"Event data object"},"created":{"type":"number","description":"Event creation timestamp","example":1640995200}}}}}},"responses":{"200":{"description":"Webhook processed successfully","content":{"application/json":{"schema":{"type":"object","properties":{"success":{"type":"boolean","example":true},"data":{"type":"object","properties":{"received":{"type":"boolean","example":true}}},"message":{"type":"string","example":"Success"}}}}}},"400":{"description":"Webhook signature verification failed","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}},"500":{"description":"Internal server error or Stripe configuration error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}}},"security":[],"x-webhook":{"description":"This endpoint handles Stripe webhook events:\n\n**Supported Events:**\n- `payment_intent.succeeded`: Marks orders as paid\n- `payment_intent.payment_failed`: Notifies admins of failed payments\n- `charge.refunded`: Marks orders as refunded\n- `customer.subscription.created`: Updates user subscription status\n- `customer.subscription.deleted`: Cancels user subscription\n- `charge.dispute.created`: Notifies admins of payment disputes\n\n**Webhook Security:**\n- Requires valid Stripe signature header\n- Verifies webhook secret for authenticity\n- Processes events asynchronously\n"}}},"/functions/startLiveSession":{"post":{"summary":"Start Live Session","description":"Start a new live cooking session for a specific meal","tags":["Live Streaming"],"requestBody":{"required":true,"content":{"application/json":{"schema":{"type":"object","required":["title","description","mealId"],"properties":{"title":{"type":"string","description":"Title of the live session","example":"Cooking Authentic Italian Pasta"},"description":{"type":"string","description":"Description of what will be cooked","example":"Join me as I prepare traditional Italian pasta from scratch"},"mealId":{"type":"string","description":"ID of the meal being prepared","example":"j1234567890abcdef"},"location":{"type":"object","nullable":true,"description":"Location information for the session","properties":{"coordinates":{"type":"array","items":{"type":"number"},"minItems":2,"maxItems":2,"description":"[longitude, latitude] coordinates","example":[-0.1276,51.5074]},"address":{"type":"string","nullable":true,"description":"Human-readable address","example":"123 Baker Street, London"}}},"tags":{"type":"array","items":{"type":"string"},"nullable":true,"description":"Tags for categorizing the session","example":["italian","pasta","cooking","live"]}}}}}},"responses":{"200":{"description":"Live session started successfully","content":{"application/json":{"schema":{"type":"object","properties":{"success":{"type":"boolean","example":true},"data":{"type":"object","properties":{"sessionId":{"type":"string","description":"Unique session ID","example":"j1234567890abcdef"},"title":{"type":"string","example":"Cooking Authentic Italian Pasta"},"description":{"type":"string","example":"Join me as I prepare traditional Italian pasta from scratch"},"mealId":{"type":"string","example":"j1234567890abcdef"},"channelName":{"type":"string","description":"Streaming channel name","example":"live-1640995200000"},"chefId":{"type":"string","description":"Chef ID who started the session","example":"j1234567890abcdef"},"status":{"type":"string","enum":["starting","live","ended"],"description":"Current session status","example":"starting"},"tags":{"type":"array","items":{"type":"string"},"example":["italian","pasta","cooking","live"]},"createdAt":{"type":"number","description":"Session creation timestamp","example":1640995200000}}},"message":{"type":"string","example":"Success"}}}}}},"400":{"description":"Validation error - missing required fields","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}},"500":{"description":"Internal server error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}}},"security":[]}},"/api/functions/moderation":{"get":{"summary":"Get moderation functions","description":"Get available moderation functions and current moderation status","tags":["Functions"],"responses":{"200":{"description":"Moderation functions retrieved successfully","content":{"application/json":{"schema":{"type":"object","properties":{"success":{"type":"boolean"},"data":{"type":"object","properties":{"availableFunctions":{"type":"array","items":{"type":"string"}},"activeModerators":{"type":"number"},"pendingReports":{"type":"number"},"moderationStats":{"type":"object"}}}}}}}},"500":{"description":"Internal server error"}}}},"/functions/getLiveSession":{"get":{"summary":"Get Live Session by ID","description":"Retrieve a specific live session by its session ID","tags":["Live Streaming"],"parameters":[{"in":"query","name":"sessionId","required":true,"schema":{"type":"string"},"description":"The session ID to retrieve","example":"live-1640995200000"}],"responses":{"200":{"description":"Live session retrieved successfully","content":{"application/json":{"schema":{"type":"object","properties":{"success":{"type":"boolean","example":true},"data":{"type":"object","properties":{"_id":{"type":"string","example":"j1234567890abcdef"},"session_id":{"type":"string","example":"live-1640995200000"},"chef_id":{"type":"string","example":"j1234567890abcdef"},"title":{"type":"string","example":"Cooking Authentic Italian Pasta"},"description":{"type":"string","example":"Join me as I prepare traditional Italian pasta"},"status":{"type":"string","enum":["scheduled","starting","live","ended","cancelled"],"example":"live"},"location":{"type":"object","nullable":true,"properties":{"city":{"type":"string","example":"London"},"coordinates":{"type":"array","items":{"type":"number"},"example":[-0.1276,51.5074]},"address":{"type":"string","example":"123 Baker Street, London"},"radius":{"type":"number","example":10}}},"viewerCount":{"type":"number","example":15},"chatEnabled":{"type":"boolean","example":true},"tags":{"type":"array","items":{"type":"string"},"example":["italian","pasta","cooking"]},"_creationTime":{"type":"number","example":1640995200000}}},"message":{"type":"string","example":"Success"}}}}}},"400":{"description":"Validation error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}},"404":{"description":"Live session not found","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}},"500":{"description":"Internal server error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}}},"security":[]}},"/functions/updateLiveSessionLocation":{"put":{"summary":"Update Live Session Location","description":"Update the location of an existing live session","tags":["Live Streaming"],"parameters":[{"in":"path","name":"sessionId","required":true,"schema":{"type":"string"},"description":"The ID of the live session to update"}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"type":"object","required":["latitude","longitude"],"properties":{"latitude":{"type":"number","minimum":-90,"maximum":90,"description":"Latitude coordinate","example":51.5074},"longitude":{"type":"number","minimum":-180,"maximum":180,"description":"Longitude coordinate","example":-0.1276},"city":{"type":"string","description":"City name","example":"London"},"address":{"type":"string","description":"Human-readable address","example":"123 Baker Street, London"},"radius":{"type":"number","minimum":1,"maximum":100,"description":"Delivery radius in kilometers","example":10}}}}}},"responses":{"200":{"description":"Location updated successfully","content":{"application/json":{"schema":{"type":"object","properties":{"success":{"type":"boolean","example":true},"data":{"type":"object","properties":{"sessionId":{"type":"string","example":"j1234567890abcdef"},"location":{"type":"object","properties":{"city":{"type":"string","example":"London"},"coordinates":{"type":"array","items":{"type":"number"},"example":[-0.1276,51.5074]},"address":{"type":"string","example":"123 Baker Street, London"},"radius":{"type":"number","example":10}}}}},"message":{"type":"string","example":"Session location updated successfully"}}}}}},"400":{"description":"Validation error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}},"404":{"description":"Live session not found","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}},"500":{"description":"Internal server error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}}},"security":[]}},"/staff/upload-document":{"post":{"summary":"Upload Staff Document","description":"Upload documents for staff onboarding (ID, tax forms, etc.)","tags":["Staff","Documents"],"requestBody":{"required":true,"content":{"multipart/form-data":{"schema":{"type":"object","required":["file","userEmail"],"properties":{"file":{"type":"string","format":"binary","description":"Document file to upload"},"userEmail":{"type":"string","format":"email","description":"Email of the staff member","example":"john.doe@cribnosh.com"},"type":{"type":"string","description":"Type of document being uploaded","example":"id_document"}}}}}},"responses":{"200":{"description":"Document uploaded successfully","content":{"application/json":{"schema":{"type":"object","properties":{"success":{"type":"boolean","example":true},"data":{"type":"object","properties":{"fileUrl":{"type":"string","description":"URL to access the uploaded file","example":"https://storage.cribnosh.com/documents/john.doe@cribnosh.com/uuid-document.pdf"},"fileName":{"type":"string","description":"Generated file name","example":"john.doe@cribnosh.com/uuid-document.pdf"}}},"message":{"type":"string","example":"Document uploaded successfully"}}}}}},"400":{"description":"Validation error - missing file or userEmail","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}},"401":{"description":"Unauthorized - invalid or missing authentication","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}},"500":{"description":"Internal server error or MinIO not configured","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}}},"security":[{"cookieAuth":[]}]}},"/staff/waitlist":{"post":{"summary":"Add Lead to Waitlist (Staff)","description":"Allow staff to directly add leads to the waitlist without email verification","tags":["Staff","Waitlist"],"security":[{"bearerAuth":[]}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"type":"object","required":["email"],"properties":{"email":{"type":"string","format":"email","description":"Lead email address","example":"lead@example.com"},"name":{"type":"string","description":"Lead name","example":"John Doe"},"phone":{"type":"string","description":"Lead phone number","example":"+1234567890"},"location":{"type":"string","description":"Lead location","example":"New York, NY"},"source":{"type":"string","description":"Lead source","example":"staff_referral"},"priority":{"type":"string","enum":["low","medium","high","vip"],"description":"Lead priority level","example":"medium"},"notes":{"type":"string","description":"Additional notes about the lead","example":"Interested in Italian cuisine"}}}}}},"responses":{"200":{"description":"Lead successfully added to waitlist","content":{"application/json":{"schema":{"type":"object","properties":{"success":{"type":"boolean","example":true},"data":{"type":"object","properties":{"waitlistId":{"type":"string","description":"ID of the created waitlist entry","example":"j1234567890abcdef"},"email":{"type":"string","example":"lead@example.com"},"isExisting":{"type":"boolean","description":"Whether the email was already in the waitlist","example":false}}},"message":{"type":"string","example":"Lead successfully added to waitlist"}}}}}},"400":{"description":"Validation error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}},"401":{"description":"Unauthorized - invalid or missing authentication","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}},"403":{"description":"Forbidden - only staff can access this endpoint","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}},"500":{"description":"Internal server error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}}}},"get":{"summary":"Get Waitlist Entries (Staff)","description":"Retrieve waitlist entries for staff viewing","tags":["Staff","Waitlist"],"security":[{"bearerAuth":[]}],"parameters":[{"in":"query","name":"status","schema":{"type":"string","enum":["active","converted","inactive","all"],"default":"all"},"description":"Filter by waitlist status"},{"in":"query","name":"search","schema":{"type":"string"},"description":"Search by email or name"},{"in":"query","name":"limit","schema":{"type":"integer","minimum":1,"maximum":100,"default":50},"description":"Number of entries to return"}],"responses":{"200":{"description":"Waitlist entries retrieved successfully","content":{"application/json":{"schema":{"type":"object","properties":{"success":{"type":"boolean","example":true},"data":{"type":"object","properties":{"entries":{"type":"array","items":{"type":"object","properties":{"_id":{"type":"string","description":"Waitlist entry ID"},"email":{"type":"string","format":"email"},"name":{"type":"string"},"phone":{"type":"string"},"location":{"type":"string"},"source":{"type":"string"},"status":{"type":"string","enum":["active","converted","inactive"]},"priority":{"type":"string","enum":["low","medium","high","vip"]},"joinedAt":{"type":"number"},"notes":{"type":"string"}}}},"total":{"type":"number","description":"Total number of entries"}}},"message":{"type":"string","example":"Success"}}}}}},"401":{"description":"Unauthorized"},"403":{"description":"Forbidden - only staff can access"},"500":{"description":"Internal server error"}}}},"/staff/onboarding":{"post":{"summary":"Submit Staff Onboarding Form","description":"Submit employee onboarding form with personal information and documents","tags":["Staff","Onboarding"],"requestBody":{"required":true,"content":{"multipart/form-data":{"schema":{"type":"object","required":["firstName","lastName","email","position","department"],"properties":{"firstName":{"type":"string","description":"Employee first name","example":"John"},"lastName":{"type":"string","description":"Employee last name","example":"Doe"},"email":{"type":"string","format":"email","description":"Employee email address","example":"john.doe@cribnosh.com"},"position":{"type":"string","description":"Employee position/title","example":"Customer Support Specialist"},"department":{"type":"string","description":"Employee department","example":"Customer Support"},"phone":{"type":"string","description":"Employee phone number","example":"+1234567890"},"address":{"type":"string","description":"Employee address","example":"123 Main St, London, UK"},"emergencyContact":{"type":"string","description":"Emergency contact information","example":"Jane Doe - +0987654321"},"idDocument":{"type":"string","format":"binary","description":"ID document file"},"taxForm":{"type":"string","format":"binary","description":"Tax form file"},"directDepositForm":{"type":"string","format":"binary","description":"Direct deposit form file"}}}}}},"responses":{"200":{"description":"Onboarding form submitted successfully","content":{"application/json":{"schema":{"type":"object","properties":{"success":{"type":"boolean","example":true},"data":{"type":"object","properties":{"onboardingId":{"type":"string","description":"Onboarding form ID","example":"ONB-12345"},"status":{"type":"string","description":"Onboarding status","example":"submitted"},"submittedAt":{"type":"string","format":"date-time","description":"Submission timestamp","example":"2024-01-15T10:00:00.000Z"},"nextSteps":{"type":"array","items":{"type":"string"},"description":"Next steps in onboarding process","example":["HR Review","Background Check","System Access Setup"]}}},"message":{"type":"string","example":"Onboarding form submitted successfully"}}}}}},"400":{"description":"Validation error - missing required fields","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}},"401":{"description":"Unauthorized - invalid or missing authentication","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}},"500":{"description":"Internal server error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}}},"security":[{"cookieAuth":[]}]}},"/functions/getNearbyLiveSessions":{"post":{"summary":"Get Nearby Live Sessions","description":"Retrieve live sessions within a specified radius of the user's location","tags":["Live Streaming"],"requestBody":{"required":true,"content":{"application/json":{"schema":{"type":"object","required":["latitude","longitude"],"properties":{"latitude":{"type":"number","minimum":-90,"maximum":90,"description":"User's latitude coordinate","example":51.5074},"longitude":{"type":"number","minimum":-180,"maximum":180,"description":"User's longitude coordinate","example":-0.1276},"maxDistanceKm":{"type":"number","minimum":1,"maximum":500,"default":50,"description":"Maximum distance in kilometers to search for sessions","example":25}}}}}},"responses":{"200":{"description":"Nearby live sessions retrieved successfully","content":{"application/json":{"schema":{"type":"object","properties":{"success":{"type":"boolean","example":true},"data":{"type":"array","items":{"type":"object","properties":{"_id":{"type":"string","example":"j1234567890abcdef"},"channelName":{"type":"string","example":"live-1640995200000"},"chefId":{"type":"string","example":"j1234567890abcdef"},"title":{"type":"string","example":"Cooking Authentic Italian Pasta"},"description":{"type":"string","example":"Join me as I prepare traditional Italian pasta"},"distance":{"type":"number","description":"Distance from user in kilometers","example":2.5},"location":{"type":"object","properties":{"coordinates":{"type":"array","items":{"type":"number"},"example":[-0.1276,51.5074]}}},"isActive":{"type":"boolean","example":true},"viewerCount":{"type":"number","example":15},"tags":{"type":"array","items":{"type":"string"},"example":["italian","pasta","cooking"]}}}},"message":{"type":"string","example":"Success"}}}}}},"400":{"description":"Validation error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}},"500":{"description":"Internal server error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}}},"security":[]}},"/webhooks/resend":{"post":{"summary":"Resend Email Webhook Handler","description":"Handle Resend email service webhook events for email analytics and tracking","tags":["Webhooks","Email"],"requestBody":{"required":true,"content":{"text/plain":{"schema":{"type":"string","description":"Raw webhook payload from Resend","example":"{\"type\":\"email.delivered\",\"data\":{\"id\":\"email_123\",\"to\":[\"user@example.com\"],\"subject\":\"Welcome\"}}"}}}},"responses":{"200":{"description":"Webhook processed successfully","content":{"application/json":{"schema":{"type":"object","properties":{"success":{"type":"boolean","example":true},"data":{"type":"object","description":"Empty object on success","example":{}},"message":{"type":"string","example":"Success"}}}}}},"401":{"description":"Webhook signature verification failed","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}},"500":{"description":"Internal server error or webhook secret not configured","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}}},"security":[],"x-webhook":{"description":"This endpoint handles Resend webhook events for email analytics:\n\n**Supported Email Events:**\n- `email.sent`: Email was sent successfully\n- `email.delivered`: Email was delivered to recipient\n- `email.delivery_delayed`: Email delivery was delayed\n- `email.complained`: Recipient marked email as spam\n- `email.bounced`: Email bounced (hard/soft bounce)\n- `email.clicked`: Recipient clicked a link in the email\n- `email.opened`: Recipient opened the email\n- `email.unsubscribed`: Recipient unsubscribed\n- `email.failed`: Email failed to send\n\n**Supported Contact Events:**\n- `contact.created`: New contact created\n- `contact.updated`: Contact information updated\n- `contact.deleted`: Contact deleted\n\n**Supported Domain Events:**\n- `domain.created`: New domain added\n- `domain.updated`: Domain settings updated\n- `domain.deleted`: Domain removed\n\n**Webhook Security:**\n- Requires valid Resend webhook signature\n- Verifies webhook secret for authenticity\n- Processes events asynchronously\n- Records analytics data in Convex database\n"}}},"/analytics/orders":{"get":{"summary":"Get Order Analytics","description":"Get comprehensive order analytics with filtering and grouping options (admin/staff only)","tags":["Analytics"],"parameters":[{"in":"query","name":"startDate","schema":{"type":"string"},"description":"Start date filter (timestamp)","example":"1640995200000"},{"in":"query","name":"endDate","schema":{"type":"string"},"description":"End date filter (timestamp)","example":"1641081600000"},{"in":"query","name":"chefId","schema":{"type":"string"},"description":"Filter by specific chef ID","example":"j1234567890abcdef"},{"in":"query","name":"customerId","schema":{"type":"string"},"description":"Filter by specific customer ID","example":"j1234567890abcdef"},{"in":"query","name":"status","schema":{"type":"string"},"description":"Filter by order status","example":"completed"},{"in":"query","name":"groupBy","schema":{"type":"string","enum":["day","week","month","chef","status"],"default":"day"},"description":"Group analytics by time period or category","example":"day"},{"in":"query","name":"limit","schema":{"type":"integer","minimum":1,"maximum":1000,"default":100},"description":"Maximum number of results to return","example":100}],"responses":{"200":{"description":"Order analytics retrieved successfully","content":{"application/json":{"schema":{"type":"object","properties":{"success":{"type":"boolean","example":true},"data":{"type":"object","properties":{"success":{"type":"boolean","example":true},"analytics":{"type":"object","description":"Analytics data grouped by specified criteria","properties":{"totalOrders":{"type":"number","description":"Total number of orders","example":1250},"totalRevenue":{"type":"number","description":"Total revenue","example":45678.5},"averageOrderValue":{"type":"number","description":"Average order value","example":36.54},"dataPoints":{"type":"array","description":"Data points based on grouping","items":{"type":"object","properties":{"period":{"type":"string","description":"Time period or category","example":"2024-01-15"},"orders":{"type":"number","description":"Number of orders","example":45},"revenue":{"type":"number","description":"Revenue for period","example":1643.25},"chefId":{"type":"string","nullable":true,"description":"Chef ID (if grouped by chef)","example":"j1234567890abcdef"},"status":{"type":"string","nullable":true,"description":"Order status (if grouped by status)","example":"completed"}}}}}},"filters":{"type":"object","description":"Applied filters","properties":{"startDate":{"type":"string","nullable":true,"example":"1640995200000"},"endDate":{"type":"string","nullable":true,"example":"1641081600000"},"chefId":{"type":"string","nullable":true,"example":"j1234567890abcdef"},"customerId":{"type":"string","nullable":true,"example":"j1234567890abcdef"},"status":{"type":"string","nullable":true,"example":"completed"},"groupBy":{"type":"string","example":"day"},"limit":{"type":"number","example":100}}},"generatedAt":{"type":"string","format":"date-time","description":"Analytics generation timestamp","example":"2024-01-15T10:30:00.000Z"}}},"message":{"type":"string","example":"Success"}}}}}},"401":{"description":"Unauthorized - invalid or missing authentication","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}},"403":{"description":"Forbidden - insufficient permissions (admin/staff only)","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}},"500":{"description":"Internal server error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}}},"security":[{"bearerAuth":[]}]}},"/analytics/event":{"post":{"summary":"Track Analytics Events","description":"Track user interaction events for analytics and heatmap data","tags":["Analytics"],"requestBody":{"required":true,"content":{"application/json":{"schema":{"type":"object","required":["events"],"properties":{"events":{"type":"array","description":"Array of analytics events to track","items":{"type":"object","required":["type"],"properties":{"type":{"type":"string","description":"Event type identifier","example":"page_view"},"timestamp":{"type":"number","nullable":true,"description":"Event timestamp (defaults to current time)","example":1640995200000},"page":{"type":"string","nullable":true,"description":"Page URL or identifier","example":"/customer/menu"},"x":{"type":"number","nullable":true,"description":"X coordinate for click events","example":150},"y":{"type":"number","nullable":true,"description":"Y coordinate for click events","example":300},"extra":{"type":"object","nullable":true,"description":"Additional event data","example":{"user_agent":"Mozilla/5.0","session_id":"abc123"}}}}}}}}}},"responses":{"200":{"description":"Events tracked successfully","content":{"application/json":{"schema":{"type":"object","properties":{"success":{"type":"boolean","example":true},"data":{"type":"object","properties":{"success":{"type":"boolean","example":true}}},"message":{"type":"string","example":"Success"}}}}}},"400":{"description":"Validation error or analytics processing failed","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}},"500":{"description":"Internal server error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}}},"security":[]}},"/chef/profile":{"get":{"summary":"Get Chef Profile","description":"Retrieve the current authenticated chef's profile information","tags":["Chef","Profile"],"responses":{"200":{"description":"Chef profile retrieved successfully","content":{"application/json":{"schema":{"type":"object","properties":{"success":{"type":"boolean","example":true},"data":{"type":"object","properties":{"chef":{"type":"object","properties":{"_id":{"type":"string","description":"Chef profile ID","example":"j1234567890abcdef"},"userId":{"type":"string","description":"Associated user ID","example":"j1234567890abcdef"},"name":{"type":"string","example":"Chef Mario"},"bio":{"type":"string","example":"Passionate Italian chef with 15 years of experience"},"specialties":{"type":"array","items":{"type":"string"},"example":["italian","pasta","pizza"]},"location":{"type":"object","properties":{"coordinates":{"type":"array","items":{"type":"number"},"example":[-0.1276,51.5074]},"address":{"type":"string","example":"123 Baker Street, London"}}},"image":{"type":"string","nullable":true,"example":"https://example.com/chef-image.jpg"},"rating":{"type":"number","example":4.8},"status":{"type":"string","example":"active"}}}}},"message":{"type":"string","example":"Success"}}}}}},"401":{"description":"Unauthorized - invalid or missing authentication","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}},"403":{"description":"Forbidden - only chefs can access this endpoint","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}},"404":{"description":"Chef profile not found","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}},"500":{"description":"Internal server error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}}},"security":[{"bearerAuth":[]}]},"put":{"summary":"Update Chef Profile","description":"Update the current authenticated chef's profile information","tags":["Chef","Profile"],"requestBody":{"required":true,"content":{"application/json":{"schema":{"type":"object","properties":{"name":{"type":"string","nullable":true,"description":"Chef display name","example":"Chef Mario"},"bio":{"type":"string","nullable":true,"description":"Chef biography","example":"Passionate Italian chef with 15 years of experience"},"specialties":{"type":"array","items":{"type":"string"},"nullable":true,"description":"Chef's cooking specialties","example":["italian","pasta","pizza"]},"location":{"type":"object","nullable":true,"description":"Chef's location","properties":{"coordinates":{"type":"array","items":{"type":"number"},"example":[-0.1276,51.5074]},"address":{"type":"string","example":"123 Baker Street, London"}}},"image":{"type":"string","nullable":true,"description":"Chef profile image URL","example":"https://example.com/chef-image.jpg"},"rating":{"type":"number","nullable":true,"description":"Chef rating (0-5)","example":4.8}}}}}},"responses":{"200":{"description":"Chef profile updated successfully","content":{"application/json":{"schema":{"type":"object","properties":{"success":{"type":"boolean","example":true},"data":{"type":"object","properties":{"success":{"type":"boolean","example":true}}},"message":{"type":"string","example":"Success"}}}}}},"401":{"description":"Unauthorized - invalid or missing authentication","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}},"403":{"description":"Forbidden - only chefs can access this endpoint","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}},"404":{"description":"Chef profile not found","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}},"500":{"description":"Internal server error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}}},"security":[{"bearerAuth":[]}]}},"/chef/cuisines":{"get":{"summary":"Get All Cuisines","description":"Retrieve all available cuisine types","tags":["Chef","Cuisines"],"responses":{"200":{"description":"Cuisines retrieved successfully","content":{"application/json":{"schema":{"type":"object","properties":{"success":{"type":"boolean","example":true},"data":{"type":"object","properties":{"cuisines":{"type":"array","description":"Array of available cuisine types","items":{"type":"string"},"example":["italian","chinese","indian","mexican","thai","french","japanese","mediterranean"]}}},"message":{"type":"string","example":"Success"}}}}}},"500":{"description":"Internal server error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}}},"security":[]}},"/chef/status":{"get":{"summary":"Get Chef Status","description":"Check the status of the authenticated chef's profile","tags":["Chef","Status"],"responses":{"200":{"description":"Chef status retrieved successfully","content":{"application/json":{"schema":{"type":"object","properties":{"success":{"type":"boolean","example":true},"data":{"type":"object","description":"Empty object indicating chef profile exists","example":{}},"message":{"type":"string","example":"Success"}}}}}},"401":{"description":"Unauthorized - authentication required","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}},"404":{"description":"Chef profile not found","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}},"500":{"description":"Internal server error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}}},"security":[{"bearerAuth":[]}]}},"/chef/meals":{"get":{"summary":"Get Chef Meals","description":"Retrieve meals created by the authenticated chef","tags":["Chef","Meals"],"parameters":[{"in":"query","name":"limit","schema":{"type":"integer","minimum":1,"maximum":100,"default":10},"description":"Number of meals to return","example":10},{"in":"query","name":"offset","schema":{"type":"integer","minimum":0,"default":0},"description":"Number of meals to skip","example":0}],"responses":{"200":{"description":"Chef meals retrieved successfully","content":{"application/json":{"schema":{"type":"object","properties":{"success":{"type":"boolean","example":true},"data":{"type":"object","properties":{"meals":{"type":"array","description":"Array of chef's meals","items":{"type":"object","properties":{"_id":{"type":"string","description":"Meal ID","example":"j1234567890abcdef"},"chefId":{"type":"string","description":"Chef ID who created the meal","example":"j1234567890abcdef"},"name":{"type":"string","description":"Meal name","example":"Authentic Italian Pasta"},"description":{"type":"string","description":"Meal description","example":"Handmade pasta with fresh ingredients"},"price":{"type":"number","description":"Meal price","example":15.99},"cuisine":{"type":"string","description":"Cuisine type","example":"italian"},"ingredients":{"type":"array","items":{"type":"string"},"description":"List of ingredients","example":["pasta","tomatoes","basil","parmesan"]},"dietaryInfo":{"type":"object","description":"Dietary information","properties":{"vegetarian":{"type":"boolean","example":true},"vegan":{"type":"boolean","example":false},"glutenFree":{"type":"boolean","example":false},"allergens":{"type":"array","items":{"type":"string"},"example":["dairy"]}}},"prepTime":{"type":"number","description":"Preparation time in minutes","example":30},"servings":{"type":"number","description":"Number of servings","example":2},"image":{"type":"string","nullable":true,"description":"Meal image URL","example":"https://example.com/meal-image.jpg"},"status":{"type":"string","enum":["draft","active","inactive","archived"],"description":"Meal status","example":"active"},"rating":{"type":"number","nullable":true,"description":"Average rating","example":4.5},"reviewCount":{"type":"number","description":"Number of reviews","example":25},"createdAt":{"type":"string","format":"date-time","description":"Creation timestamp","example":"2024-01-15T10:00:00.000Z"},"updatedAt":{"type":"string","format":"date-time","nullable":true,"description":"Last update timestamp","example":"2024-01-15T15:30:00.000Z"}}}}}},"message":{"type":"string","example":"Success"}}}}}},"401":{"description":"Unauthorized - invalid or missing authentication","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}},"403":{"description":"Forbidden - only chefs can access this endpoint","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}},"404":{"description":"Chef profile not found","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}},"500":{"description":"Internal server error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}}},"security":[{"bearerAuth":[]}]},"post":{"summary":"Create New Meal","description":"Create a new meal/dish for the authenticated chef","tags":["Chef","Meals"],"requestBody":{"required":true,"content":{"application/json":{"schema":{"type":"object","required":["name","description","price","category"],"properties":{"name":{"type":"string","description":"Name of the meal","example":"Authentic Italian Pasta"},"description":{"type":"string","description":"Detailed description of the meal","example":"Handmade pasta with fresh ingredients and traditional Italian sauce"},"price":{"type":"number","description":"Price of the meal","example":15.99},"category":{"type":"string","description":"Meal category/cuisine type","example":"italian"},"ingredients":{"type":"array","items":{"type":"string"},"description":"List of ingredients","example":["pasta","tomatoes","basil","parmesan"]},"allergens":{"type":"array","items":{"type":"string"},"description":"List of allergens","example":["gluten","dairy"]},"image":{"type":"string","description":"Image URL for the meal","example":"https://example.com/meal-image.jpg"},"preparationTime":{"type":"number","description":"Preparation time in minutes","example":30},"servings":{"type":"number","description":"Number of servings","example":2}}}}}},"responses":{"200":{"description":"Meal created successfully","content":{"application/json":{"schema":{"type":"object","properties":{"success":{"type":"boolean","example":true},"data":{"type":"object","properties":{"mealId":{"type":"string","description":"ID of the created meal","example":"j1234567890abcdef"},"success":{"type":"boolean","example":true}}},"message":{"type":"string","example":"Success"}}}}}},"400":{"description":"Validation error - missing required fields","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}},"401":{"description":"Unauthorized - invalid or missing authentication","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}},"403":{"description":"Forbidden - only chefs can create meals","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}},"404":{"description":"Chef profile not found","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}},"500":{"description":"Internal server error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}}},"security":[{"bearerAuth":[]}]}},"/chef/availability":{"get":{"summary":"Get Chef Availability","description":"Retrieve the current availability status and schedule for the authenticated chef","tags":["Chef","Availability"],"responses":{"200":{"description":"Chef availability retrieved successfully","content":{"application/json":{"schema":{"type":"object","properties":{"success":{"type":"boolean","example":true},"data":{"type":"object","properties":{"availability":{"type":"object","properties":{"_id":{"type":"string","description":"Availability record ID","example":"j1234567890abcdef"},"chefId":{"type":"string","description":"Chef ID","example":"j1234567890abcdef"},"isAvailable":{"type":"boolean","description":"Whether the chef is currently available for orders","example":true},"availableDays":{"type":"array","items":{"type":"string"},"description":"Days of the week when chef is available","example":["monday","tuesday","wednesday","thursday","friday"]},"availableHours":{"type":"object","description":"Available hours for each day","example":{"monday":{"start":"09:00","end":"21:00"},"tuesday":{"start":"09:00","end":"21:00"},"wednesday":{"start":"09:00","end":"21:00"}}},"maxOrdersPerDay":{"type":"number","description":"Maximum number of orders chef can accept per day","example":15},"advanceBookingDays":{"type":"number","description":"Number of days in advance orders can be booked","example":7},"specialInstructions":{"type":"string","nullable":true,"description":"Special instructions for availability","example":"Not available on weekends"},"currentOrdersToday":{"type":"number","description":"Number of orders already accepted today","example":5},"nextAvailableSlot":{"type":"string","format":"date-time","nullable":true,"description":"Next available time slot","example":"2024-01-15T14:00:00.000Z"},"createdAt":{"type":"string","format":"date-time","description":"Availability record creation timestamp","example":"2024-01-15T10:00:00.000Z"},"updatedAt":{"type":"string","format":"date-time","description":"Last update timestamp","example":"2024-01-15T15:30:00.000Z"}}}}},"message":{"type":"string","example":"Success"}}}}}},"401":{"description":"Unauthorized - invalid or missing authentication","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}},"403":{"description":"Forbidden - only chefs can access this endpoint","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}},"404":{"description":"Chef profile not found","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}},"500":{"description":"Internal server error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}}},"security":[{"bearerAuth":[]}]},"put":{"summary":"Update Chef Availability","description":"Update the availability status and schedule for the authenticated chef","tags":["Chef","Availability"],"requestBody":{"required":true,"content":{"application/json":{"schema":{"type":"object","required":["isAvailable"],"properties":{"isAvailable":{"type":"boolean","description":"Whether the chef is currently available for orders","example":true},"availableDays":{"type":"array","items":{"type":"string","enum":["monday","tuesday","wednesday","thursday","friday","saturday","sunday"]},"description":"Days of the week when chef is available","example":["monday","tuesday","wednesday","thursday","friday"]},"availableHours":{"type":"object","description":"Available hours for each day","example":{"monday":{"start":"09:00","end":"21:00"},"tuesday":{"start":"09:00","end":"21:00"},"wednesday":{"start":"09:00","end":"21:00"}}},"maxOrdersPerDay":{"type":"number","minimum":1,"maximum":50,"description":"Maximum number of orders chef can accept per day","example":15},"advanceBookingDays":{"type":"number","minimum":1,"maximum":30,"description":"Number of days in advance orders can be booked","example":7},"specialInstructions":{"type":"string","nullable":true,"description":"Special instructions for availability","example":"Not available on weekends"}}}}}},"responses":{"200":{"description":"Chef availability updated successfully","content":{"application/json":{"schema":{"type":"object","properties":{"success":{"type":"boolean","example":true},"data":{"type":"object","properties":{"availability":{"type":"object","properties":{"_id":{"type":"string","example":"j1234567890abcdef"},"chefId":{"type":"string","example":"j1234567890abcdef"},"isAvailable":{"type":"boolean","example":true},"availableDays":{"type":"array","items":{"type":"string"},"example":["monday","tuesday","wednesday","thursday","friday"]},"availableHours":{"type":"object","example":{"monday":{"start":"09:00","end":"21:00"},"tuesday":{"start":"09:00","end":"21:00"}}},"maxOrdersPerDay":{"type":"number","example":15},"advanceBookingDays":{"type":"number","example":7},"specialInstructions":{"type":"string","nullable":true,"example":"Not available on weekends"},"updatedAt":{"type":"string","format":"date-time","example":"2024-01-15T15:30:00.000Z"}}}}},"message":{"type":"string","example":"Success"}}}}}},"400":{"description":"Validation error - missing required fields or invalid values","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}},"401":{"description":"Unauthorized - invalid or missing authentication","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}},"403":{"description":"Forbidden - only chefs can access this endpoint","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}},"404":{"description":"Chef profile not found","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}},"500":{"description":"Internal server error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}}},"security":[{"bearerAuth":[]}]}},"/chef/orders":{"get":{"summary":"Get Chef Orders","description":"Retrieve orders assigned to the authenticated chef","tags":["Chef","Orders"],"responses":{"200":{"description":"Chef orders retrieved successfully","content":{"application/json":{"schema":{"type":"object","properties":{"success":{"type":"boolean","example":true},"data":{"type":"object","properties":{"orders":{"type":"array","description":"Array of orders assigned to the chef","items":{"type":"object","properties":{"_id":{"type":"string","description":"Order ID","example":"j1234567890abcdef"},"order_id":{"type":"string","description":"Public order ID","example":"ORD-12345"},"customer_id":{"type":"string","description":"Customer ID","example":"j1234567890abcdef"},"chef_id":{"type":"string","description":"Chef ID","example":"j1234567890abcdef"},"order_status":{"type":"string","enum":["pending","confirmed","preparing","ready","delivered","completed","cancelled"],"description":"Current order status","example":"preparing"},"payment_status":{"type":"string","enum":["pending","processing","completed","failed","refunded"],"description":"Payment status","example":"completed"},"total_amount":{"type":"number","description":"Total order amount","example":25.99},"delivery_address":{"type":"object","description":"Delivery address","properties":{"street":{"type":"string","example":"123 Main St"},"city":{"type":"string","example":"London"},"postcode":{"type":"string","example":"SW1A 1AA"},"country":{"type":"string","example":"UK"}}},"special_instructions":{"type":"string","nullable":true,"description":"Special delivery instructions","example":"Leave at front door"},"delivery_time":{"type":"string","nullable":true,"description":"Preferred delivery time","example":"2024-01-15T18:00:00.000Z"},"estimated_prep_time_minutes":{"type":"number","nullable":true,"description":"Estimated preparation time in minutes","example":30},"chef_notes":{"type":"string","nullable":true,"description":"Chef's notes about the order","example":"Extra spicy as requested"},"order_items":{"type":"array","description":"Items in the order","items":{"type":"object","properties":{"dishId":{"type":"string","example":"j1234567890abcdef"},"quantity":{"type":"number","example":2},"price":{"type":"number","example":12.99}}}},"createdAt":{"type":"string","format":"date-time","description":"Order creation timestamp","example":"2024-01-15T17:00:00.000Z"},"updatedAt":{"type":"string","format":"date-time","nullable":true,"description":"Last update timestamp","example":"2024-01-15T17:30:00.000Z"}}}}}},"message":{"type":"string","example":"Success"}}}}}},"401":{"description":"Unauthorized - invalid or missing authentication","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}},"403":{"description":"Forbidden - only chefs can access this endpoint","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}},"500":{"description":"Internal server error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}}},"security":[{"bearerAuth":[]}]}},"/chef/dishes":{"get":{"summary":"Get Chef Dishes","description":"Retrieve dishes/menu items created by the authenticated chef","tags":["Chef","Dishes","Meals"],"parameters":[{"in":"query","name":"limit","schema":{"type":"integer","minimum":1,"maximum":100,"default":20},"description":"Number of dishes to return","example":20},{"in":"query","name":"offset","schema":{"type":"integer","minimum":0,"default":0},"description":"Number of dishes to skip","example":0}],"responses":{"200":{"description":"Chef dishes retrieved successfully","content":{"application/json":{"schema":{"type":"object","properties":{"success":{"type":"boolean","example":true},"data":{"type":"object","properties":{"chef_profile":{"type":"object","description":"Chef profile information","properties":{"chefId":{"type":"string","description":"Chef ID","example":"j1234567890abcdef"},"name":{"type":"string","example":"Chef Mario"},"specialties":{"type":"array","items":{"type":"string"},"example":["italian","pasta"]},"location":{"type":"object","properties":{"coordinates":{"type":"array","items":{"type":"number"},"example":[-0.1276,51.5074]},"address":{"type":"string","example":"123 Baker Street, London"}}},"status":{"type":"string","example":"active"},"rating":{"type":"number","example":4.8}}},"dishes":{"type":"array","description":"Array of chef's dishes","items":{"type":"object","properties":{"_id":{"type":"string","description":"Dish ID","example":"j1234567890abcdef"},"chefId":{"type":"string","description":"Chef ID who created the dish","example":"j1234567890abcdef"},"name":{"type":"string","description":"Dish name","example":"Spaghetti Carbonara"},"description":{"type":"string","description":"Dish description","example":"Classic Italian pasta with eggs, cheese, and pancetta"},"price":{"type":"number","description":"Dish price","example":18.99},"cuisine":{"type":"string","description":"Cuisine type","example":"italian"},"ingredients":{"type":"array","items":{"type":"string"},"description":"List of ingredients","example":["pasta","eggs","parmesan","pancetta"]},"dietaryInfo":{"type":"object","description":"Dietary information","properties":{"vegetarian":{"type":"boolean","example":false},"vegan":{"type":"boolean","example":false},"glutenFree":{"type":"boolean","example":false},"allergens":{"type":"array","items":{"type":"string"},"example":["eggs","dairy"]}}},"prepTime":{"type":"number","description":"Preparation time in minutes","example":25},"servings":{"type":"number","description":"Number of servings","example":2},"image":{"type":"string","nullable":true,"description":"Dish image URL","example":"https://example.com/dish-image.jpg"},"status":{"type":"string","enum":["draft","active","inactive","archived"],"description":"Dish status","example":"active"},"rating":{"type":"number","nullable":true,"description":"Average rating","example":4.7},"reviewCount":{"type":"number","description":"Number of reviews","example":15},"createdAt":{"type":"string","format":"date-time","description":"Creation timestamp","example":"2024-01-15T10:00:00.000Z"},"updatedAt":{"type":"string","format":"date-time","nullable":true,"description":"Last update timestamp","example":"2024-01-15T15:30:00.000Z"}}}}}},"message":{"type":"string","example":"Success"}}}}}},"401":{"description":"Unauthorized - invalid or missing authentication","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}},"403":{"description":"Forbidden - only chefs can access this endpoint","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}},"404":{"description":"Chef profile not found","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}},"500":{"description":"Internal server error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}}},"security":[{"bearerAuth":[]}]}},"/waitlist/user-confirmation":{"post":{"summary":"Send Waitlist Confirmation","description":"Send confirmation email to user who joined the waitlist","tags":["Waitlist","Early Access","Email"],"requestBody":{"required":true,"content":{"application/json":{"schema":{"type":"object","required":["email"],"properties":{"email":{"type":"string","format":"email","description":"User email address to send confirmation to","example":"user@example.com"}}}}}},"responses":{"200":{"description":"Confirmation email sent successfully","content":{"application/json":{"schema":{"type":"object","properties":{"success":{"type":"boolean","example":true},"data":{"type":"object","properties":{"email":{"type":"string","example":"user@example.com"},"confirmationSent":{"type":"boolean","example":true},"broadcastListAdded":{"type":"boolean","example":true},"emailDetails":{"type":"object","properties":{"subject":{"type":"string","example":"You are on the waitlist!"},"from":{"type":"string","example":"earlyaccess@emails.cribnosh.com"},"to":{"type":"string","example":"user@example.com"},"timestamp":{"type":"string","format":"date-time","example":"2024-01-15T10:00:00.000Z"}}}}},"message":{"type":"string","example":"Confirmation email sent successfully"}}}}}},"400":{"description":"Validation error - missing email","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}},"500":{"description":"Internal server error - email sending failed","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}}}}},"/api/messaging/conversations":{"get":{"summary":"Get conversations","description":"Get all conversations","tags":["Messaging"],"responses":{"200":{"description":"Conversations retrieved successfully","content":{"application/json":{"schema":{"type":"object","properties":{"message":{"type":"string"},"data":{"type":"array"}}}}}},"500":{"description":"Internal server error"}}}},"/api/messaging/offline":{"post":{"summary":"Set user offline","description":"Set user status to offline","tags":["Messaging"],"requestBody":{"required":true,"content":{"application/json":{"schema":{"type":"object","properties":{"userId":{"type":"string"}}}}}},"responses":{"200":{"description":"User set offline successfully","content":{"application/json":{"schema":{"type":"object","properties":{"message":{"type":"string"}}}}}},"500":{"description":"Internal server error"}}}},"/api/messaging/messages":{"get":{"summary":"Get messages","description":"Get messages with filtering and pagination","tags":["Messaging"],"parameters":[{"in":"query","name":"chatId","schema":{"type":"string"},"description":"Filter messages by chat ID"},{"in":"query","name":"limit","schema":{"type":"integer","minimum":1,"maximum":100,"default":50},"description":"Number of messages to return"},{"in":"query","name":"offset","schema":{"type":"integer","minimum":0,"default":0},"description":"Number of messages to skip"}],"responses":{"200":{"description":"Messages retrieved successfully","content":{"application/json":{"schema":{"type":"object","properties":{"success":{"type":"boolean"},"data":{"type":"array","items":{"type":"object"}},"pagination":{"type":"object"}}}}}},"500":{"description":"Internal server error"}}}},"/api/messaging/read":{"post":{"summary":"Mark message as read","description":"Mark a message as read","tags":["Messaging"],"requestBody":{"required":true,"content":{"application/json":{"schema":{"type":"object","properties":{"messageId":{"type":"string"}}}}}},"responses":{"200":{"description":"Message marked as read successfully","content":{"application/json":{"schema":{"type":"object","properties":{"message":{"type":"string"}}}}}},"500":{"description":"Internal server error"}}}},"/api/messaging/send":{"post":{"summary":"Send message","description":"Send a message to a chat","tags":["Messaging"],"requestBody":{"required":true,"content":{"application/json":{"schema":{"type":"object","required":["content","chatId"],"properties":{"content":{"type":"string","description":"Message content"},"chatId":{"type":"string","description":"Chat ID"},"replyTo":{"type":"string","description":"Message ID to reply to"},"attachments":{"type":"array","items":{"type":"object"},"description":"Message attachments"}}}}}},"responses":{"200":{"description":"Message sent successfully","content":{"application/json":{"schema":{"type":"object","properties":{"success":{"type":"boolean"},"data":{"type":"object"}}}}}},"400":{"description":"Bad request"},"401":{"description":"Unauthorized"},"500":{"description":"Internal server error"}}}},"/api/messaging/online":{"get":{"summary":"Get online users","description":"Get list of online users","tags":["Messaging"],"responses":{"200":{"description":"Online users retrieved successfully","content":{"application/json":{"schema":{"type":"object","properties":{"message":{"type":"string"},"data":{"type":"array"}}}}}},"500":{"description":"Internal server error"}}}},"/api/messaging/notifications":{"get":{"summary":"Get messaging notifications","description":"Get messaging notifications","tags":["Messaging"],"responses":{"200":{"description":"Notifications retrieved successfully","content":{"application/json":{"schema":{"type":"object","properties":{"message":{"type":"string"},"data":{"type":"array"}}}}}},"500":{"description":"Internal server error"}}}},"/api/messaging/typing":{"post":{"summary":"Update typing status","description":"Update user typing status","tags":["Messaging"],"requestBody":{"required":true,"content":{"application/json":{"schema":{"type":"object","properties":{"chatId":{"type":"string"},"isTyping":{"type":"boolean"}}}}}},"responses":{"200":{"description":"Typing status updated successfully","content":{"application/json":{"schema":{"type":"object","properties":{"message":{"type":"string"}}}}}},"500":{"description":"Internal server error"}}}},"/orders/ready":{"post":{"summary":"Mark Order as Ready","description":"Mark an order as ready for pickup/delivery (admin, staff, chef only)","tags":["Orders","Order Management","Preparation"],"requestBody":{"required":true,"content":{"application/json":{"schema":{"type":"object","required":["orderId"],"properties":{"orderId":{"type":"string","description":"Order ID to mark as ready","example":"ORD-12345"},"readyNotes":{"type":"string","description":"Notes about order readiness","example":"Order is ready for pickup, all items prepared"},"packagingNotes":{"type":"string","description":"Packaging instructions or notes","example":"Fragile items marked, hot items in insulated bag"},"metadata":{"type":"object","description":"Additional readiness metadata","example":{"packagingType":"eco_friendly","temperature":"hot"}}}}}}},"responses":{"200":{"description":"Order marked as ready successfully","content":{"application/json":{"schema":{"type":"object","properties":{"success":{"type":"boolean","example":true},"data":{"type":"object","properties":{"orderId":{"type":"string","example":"ORD-12345"},"status":{"type":"string","description":"Updated order status","example":"ready"},"readyAt":{"type":"string","format":"date-time","description":"When the order was marked as ready","example":"2024-01-15T10:00:00.000Z"},"readyNotes":{"type":"string","example":"Order is ready for pickup, all items prepared"},"packagingNotes":{"type":"string","example":"Fragile items marked, hot items in insulated bag"},"preparedBy":{"type":"string","description":"ID of the person who prepared the order","example":"j1234567890abcdef"},"preparedByRole":{"type":"string","description":"Role of the person who prepared","example":"chef"},"prepDuration":{"type":"number","description":"Total preparation time in minutes","example":25},"estimatedDeliveryTime":{"type":"number","description":"Estimated delivery time in minutes","example":15},"metadata":{"type":"object","example":{"packagingType":"eco_friendly"}}}},"message":{"type":"string","example":"Order marked as ready successfully"}}}}}},"400":{"description":"Validation error - missing required fields","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}},"401":{"description":"Unauthorized - invalid or missing authentication","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}},"403":{"description":"Forbidden - insufficient permissions to mark orders as ready","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}},"404":{"description":"Order not found","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}},"409":{"description":"Conflict - order cannot be marked as ready in current status","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}},"500":{"description":"Internal server error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}}},"security":[{"bearerAuth":[]}]}},"/api/nosh-heaven/admin/videos":{"get":{"summary":"Get all videos for admin","description":"Retrieves all videos with admin details for moderation","tags":["Nosh Heaven","Admin","Videos"],"security":[{"Bearer":[]}],"parameters":[{"in":"query","name":"status","schema":{"type":"string","enum":["draft","published","archived","flagged","removed"]},"description":"Filter by video status"},{"in":"query","name":"limit","schema":{"type":"integer","default":20},"description":"Number of videos to return"},{"in":"query","name":"cursor","schema":{"type":"string"},"description":"Cursor for pagination"}],"responses":{"200":{"description":"Videos retrieved successfully","content":{"application/json":{"schema":{"type":"object","properties":{"success":{"type":"boolean","example":true},"data":{"type":"object","properties":{"videos":{"type":"array","items":{"$ref":"#/components/schemas/VideoPost"}},"nextCursor":{"type":"string","description":"Cursor for next page"}}},"message":{"type":"string","example":"Videos retrieved successfully"}}}}}},"401":{"description":"Unauthorized"},"403":{"description":"Forbidden - Admin access required"}}}},"/api/nosh-heaven/search/users":{"get":{"summary":"Search users","description":"Searches for users by name or email","tags":["Nosh Heaven","Search","Users"],"parameters":[{"in":"query","name":"q","required":true,"schema":{"type":"string"},"description":"Search query","example":"chef john"},{"in":"query","name":"limit","schema":{"type":"integer","default":20},"description":"Number of results to return"},{"in":"query","name":"cursor","schema":{"type":"string"},"description":"Cursor for pagination"}],"responses":{"200":{"description":"Search results retrieved successfully","content":{"application/json":{"schema":{"type":"object","properties":{"success":{"type":"boolean","example":true},"data":{"type":"object","properties":{"users":{"type":"array","items":{"$ref":"#/components/schemas/User"}},"nextCursor":{"type":"string","description":"Cursor for next page"}}},"message":{"type":"string","example":"Search results retrieved successfully"}}}}}},"400":{"description":"Validation error"}}}},"/api/nosh-heaven/search/videos":{"get":{"summary":"Search videos","description":"Searches for videos based on query, cuisine, difficulty, and tags","tags":["Nosh Heaven","Search","Videos"],"parameters":[{"in":"query","name":"q","required":true,"schema":{"type":"string"},"description":"Search query","example":"pasta recipe"},{"in":"query","name":"cuisine","schema":{"type":"string"},"description":"Filter by cuisine type","example":"Italian"},{"in":"query","name":"difficulty","schema":{"type":"string","enum":["beginner","intermediate","advanced"]},"description":"Filter by difficulty level","example":"intermediate"},{"in":"query","name":"tags","schema":{"type":"array","items":{"type":"string"}},"description":"Filter by tags","example":["vegetarian","quick"]},{"in":"query","name":"limit","schema":{"type":"integer","default":20},"description":"Number of results to return"},{"in":"query","name":"cursor","schema":{"type":"string"},"description":"Cursor for pagination"}],"responses":{"200":{"description":"Search results retrieved successfully","content":{"application/json":{"schema":{"type":"object","properties":{"success":{"type":"boolean","example":true},"data":{"type":"object","properties":{"videos":{"type":"array","items":{"$ref":"#/components/schemas/VideoPost"}},"nextCursor":{"type":"string","description":"Cursor for next page"}}},"message":{"type":"string","example":"Search results retrieved successfully"}}}}}},"400":{"description":"Validation error"}}}},"/api/nosh-heaven/videos/thumbnail-upload-url":{"post":{"summary":"Generate presigned URL for thumbnail upload","description":"Creates a presigned URL for uploading video thumbnails to S3","tags":["Nosh Heaven","Videos"],"security":[{"Bearer":[]}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"type":"object","required":["videoId","fileName","fileSize","contentType"],"properties":{"videoId":{"type":"string","description":"ID of the video post","example":"j1234567890abcdef"},"fileName":{"type":"string","description":"Name of the thumbnail file","example":"thumbnail.jpg"},"fileSize":{"type":"number","description":"Size of the file in bytes","example":1048576},"contentType":{"type":"string","description":"MIME type of the file","example":"image/jpeg"}}}}}},"responses":{"200":{"description":"Presigned URL generated successfully","content":{"application/json":{"schema":{"type":"object","properties":{"success":{"type":"boolean","example":true},"data":{"type":"object","properties":{"uploadUrl":{"type":"string","description":"Presigned URL for uploading"},"key":{"type":"string","description":"S3 object key"},"publicUrl":{"type":"string","description":"Public URL for accessing the thumbnail"}}},"message":{"type":"string","example":"Thumbnail upload URL generated successfully"}}}}}},"400":{"description":"Validation error"},"401":{"description":"Unauthorized"},"403":{"description":"Forbidden"}}}},"/api/nosh-heaven/videos/upload-url":{"post":{"summary":"Generate presigned URL for video upload","description":"Creates a presigned URL for uploading videos to S3 for Nosh Heaven","tags":["Nosh Heaven","Videos"],"security":[{"Bearer":[]}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"type":"object","required":["fileName","fileSize","contentType"],"properties":{"fileName":{"type":"string","description":"Name of the video file","example":"my-cooking-video.mp4"},"fileSize":{"type":"number","description":"Size of the file in bytes","example":52428800},"contentType":{"type":"string","description":"MIME type of the file","example":"video/mp4"}}}}}},"responses":{"200":{"description":"Presigned URL generated successfully","content":{"application/json":null,"schema":{"type":"object","properties":{"success":{"type":"boolean","example":true},"data":{"type":"object","properties":{"uploadUrl":{"type":"string","description":"Presigned URL for uploading","example":"https://s3.amazonaws.com/bucket/videos/user123/1234567890_my-cooking-video.mp4?X-Amz-Algorithm=..."},"key":{"type":"string","description":"S3 object key","example":"videos/user123/1234567890_my-cooking-video.mp4"},"publicUrl":{"type":"string","description":"Public URL for accessing the video","example":"https://cdn.noshheaven.com/videos/user123/1234567890_my-cooking-video.mp4"}}},"message":{"type":"string","example":"Upload URL generated successfully"}}}}},"400":{"description":"Validation error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}},"401":{"description":"Unauthorized","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}},"403":{"description":"Forbidden - User not authorized to upload videos","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}}}}},"/chat/conversations":{"get":{"summary":"Get User Conversations","description":"Retrieve paginated list of conversations for the authenticated user","tags":["Chat","Messaging"],"parameters":[{"in":"query","name":"limit","schema":{"type":"integer","minimum":1,"maximum":100,"default":20},"description":"Number of conversations to return","example":20},{"in":"query","name":"offset","schema":{"type":"integer","minimum":0,"default":0},"description":"Number of conversations to skip","example":0}],"responses":{"200":{"description":"Conversations retrieved successfully","content":{"application/json":{"schema":{"type":"object","properties":{"success":{"type":"boolean","example":true},"data":{"type":"object","properties":{"conversations":{"type":"array","description":"Array of user conversations","items":{"type":"object","properties":{"_id":{"type":"string","description":"Conversation ID","example":"j1234567890abcdef"},"participants":{"type":"array","items":{"type":"string"},"description":"User IDs participating in the conversation","example":["j1234567890abcdef","j0987654321fedcba"]},"lastMessage":{"type":"object","nullable":true,"description":"Last message in the conversation","properties":{"_id":{"type":"string","example":"j1234567890abcdef"},"content":{"type":"string","example":"Hello, how can I help you?"},"senderId":{"type":"string","example":"j1234567890abcdef"},"timestamp":{"type":"string","format":"date-time","example":"2024-01-15T10:30:00.000Z"}}},"unreadCount":{"type":"number","description":"Number of unread messages for current user","example":3},"createdAt":{"type":"string","format":"date-time","description":"Conversation creation timestamp","example":"2024-01-15T09:00:00.000Z"},"updatedAt":{"type":"string","format":"date-time","description":"Last update timestamp","example":"2024-01-15T10:30:00.000Z"}}}},"total":{"type":"number","description":"Total number of conversations","example":45},"limit":{"type":"number","example":20},"offset":{"type":"number","example":0}}},"message":{"type":"string","example":"Success"}}}}}},"401":{"description":"Unauthorized - user not authenticated","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}},"500":{"description":"Internal server error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}}},"security":[{"cookieAuth":[]}]}},"/chat/messages":{"get":{"summary":"Get User Messages","description":"Retrieve all messages from all conversations for the authenticated user","tags":["Chat","Messaging"],"parameters":[{"in":"query","name":"limit","schema":{"type":"integer","minimum":1,"maximum":100,"default":20},"description":"Number of messages to return","example":20},{"in":"query","name":"offset","schema":{"type":"integer","minimum":0,"default":0},"description":"Number of messages to skip","example":0}],"responses":{"200":{"description":"Messages retrieved successfully","content":{"application/json":{"schema":{"type":"object","properties":{"success":{"type":"boolean","example":true},"data":{"type":"object","properties":{"messages":{"type":"array","description":"Array of user messages from all conversations","items":{"type":"object","properties":{"_id":{"type":"string","description":"Message ID","example":"j1234567890abcdef"},"chatId":{"type":"string","description":"Conversation ID this message belongs to","example":"j1234567890abcdef"},"content":{"type":"string","description":"Message content","example":"Hello, how can I help you today?"},"senderId":{"type":"string","description":"User ID who sent the message","example":"j1234567890abcdef"},"messageType":{"type":"string","enum":["text","image","file","system","notification"],"description":"Type of message","example":"text"},"metadata":{"type":"object","nullable":true,"description":"Additional message metadata","example":{"fileUrl":"https://example.com/file.pdf","fileSize":1024}},"isRead":{"type":"boolean","description":"Whether the message has been read","example":true},"createdAt":{"type":"number","description":"Message creation timestamp","example":1640995200000},"updatedAt":{"type":"number","nullable":true,"description":"Last update timestamp","example":1640995200000}}}},"total_count":{"type":"number","description":"Total number of messages across all conversations","example":150},"limit":{"type":"number","example":20},"offset":{"type":"number","example":0}}},"message":{"type":"string","example":"Success"}}}}}},"401":{"description":"Unauthorized - user not authenticated","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}},"500":{"description":"Internal server error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}}},"security":[{"cookieAuth":[]}]},"post":{"summary":"Send Message","description":"Send a message to a user (creates conversation if needed)","tags":["Chat","Messaging"],"requestBody":{"required":true,"content":{"application/json":{"schema":{"type":"object","required":["recipient_id"],"properties":{"recipient_id":{"type":"string","description":"User ID of the message recipient","example":"j1234567890abcdef"},"content":{"type":"string","nullable":true,"description":"Text content of the message","example":"Hello, how can I help you today?"},"fileUrl":{"type":"string","nullable":true,"description":"URL of attached file","example":"https://example.com/file.pdf"},"fileType":{"type":"string","nullable":true,"description":"Type of attached file","example":"application/pdf"},"fileName":{"type":"string","nullable":true,"description":"Name of attached file","example":"document.pdf"},"fileSize":{"type":"number","nullable":true,"description":"Size of attached file in bytes","example":1024},"metadata":{"type":"object","nullable":true,"description":"Additional message metadata","example":{"priority":"high"}}}}}}},"responses":{"200":{"description":"Message sent successfully","content":{"application/json":{"schema":{"type":"object","properties":{"success":{"type":"boolean","example":true},"data":{"type":"object","properties":{"_id":{"type":"string","description":"Message ID","example":"j1234567890abcdef"},"chatId":{"type":"string","description":"Conversation ID","example":"j1234567890abcdef"},"content":{"type":"string","example":"Hello, how can I help you today?"},"senderId":{"type":"string","example":"j1234567890abcdef"},"recipientId":{"type":"string","example":"j0987654321fedcba"},"fileUrl":{"type":"string","nullable":true,"example":"https://example.com/file.pdf"},"fileType":{"type":"string","nullable":true,"example":"application/pdf"},"fileName":{"type":"string","nullable":true,"example":"document.pdf"},"fileSize":{"type":"number","nullable":true,"example":1024},"createdAt":{"type":"number","example":1640995200000}}},"message":{"type":"string","example":"Success"}}}}}},"400":{"description":"Validation error - missing required fields","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}},"401":{"description":"Unauthorized - invalid or missing authentication","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}},"500":{"description":"Internal server error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}}},"security":[{"bearerAuth":[]}]}},"/admin/me":{"get":{"summary":"Get Admin Profile","description":"Retrieve the current authenticated admin user's profile information","tags":["Admin","Authentication"],"responses":{"200":{"description":"Admin profile retrieved successfully","content":{"application/json":{"schema":{"type":"object","properties":{"success":{"type":"boolean","example":true},"data":{"type":"object","properties":{"user":{"type":"object","properties":{"_id":{"type":"string","description":"Admin user ID","example":"j1234567890abcdef"},"email":{"type":"string","format":"email","example":"admin@cribnosh.com"},"name":{"type":"string","example":"Admin User"},"role":{"type":"string","description":"Primary role","example":"admin"},"roles":{"type":"array","items":{"type":"string"},"description":"All user roles","example":["admin"]},"status":{"type":"string","description":"User account status","example":"active"}}}}},"message":{"type":"string","example":"Admin user data retrieved successfully"}}}}}},"401":{"description":"Unauthorized - no session token or invalid token","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}},"403":{"description":"Forbidden - user is not an admin","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}},"500":{"description":"Internal server error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}}},"security":[{"cookieAuth":[]}]}},"/admin/users":{"get":{"summary":"Get All Users (Admin)","description":"Retrieve a paginated list of all users in the system (admin only)","tags":["Admin","User Management"],"parameters":[{"in":"query","name":"limit","schema":{"type":"integer","minimum":1,"maximum":100,"default":20},"description":"Number of users to return per page","example":20},{"in":"query","name":"offset","schema":{"type":"integer","minimum":0,"default":0},"description":"Number of users to skip","example":0}],"responses":{"200":{"description":"Users retrieved successfully","content":{"application/json":{"schema":{"type":"object","properties":{"success":{"type":"boolean","example":true},"data":{"type":"object","properties":{"users":{"type":"array","description":"Array of user objects","items":{"type":"object","properties":{"_id":{"type":"string","example":"j1234567890abcdef"},"email":{"type":"string","example":"user@example.com"},"name":{"type":"string","example":"John Doe"},"roles":{"type":"array","items":{"type":"string"},"example":["customer"]},"status":{"type":"string","example":"active"},"_creationTime":{"type":"number","example":1640995200000}}}},"total":{"type":"number","description":"Total number of users","example":1250},"limit":{"type":"number","example":20},"offset":{"type":"number","example":0}}},"message":{"type":"string","example":"Success"}}}}}},"401":{"description":"Unauthorized - invalid or missing authentication","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}},"403":{"description":"Forbidden - only admins can access this endpoint","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}},"500":{"description":"Internal server error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}}},"security":[{"bearerAuth":[]}]},"post":{"summary":"Bulk Delete Users (Admin)","description":"Delete multiple users by their IDs (admin only)","tags":["Admin","User Management"],"requestBody":{"required":true,"content":{"application/json":{"schema":{"type":"object","required":["user_ids"],"properties":{"user_ids":{"type":"array","items":{"type":"string"},"description":"Array of user IDs to delete","example":["j1234567890abcdef","j0987654321fedcba"]}}}}}},"responses":{"200":{"description":"Users deleted successfully","content":{"application/json":{"schema":{"type":"object","properties":{"success":{"type":"boolean","example":true},"data":{"type":"object","properties":{"success":{"type":"boolean","example":true},"deleted":{"type":"number","description":"Number of users deleted","example":2}}},"message":{"type":"string","example":"Success"}}}}}},"400":{"description":"Validation error - missing or invalid user_ids","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}},"401":{"description":"Unauthorized - invalid or missing authentication","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}},"403":{"description":"Forbidden - only admins can bulk delete users","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}},"422":{"description":"Validation error - user_ids array is required","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}},"500":{"description":"Internal server error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}}},"security":[{"bearerAuth":[]}]}},"/admin/analytics-overview":{"get":{"summary":"Get Analytics Overview","description":"Get comprehensive analytics overview for admin dashboard with revenue, orders, users, and trends","tags":["Admin","Analytics"],"parameters":[{"in":"query","name":"start","schema":{"type":"number"},"description":"Start timestamp for date range filter","example":1640995200000},{"in":"query","name":"end","schema":{"type":"number"},"description":"End timestamp for date range filter","example":1641081600000}],"responses":{"200":{"description":"Analytics overview retrieved successfully","content":{"application/json":{"schema":{"type":"object","properties":{"success":{"type":"boolean","example":true},"data":{"type":"object","properties":{"total_revenue":{"type":"number","description":"Total revenue in the specified period","example":45678.5},"total_orders":{"type":"number","description":"Total number of orders in the period","example":1250},"average_order_value":{"type":"number","description":"Average order value","example":36.54},"total_users":{"type":"number","description":"Total number of users in the period","example":850},"revenue_trend":{"type":"number","description":"Revenue trend percentage change from previous period","example":15.5},"orders_trend":{"type":"number","description":"Orders trend percentage change from previous period","example":8.2},"aov_trend":{"type":"number","description":"Average order value trend percentage change","example":6.7},"users_trend":{"type":"number","description":"Users trend percentage change from previous period","example":12.3}}},"message":{"type":"string","example":"Success"}}}}}},"401":{"description":"Unauthorized - invalid or missing authentication","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}},"403":{"description":"Forbidden - only admins can access analytics","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}},"500":{"description":"Internal server error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}}},"security":[{"bearerAuth":[]}]}},"/admin/login":{"post":{"summary":"Admin Login","description":"Authenticate admin users and create session tokens","tags":["Admin","Authentication"],"requestBody":{"required":true,"content":{"application/json":{"schema":{"type":"object","required":["email","password"],"properties":{"email":{"type":"string","format":"email","description":"Admin email address","example":"admin@cribnosh.com"},"password":{"type":"string","description":"Admin password","example":"securePassword123"}}}}}},"responses":{"200":{"description":"Admin login successful","content":{"application/json":{"schema":{"type":"object","properties":{"success":{"type":"boolean","example":true},"data":{"type":"object","properties":{"user":{"type":"object","properties":{"user_id":{"type":"string","description":"Admin user ID","example":"j1234567890abcdef"},"email":{"type":"string","example":"admin@cribnosh.com"},"name":{"type":"string","example":"Admin User"},"roles":{"type":"array","items":{"type":"string"},"example":["admin"]}}}}},"message":{"type":"string","example":"Success"}}}}},"headers":{"Set-Cookie":{"description":"Convex session token cookie","schema":{"type":"string","example":"convex-auth-token=session_token_here; HttpOnly; Secure; SameSite=Strict"}}}},"400":{"description":"Validation error - missing required fields or invalid JSON","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}},"401":{"description":"Unauthorized - invalid credentials or not an admin","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}},"500":{"description":"Internal server error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}},"503":{"description":"Service unavailable - authentication service down","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}}},"security":[]}},"/customer/cart":{"get":{"summary":"Get Customer Cart","description":"Get the current customer's shopping cart items","tags":["Customer"],"responses":{"200":{"description":"Cart retrieved successfully","content":{"application/json":{"schema":{"type":"object","properties":{"success":{"type":"boolean","example":true},"data":{"type":"object","properties":{"cart":{"type":"array","description":"Array of cart items","items":{"type":"object","properties":{"_id":{"type":"string","description":"Cart item ID","example":"j1234567890abcdef"},"dish_id":{"type":"string","description":"Dish ID","example":"j1234567890abcdef"},"quantity":{"type":"number","description":"Quantity of the item","example":2},"price":{"type":"number","description":"Price per item","example":15.99},"total_price":{"type":"number","description":"Total price for this item","example":31.98},"chef_id":{"type":"string","description":"Chef ID","example":"j1234567890abcdef"},"dish_name":{"type":"string","description":"Name of the dish","example":"Chicken Tikka Masala"},"chef_name":{"type":"string","description":"Name of the chef","example":"Chef John"},"added_at":{"type":"number","description":"Timestamp when item was added","example":1640995200000}}}}}},"message":{"type":"string","example":"Success"}}}}}},"401":{"description":"Unauthorized - invalid or missing authentication","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}},"403":{"description":"Forbidden - only customers can access their cart","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}},"500":{"description":"Internal server error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}}},"security":[{"bearerAuth":[]}]}},"/customer/checkout":{"post":{"summary":"Create Payment Intent","description":"Create a Stripe payment intent for checkout with items from the customer's cart","tags":["Customer"],"responses":{"200":{"description":"Payment intent created successfully","content":{"application/json":{"schema":{"type":"object","properties":{"success":{"type":"boolean","example":true},"data":{"type":"object","properties":{"paymentIntent":{"type":"object","properties":{"client_secret":{"type":"string","description":"Stripe client secret for payment confirmation","example":"pi_1234567890abcdef_secret_abcdef1234567890"},"amount":{"type":"number","description":"Total amount in GBP","example":31.98},"currency":{"type":"string","description":"Currency code","example":"gbp"},"id":{"type":"string","description":"Stripe payment intent ID","example":"pi_1234567890abcdef"}}}}},"message":{"type":"string","example":"Success"}}}}}},"400":{"description":"Validation error - cart is empty or invalid total","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}},"401":{"description":"Unauthorized - invalid or missing authentication","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}},"403":{"description":"Forbidden - only customers can checkout","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}},"500":{"description":"Internal server error or payment processing failed","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}}},"security":[{"bearerAuth":[]}]}},"/customer/cuisines":{"get":{"summary":"Get Available Cuisines","description":"Get a list of all available cuisines from the meals database","tags":["Customer"],"responses":{"200":{"description":"Cuisines retrieved successfully","content":{"application/json":{"schema":{"type":"object","properties":{"success":{"type":"boolean","example":true},"data":{"type":"object","properties":{"cuisines":{"type":"array","description":"Array of available cuisines","items":{"type":"string"},"example":["Italian","Indian","Chinese","Mexican","Mediterranean"]}}},"message":{"type":"string","example":"Success"}}}}}},"500":{"description":"Internal server error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}}},"security":[]}},"/customer/orders":{"get":{"summary":"Get Customer Orders","description":"Get paginated list of orders for the current customer","tags":["Customer"],"parameters":[{"in":"query","name":"limit","schema":{"type":"integer","minimum":1,"maximum":100,"default":20},"description":"Number of orders to return","example":20},{"in":"query","name":"offset","schema":{"type":"integer","minimum":0,"default":0},"description":"Number of orders to skip","example":0}],"responses":{"200":{"description":"Orders retrieved successfully","content":{"application/json":{"schema":{"type":"object","properties":{"success":{"type":"boolean","example":true},"data":{"type":"object","properties":{"orders":{"type":"array","description":"Array of customer orders","items":{"type":"object","properties":{"_id":{"type":"string","description":"Order ID","example":"j1234567890abcdef"},"customer_id":{"type":"string","description":"Customer ID","example":"j1234567890abcdef"},"chef_id":{"type":"string","description":"Chef ID","example":"j1234567890abcdef"},"order_items":{"type":"array","description":"Items in the order","items":{"type":"object","properties":{"dish_id":{"type":"string","example":"j1234567890abcdef"},"quantity":{"type":"number","example":2},"price":{"type":"number","example":15.99},"name":{"type":"string","example":"Chicken Tikka Masala"}}}},"total_amount":{"type":"number","description":"Total order amount","example":31.98},"status":{"type":"string","description":"Order status","example":"pending"},"payment_method":{"type":"string","description":"Payment method used","example":"card"},"special_instructions":{"type":"string","nullable":true,"description":"Special instructions for the order","example":"Extra spicy"},"delivery_time":{"type":"string","nullable":true,"description":"Requested delivery time","example":"2024-01-15T18:00:00.000Z"},"createdAt":{"type":"number","description":"Order creation timestamp","example":1640995200000}}}},"total":{"type":"number","description":"Total number of orders","example":25},"limit":{"type":"number","description":"Number of orders returned","example":20},"offset":{"type":"number","description":"Number of orders skipped","example":0}}},"message":{"type":"string","example":"Success"}}}}}},"401":{"description":"Unauthorized - invalid or missing authentication","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}},"403":{"description":"Forbidden - only customers can access their orders","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}},"500":{"description":"Internal server error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}}},"security":[{"bearerAuth":[]}]},"post":{"summary":"Create New Order","description":"Create a new order with items from a specific chef","tags":["Customer"],"requestBody":{"required":true,"content":{"application/json":{"schema":{"type":"object","required":["chef_id","order_items"],"properties":{"chef_id":{"type":"string","description":"ID of the chef","example":"j1234567890abcdef"},"order_items":{"type":"array","description":"Array of items to order","items":{"type":"object","required":["dish_id","quantity"],"properties":{"dish_id":{"type":"string","description":"ID of the dish","example":"j1234567890abcdef"},"quantity":{"type":"number","minimum":1,"description":"Quantity of the dish","example":2}}}},"special_instructions":{"type":"string","nullable":true,"description":"Special instructions for the order","example":"Extra spicy, no onions"},"delivery_time":{"type":"string","format":"date-time","nullable":true,"description":"Requested delivery time","example":"2024-01-15T18:00:00.000Z"},"payment_method":{"type":"string","description":"Payment method","example":"card"}}}}}},"responses":{"200":{"description":"Order created successfully","content":{"application/json":{"schema":{"type":"object","properties":{"success":{"type":"boolean","example":true},"data":{"type":"object","properties":{"success":{"type":"boolean","example":true},"order_id":{"type":"string","description":"Created order ID","example":"j1234567890abcdef"}}},"message":{"type":"string","example":"Success"}}}}}},"400":{"description":"Validation error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}},"401":{"description":"Unauthorized - invalid or missing authentication","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}},"403":{"description":"Forbidden - only customers can create orders","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}},"404":{"description":"Dish not found","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}},"500":{"description":"Internal server error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}}},"security":[{"bearerAuth":[]}]}},"/cooking/apply":{"post":{"summary":"Apply to Become a Chef","description":"Submit chef application with personal, kitchen, and culinary background information","tags":["Chef","Applications","Onboarding"],"requestBody":{"required":true,"content":{"application/json":{"schema":{"type":"object","required":["personalInfo","kitchenDetails","culinaryBackground"],"properties":{"personalInfo":{"type":"object","required":["email","firstName","lastName"],"properties":{"email":{"type":"string","format":"email","description":"Applicant's email address","example":"chef@example.com"},"firstName":{"type":"string","description":"First name","example":"John"},"lastName":{"type":"string","description":"Last name","example":"Doe"},"phone":{"type":"string","nullable":true,"description":"Phone number","example":"+1234567890"},"dateOfBirth":{"type":"string","format":"date","nullable":true,"description":"Date of birth","example":"1990-01-15"},"address":{"type":"object","nullable":true,"description":"Address information","properties":{"street":{"type":"string","example":"123 Main St"},"city":{"type":"string","example":"London"},"postcode":{"type":"string","example":"SW1A 1AA"},"country":{"type":"string","example":"UK"}}}}},"kitchenDetails":{"type":"object","required":["kitchenName","kitchenType"],"properties":{"kitchenName":{"type":"string","description":"Name of the kitchen","example":"Chef John's Kitchen"},"kitchenType":{"type":"string","enum":["home","commercial","food_truck","popup","other"],"description":"Type of kitchen","example":"home"},"kitchenAddress":{"type":"object","nullable":true,"description":"Kitchen address","properties":{"street":{"type":"string","example":"123 Kitchen St"},"city":{"type":"string","example":"London"},"postcode":{"type":"string","example":"SW1A 1AA"}}},"equipment":{"type":"array","items":{"type":"string"},"description":"Available kitchen equipment","example":["oven","stovetop","refrigerator","food_processor"]},"capacity":{"type":"number","nullable":true,"description":"Maximum serving capacity per day","example":50}}},"culinaryBackground":{"type":"object","required":["experience","cuisineTypes"],"properties":{"experience":{"type":"string","description":"Years of culinary experience","example":"5 years professional experience"},"cuisineTypes":{"type":"array","items":{"type":"string"},"description":"Types of cuisines they specialize in","example":["italian","french","mediterranean"]},"specialties":{"type":"array","items":{"type":"string"},"description":"Culinary specialties","example":["pasta","seafood","desserts"]},"certifications":{"type":"array","items":{"type":"string"},"description":"Culinary certifications","example":["ServSafe","Culinary Institute Certificate"]},"education":{"type":"string","nullable":true,"description":"Culinary education background","example":"Culinary Arts Degree from Le Cordon Bleu"},"previousRestaurants":{"type":"array","items":{"type":"string"},"description":"Previous restaurant experience","example":["Michelin Star Restaurant","Local Bistro"]}}}}}}}},"responses":{"200":{"description":"Chef application submitted successfully","content":{"application/json":{"schema":{"type":"object","properties":{"success":{"type":"boolean","example":true},"data":{"type":"object","properties":{"applicationId":{"type":"string","description":"Application reference ID","example":"APP-12345"},"status":{"type":"string","description":"Application status","example":"submitted"},"submittedAt":{"type":"string","format":"date-time","description":"Application submission timestamp","example":"2024-01-15T10:00:00.000Z"},"nextSteps":{"type":"array","items":{"type":"string"},"description":"Next steps in the application process","example":["Review application","Schedule interview","Background check"]},"estimatedReviewTime":{"type":"string","description":"Estimated time for application review","example":"3-5 business days"}}},"message":{"type":"string","example":"Application submitted successfully"}}}}}},"400":{"description":"Validation error - missing required fields","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}},"500":{"description":"Internal server error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}}}}},"/admin/dishes":{"get":{"summary":"Get All Dishes","description":"Retrieve all dishes/meals from all chefs (admin only)","tags":["Admin","Dishes","Meals"],"responses":{"200":{"description":"All dishes retrieved successfully","content":{"application/json":{"schema":{"type":"object","properties":{"success":{"type":"boolean","example":true},"data":{"type":"object","properties":{"meals":{"type":"array","description":"Array of all dishes/meals","items":{"type":"object","properties":{"_id":{"type":"string","description":"Dish ID","example":"j1234567890abcdef"},"chefId":{"type":"string","description":"Chef ID who created the dish","example":"j1234567890abcdef"},"name":{"type":"string","description":"Dish name","example":"Spaghetti Carbonara"},"description":{"type":"string","description":"Dish description","example":"Classic Italian pasta with eggs, cheese, and pancetta"},"price":{"type":"number","description":"Dish price","example":18.99},"cuisine":{"type":"string","description":"Cuisine type","example":"italian"},"ingredients":{"type":"array","items":{"type":"string"},"description":"List of ingredients","example":["pasta","eggs","parmesan","pancetta"]},"dietaryInfo":{"type":"object","description":"Dietary information","properties":{"vegetarian":{"type":"boolean","example":false},"vegan":{"type":"boolean","example":false},"glutenFree":{"type":"boolean","example":false},"allergens":{"type":"array","items":{"type":"string"},"example":["eggs","dairy"]}}},"prepTime":{"type":"number","description":"Preparation time in minutes","example":25},"servings":{"type":"number","description":"Number of servings","example":2},"image":{"type":"string","nullable":true,"description":"Dish image URL","example":"https://example.com/dish-image.jpg"},"status":{"type":"string","enum":["draft","active","inactive","archived"],"description":"Dish status","example":"active"},"rating":{"type":"number","nullable":true,"description":"Average rating","example":4.7},"reviewCount":{"type":"number","description":"Number of reviews","example":15},"createdAt":{"type":"string","format":"date-time","description":"Creation timestamp","example":"2024-01-15T10:00:00.000Z"},"updatedAt":{"type":"string","format":"date-time","nullable":true,"description":"Last update timestamp","example":"2024-01-15T15:30:00.000Z"}}}}}},"message":{"type":"string","example":"Success"}}}}}},"401":{"description":"Unauthorized - invalid or missing authentication","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}},"403":{"description":"Forbidden - only admins can access this endpoint","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}},"500":{"description":"Internal server error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}}},"security":[{"bearerAuth":[]}]},"post":{"summary":"Create New Dish (Admin)","description":"Create a new dish/meal item (admin only)","tags":["Admin","Dishes","Meals"],"requestBody":{"required":true,"content":{"application/json":{"schema":{"type":"object","required":["name","chefId","price"],"properties":{"name":{"type":"string","description":"Dish name","example":"Spaghetti Carbonara"},"description":{"type":"string","description":"Dish description","example":"Classic Italian pasta with eggs, cheese, and pancetta"},"chefId":{"type":"string","description":"Chef ID who created the dish","example":"j1234567890abcdef"},"price":{"type":"number","description":"Dish price","example":18.99},"images":{"type":"array","items":{"type":"string"},"description":"Array of image URLs","example":["https://example.com/dish1.jpg","https://example.com/dish2.jpg"]},"cuisine":{"type":"array","items":{"type":"string"},"description":"Array of cuisine types","example":["italian","pasta"]},"dietary":{"type":"array","items":{"type":"string"},"description":"Array of dietary information","example":["vegetarian","gluten-free"]}}}}}},"responses":{"200":{"description":"Dish created successfully","content":{"application/json":{"schema":{"type":"object","properties":{"success":{"type":"boolean","example":true},"data":{"type":"object","properties":{"success":{"type":"boolean","example":true},"mealId":{"type":"string","description":"ID of the created dish","example":"j1234567890abcdef"}}},"message":{"type":"string","example":"Success"}}}}}},"400":{"description":"Validation error - missing required fields","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}},"401":{"description":"Unauthorized - invalid or missing authentication","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}},"403":{"description":"Forbidden - only admins can create dishes","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}},"500":{"description":"Internal server error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}}},"security":[{"bearerAuth":[]}]}},"/customer/search":{"post":{"summary":"Search with Emotions Engine","description":"Search for chefs, dishes, or cuisines using the emotions engine for personalized results","tags":["Customer"],"requestBody":{"required":true,"content":{"application/json":{"schema":{"type":"object","properties":{"query":{"type":"string","description":"Search query","example":"Italian pasta"},"location":{"type":"object","properties":{"latitude":{"type":"number","example":40.7128},"longitude":{"type":"number","example":-74.006}}},"preferences":{"type":"object","description":"User preferences for personalized search"},"filters":{"type":"object","description":"Search filters"}}}}}},"responses":{"200":{"description":"Search completed successfully","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Success"}}}},"500":{"description":"Internal server error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}}},"security":[]},"get":{"summary":"Search with Query Parameters","description":"Search for chefs, dishes, or cuisines using query parameters","tags":["Customer"],"parameters":[{"in":"query","name":"q","schema":{"type":"string"},"description":"Search query","example":"Italian pasta"},{"in":"query","name":"location","schema":{"type":"string"},"description":"Location for search","example":"New York"},{"in":"query","name":"cuisine","schema":{"type":"string"},"description":"Cuisine filter","example":"Italian"},{"in":"query","name":"price_range","schema":{"type":"string"},"description":"Price range filter","example":"10-20"}],"responses":{"200":{"description":"Search completed successfully","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Success"}}}},"500":{"description":"Internal server error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}}},"security":[]}},"/orders/cancel":{"post":{"summary":"Cancel Order","description":"Cancel an order with optional automatic refund processing","tags":["Orders"],"requestBody":{"required":true,"content":{"application/json":{"schema":{"type":"object","required":["orderId","reason"],"properties":{"orderId":{"type":"string","description":"ID of the order to cancel","example":"j1234567890abcdef"},"reason":{"type":"string","description":"Reason for cancellation","enum":["customer_request","out_of_stock","chef_unavailable","delivery_issue","fraudulent","duplicate","other"],"example":"customer_request"},"description":{"type":"string","nullable":true,"description":"Additional description for the cancellation","example":"Customer requested cancellation due to change of plans"},"autoRefund":{"type":"boolean","default":true,"description":"Whether to automatically process refund if payment was made","example":true},"refundAmount":{"type":"number","nullable":true,"description":"Partial refund amount in smallest currency unit (optional for full refund)","example":1599},"metadata":{"type":"object","nullable":true,"description":"Additional metadata for the cancellation","example":{"source":"mobile_app","priority":"urgent"}}}}}}},"responses":{"200":{"description":"Order cancelled successfully","content":{"application/json":{"schema":{"type":"object","properties":{"success":{"type":"boolean","example":true},"data":{"type":"object","description":"Empty object on success","example":{}},"message":{"type":"string","example":"Success"}}}}}},"400":{"description":"Validation error - missing required fields or order cannot be cancelled","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}},"401":{"description":"Unauthorized - invalid or missing authentication","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}},"403":{"description":"Forbidden - insufficient permissions or cannot cancel this order","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}},"404":{"description":"Order not found","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}},"500":{"description":"Internal server error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}}},"security":[{"bearerAuth":[]}]}},"/orders/confirm":{"post":{"summary":"Confirm Order","description":"Confirm a pending order and set preparation details (admin, staff, or chef)","tags":["Orders"],"requestBody":{"required":true,"content":{"application/json":{"schema":{"type":"object","required":["orderId"],"properties":{"orderId":{"type":"string","description":"ID of the order to confirm","example":"j1234567890abcdef"},"estimatedPrepTime":{"type":"number","nullable":true,"description":"Estimated preparation time in minutes","example":30},"chefNotes":{"type":"string","nullable":true,"description":"Notes from the chef about the order","example":"Order will be ready in 25 minutes"},"metadata":{"type":"object","nullable":true,"description":"Additional metadata for the confirmation","example":{"kitchen":"main","priority":"high"}}}}}}},"responses":{"200":{"description":"Order confirmed successfully","content":{"application/json":{"schema":{"type":"object","properties":{"success":{"type":"boolean","example":true},"data":{"type":"object","properties":{"orderId":{"type":"string","description":"Confirmed order ID","example":"j1234567890abcdef"},"status":{"type":"string","description":"Updated order status","enum":["confirmed","preparing","ready","delivered","cancelled"],"example":"confirmed"},"estimatedReadyTime":{"type":"number","description":"Estimated preparation time in minutes","example":30}}},"message":{"type":"string","example":"Success"}}}}}},"400":{"description":"Validation error - missing orderId or order cannot be confirmed","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}},"401":{"description":"Unauthorized - invalid or missing authentication","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}},"403":{"description":"Forbidden - insufficient permissions or cannot confirm this order","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}},"404":{"description":"Order not found","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}},"500":{"description":"Internal server error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}}},"security":[{"bearerAuth":[]}]}},"/orders/prepare":{"post":{"summary":"Start Order Preparation","description":"Mark an order as being prepared by chef/staff (admin, staff, chef only)","tags":["Orders","Order Management","Preparation"],"requestBody":{"required":true,"content":{"application/json":{"schema":{"type":"object","required":["orderId"],"properties":{"orderId":{"type":"string","description":"Order ID to prepare","example":"ORD-12345"},"prepNotes":{"type":"string","description":"Preparation notes from chef","example":"Starting preparation, estimated 25 minutes"},"updatedPrepTime":{"type":"number","description":"Updated preparation time in minutes","example":25},"metadata":{"type":"object","description":"Additional preparation metadata","example":{"kitchen":"main","priority":"normal"}}}}}}},"responses":{"200":{"description":"Order preparation started successfully","content":{"application/json":{"schema":{"type":"object","properties":{"success":{"type":"boolean","example":true},"data":{"type":"object","properties":{"orderId":{"type":"string","example":"ORD-12345"},"status":{"type":"string","description":"Updated order status","example":"preparing"},"prepStartedAt":{"type":"string","format":"date-time","description":"When preparation started","example":"2024-01-15T10:00:00.000Z"},"estimatedPrepTime":{"type":"number","description":"Estimated preparation time in minutes","example":25},"prepNotes":{"type":"string","example":"Starting preparation, estimated 25 minutes"},"preparedBy":{"type":"string","description":"ID of the person preparing the order","example":"j1234567890abcdef"},"preparedByRole":{"type":"string","description":"Role of the person preparing","example":"chef"},"metadata":{"type":"object","example":{"kitchen":"main","priority":"normal"}}}},"message":{"type":"string","example":"Order preparation started successfully"}}}}}},"400":{"description":"Validation error - missing required fields","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}},"401":{"description":"Unauthorized - invalid or missing authentication","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}},"403":{"description":"Forbidden - insufficient permissions to prepare orders","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}},"404":{"description":"Order not found","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}},"409":{"description":"Conflict - order cannot be prepared in current status","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}},"500":{"description":"Internal server error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}}},"security":[{"bearerAuth":[]}]}},"/orders/complete":{"post":{"summary":"Complete Order","description":"Mark an order as completed (admin/staff/chef only)","tags":["Orders","Order Management"],"requestBody":{"required":true,"content":{"application/json":{"schema":{"type":"object","required":["orderId"],"properties":{"orderId":{"type":"string","description":"Order ID to mark as completed","example":"j1234567890abcdef"},"completionNotes":{"type":"string","nullable":true,"description":"Notes about order completion","example":"Order delivered successfully, customer satisfied"},"metadata":{"type":"object","nullable":true,"description":"Additional completion metadata","example":{"deliveryTime":"18:30","customerRating":5}}}}}}},"responses":{"200":{"description":"Order completed successfully","content":{"application/json":{"schema":{"type":"object","properties":{"success":{"type":"boolean","example":true},"data":{"type":"object","properties":{"orderId":{"type":"string","example":"j1234567890abcdef"},"status":{"type":"string","example":"completed"},"completedAt":{"type":"string","format":"date-time","description":"Order completion timestamp","example":"2024-01-15T18:30:00.000Z"},"completedBy":{"type":"string","description":"User who completed the order","example":"j1234567890abcdef"},"completionNotes":{"type":"string","nullable":true,"example":"Order delivered successfully, customer satisfied"}}},"message":{"type":"string","example":"Success"}}}}}},"400":{"description":"Validation error - missing required fields or invalid order status","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}},"401":{"description":"Unauthorized - invalid or missing authentication","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}},"403":{"description":"Forbidden - insufficient permissions","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}},"404":{"description":"Order not found","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}},"500":{"description":"Internal server error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}}},"security":[{"bearerAuth":[]}]}},"/orders/deliver":{"post":{"summary":"Mark Order as Delivered","description":"Mark an order as delivered (admin, staff, chef only)","tags":["Orders","Order Management","Delivery"],"requestBody":{"required":true,"content":{"application/json":{"schema":{"type":"object","required":["orderId"],"properties":{"orderId":{"type":"string","description":"Order ID to mark as delivered","example":"ORD-12345"},"deliveryNotes":{"type":"string","description":"Delivery notes or comments","example":"Delivered to front door, customer confirmed receipt"},"metadata":{"type":"object","description":"Additional delivery metadata","example":{"deliveryMethod":"contactless","signature":"received"}}}}}}},"responses":{"200":{"description":"Order marked as delivered successfully","content":{"application/json":{"schema":{"type":"object","properties":{"success":{"type":"boolean","example":true},"data":{"type":"object","properties":{"orderId":{"type":"string","example":"ORD-12345"},"status":{"type":"string","description":"Updated order status","example":"delivered"},"deliveredAt":{"type":"string","format":"date-time","description":"When the order was delivered","example":"2024-01-15T10:00:00.000Z"},"deliveryNotes":{"type":"string","example":"Delivered to front door, customer confirmed receipt"},"deliveredBy":{"type":"string","description":"ID of the person who delivered the order","example":"j1234567890abcdef"},"deliveredByRole":{"type":"string","description":"Role of the person who delivered","example":"chef"},"deliveryDuration":{"type":"number","description":"Total delivery time in minutes","example":15},"metadata":{"type":"object","example":{"deliveryMethod":"contactless"}}}},"message":{"type":"string","example":"Order marked as delivered successfully"}}}}}},"400":{"description":"Validation error - missing required fields","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}},"401":{"description":"Unauthorized - invalid or missing authentication","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}},"403":{"description":"Forbidden - insufficient permissions to mark orders as delivered","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}},"404":{"description":"Order not found","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}},"409":{"description":"Conflict - order cannot be delivered in current status","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}},"500":{"description":"Internal server error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}}},"security":[{"bearerAuth":[]}]}},"/auth/login":{"post":{"summary":"User Login","description":"Authenticate user with email and password, returns JWT token","tags":["Authentication"],"requestBody":{"required":true,"content":{"application/json":{"schema":{"type":"object","required":["email","password"],"properties":{"email":{"type":"string","format":"email","description":"User's email address","example":"user@example.com"},"password":{"type":"string","description":"User's password","example":"securePassword123"}}}}}},"responses":{"200":{"description":"Login successful","content":{"application/json":{"schema":{"type":"object","properties":{"success":{"type":"boolean","example":true},"data":{"type":"object","properties":{"success":{"type":"boolean","example":true},"token":{"type":"string","description":"JWT authentication token","example":"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..."},"user":{"type":"object","properties":{"user_id":{"type":"string","description":"User ID","example":"j1234567890abcdef"},"email":{"type":"string","format":"email","example":"user@example.com"},"name":{"type":"string","example":"John Doe"},"roles":{"type":"array","items":{"type":"string"},"example":["customer"]}}}}},"message":{"type":"string","example":"Success"}}}}}},"400":{"description":"Validation error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}},"401":{"description":"Invalid credentials","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}},"500":{"description":"Internal server error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}}},"security":[]}},"/auth/me":{"get":{"summary":"Get Current User","description":"Get the current authenticated user's profile information","tags":["Authentication"],"responses":{"200":{"description":"User profile retrieved successfully","content":{"application/json":{"schema":{"type":"object","properties":{"success":{"type":"boolean","example":true},"data":{"type":"object","properties":{"user":{"type":"object","description":"User profile (excluding sensitive fields)","properties":{"_id":{"type":"string","description":"User ID","example":"j1234567890abcdef"},"email":{"type":"string","format":"email","example":"user@example.com"},"name":{"type":"string","example":"John Doe"},"roles":{"type":"array","items":{"type":"string"},"example":["customer"]},"_creationTime":{"type":"number","description":"Account creation timestamp","example":1640995200000}}}}},"message":{"type":"string","example":"Success"}}}}}},"401":{"description":"Unauthorized - invalid or missing authentication","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}},"404":{"description":"User not found","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}},"500":{"description":"Internal server error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}}},"security":[{"bearerAuth":[]},{"cookieAuth":[]}]}},"/auth/email-otp":{"post":{"summary":"Email OTP Authentication","description":"Send or verify OTP code via email for authentication","tags":["Authentication"],"requestBody":{"required":true,"content":{"application/json":{"schema":{"type":"object","required":["email","action"],"properties":{"email":{"type":"string","format":"email","description":"User's email address","example":"user@example.com"},"action":{"type":"string","enum":["send","verify"],"description":"Action to perform","example":"send"},"otp":{"type":"string","description":"OTP code (required for verify action)","example":"123456"}}}}}},"responses":{"200":{"description":"OTP operation successful","content":{"application/json":{"schema":{"type":"object","properties":{"success":{"type":"boolean","example":true},"data":{"type":"object","properties":{"success":{"type":"boolean","example":true},"message":{"type":"string","example":"Verification code sent to your email"},"testOtp":{"type":"string","description":"Test OTP (development only)","example":"123456"},"token":{"type":"string","description":"JWT token (for verify action)","example":"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..."},"user":{"type":"object","description":"User information (for verify action)","properties":{"user_id":{"type":"string","example":"j1234567890abcdef"},"email":{"type":"string","format":"email","example":"user@example.com"},"name":{"type":"string","example":"user"},"roles":{"type":"array","items":{"type":"string"},"example":["user"]},"isNewUser":{"type":"boolean","example":true}}}}},"message":{"type":"string","example":"Success"}}}}}},"400":{"description":"Validation error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}},"500":{"description":"Internal server error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}}},"security":[]}},"/auth/phone-signin":{"post":{"summary":"Phone Number Authentication","description":"Send or verify OTP code via SMS for phone number authentication","tags":["Authentication"],"requestBody":{"required":true,"content":{"application/json":{"schema":{"type":"object","required":["phone","action"],"properties":{"phone":{"type":"string","description":"User's phone number","example":"+1234567890"},"action":{"type":"string","enum":["send","verify"],"description":"Action to perform","example":"send"},"otp":{"type":"string","description":"OTP code (required for verify action)","example":"123456"}}}}}},"responses":{"200":{"description":"Phone authentication successful","content":{"application/json":{"schema":{"type":"object","properties":{"success":{"type":"boolean","example":true},"data":{"type":"object","properties":{"success":{"type":"boolean","example":true},"message":{"type":"string","example":"OTP sent successfully"},"testOtp":{"type":"string","description":"Test OTP (development only)","example":"123456"},"token":{"type":"string","description":"JWT token (for verify action)","example":"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..."},"user":{"type":"object","description":"User information (for verify action)","properties":{"user_id":{"type":"string","example":"j1234567890abcdef"},"phone":{"type":"string","example":"+1234567890"},"name":{"type":"string","example":"User_7890"},"roles":{"type":"array","items":{"type":"string"},"example":["user"]},"isNewUser":{"type":"boolean","example":true}}}}},"message":{"type":"string","example":"Success"}}}}}},"400":{"description":"Validation error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}},"500":{"description":"Internal server error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}}},"security":[]}},"/auth/apple-signin":{"post":{"summary":"Apple OAuth Sign-in","description":"Authenticate user using Apple Sign-In (identity token or authorization code)","tags":["Authentication"],"requestBody":{"required":true,"content":{"application/json":{"schema":{"type":"object","properties":{"identityToken":{"type":"string","description":"Apple identity token (preferred method)","example":"eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9..."},"authorizationCode":{"type":"string","description":"Apple authorization code (alternative method)","example":"c1234567890abcdef..."},"user":{"type":"object","description":"User data from Apple (optional, for authorization code flow)","properties":{"email":{"type":"string","format":"email","example":"user@privaterelay.appleid.com"},"sub":{"type":"string","example":"001234.abcdef1234567890abcdef1234567890.1234"},"name":{"type":"string","example":"John Doe"}}}}}}}},"responses":{"200":{"description":"Apple authentication successful","content":{"application/json":{"schema":{"type":"object","properties":{"success":{"type":"boolean","example":true},"data":{"type":"object","properties":{"success":{"type":"boolean","example":true},"message":{"type":"string","example":"Authentication successful"},"token":{"type":"string","description":"JWT authentication token","example":"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..."},"user":{"type":"object","properties":{"user_id":{"type":"string","example":"j1234567890abcdef"},"email":{"type":"string","format":"email","example":"user@privaterelay.appleid.com"},"name":{"type":"string","example":"Apple User 1234"},"roles":{"type":"array","items":{"type":"string"},"example":["user"]},"picture":{"type":"string","nullable":true,"description":"Apple doesn't provide profile pictures"},"isNewUser":{"type":"boolean","example":false},"provider":{"type":"string","example":"apple"}}}}},"message":{"type":"string","example":"Success"}}}}}},"400":{"description":"Validation error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}},"401":{"description":"Invalid Apple token","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}},"500":{"description":"Internal server error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}}},"security":[]}},"/auth/register":{"post":{"summary":"User Registration","description":"Register a new user with email and password","tags":["Authentication"],"requestBody":{"required":true,"content":{"application/json":{"schema":{"type":"object","required":["name","email","password"],"properties":{"name":{"type":"string","description":"User's full name","example":"John Doe"},"email":{"type":"string","format":"email","description":"User's email address","example":"john@example.com"},"password":{"type":"string","minLength":8,"description":"User's password (minimum 8 characters)","example":"securePassword123"},"role":{"type":"string","description":"User role (defaults to 'customer')","enum":["customer","chef","admin"],"example":"customer"}}}}}},"responses":{"200":{"description":"Registration successful","content":{"application/json":{"schema":{"type":"object","properties":{"success":{"type":"boolean","example":true},"data":{"type":"object","properties":{"success":{"type":"boolean","example":true},"userId":{"type":"string","description":"Created user ID","example":"j1234567890abcdef"},"email":{"type":"string","format":"email","example":"john@example.com"},"name":{"type":"string","example":"John Doe"},"roles":{"type":"array","items":{"type":"string"},"example":["customer"]}}},"message":{"type":"string","example":"Success"}}}}}},"400":{"description":"Validation error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}},"409":{"description":"User already exists","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}},"500":{"description":"Internal server error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}}},"security":[]}},"/auth/logout":{"post":{"summary":"User Logout","description":"Logout user by invalidating session token and clearing cookies","tags":["Authentication"],"responses":{"200":{"description":"Logout successful","content":{"application/json":{"schema":{"type":"object","properties":{"success":{"type":"boolean","example":true},"data":{"type":"object","properties":{"message":{"type":"string","example":"Logged out successfully."}}},"message":{"type":"string","example":"Success"}}}}},"headers":{"Set-Cookie":{"description":"Cleared authentication cookie","schema":{"type":"string","example":"convex-auth-token=; Path=/; Max-Age=0"}}}},"401":{"description":"Unauthorized - no session token or invalid token","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}},"500":{"description":"Internal server error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}}},"security":[{"cookieAuth":[]}]}},"/auth/google-signin":{"post":{"summary":"Google OAuth Sign-in","description":"Authenticate user using Google OAuth (ID token or access token)","tags":["Authentication"],"requestBody":{"required":true,"content":{"application/json":{"schema":{"type":"object","properties":{"idToken":{"type":"string","description":"Google ID token (preferred method)","example":"eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9..."},"accessToken":{"type":"string","description":"Google access token (alternative method)","example":"ya29.a0AfH6SMC..."}}}}}},"responses":{"200":{"description":"Google authentication successful","content":{"application/json":{"schema":{"type":"object","properties":{"success":{"type":"boolean","example":true},"data":{"type":"object","properties":{"success":{"type":"boolean","example":true},"message":{"type":"string","example":"Authentication successful"},"token":{"type":"string","description":"JWT authentication token","example":"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..."},"user":{"type":"object","properties":{"user_id":{"type":"string","example":"j1234567890abcdef"},"email":{"type":"string","format":"email","example":"user@gmail.com"},"name":{"type":"string","example":"John Doe"},"roles":{"type":"array","items":{"type":"string"},"example":["user"]},"picture":{"type":"string","description":"Google profile picture URL","example":"https://lh3.googleusercontent.com/..."},"isNewUser":{"type":"boolean","example":false},"provider":{"type":"string","example":"google"}}}}},"message":{"type":"string","example":"Success"}}}}}},"400":{"description":"Validation error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}},"401":{"description":"Invalid Google token","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}},"500":{"description":"Internal server error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}}},"security":[]}},"/staff/mattermost/complete":{"post":{"summary":"Complete Mattermost Setup","description":"Complete Mattermost user setup and configuration for staff members","tags":["Staff","Mattermost","Integration"],"requestBody":{"required":true,"content":{"application/json":{"schema":{"type":"object","required":["email","username","firstName","lastName"],"properties":{"email":{"type":"string","format":"email","description":"Staff member email address","example":"john.doe@cribnosh.com"},"username":{"type":"string","description":"Mattermost username","example":"johndoe"},"firstName":{"type":"string","description":"Staff member first name","example":"John"},"lastName":{"type":"string","description":"Staff member last name","example":"Doe"},"preferences":{"type":"object","description":"Mattermost user preferences","example":{"theme":"dark","notifications":"all"}}}}}}},"responses":{"200":{"description":"Mattermost setup completed successfully","content":{"application/json":{"schema":{"type":"object","properties":{"success":{"type":"boolean","example":true},"data":{"type":"object","properties":{"mattermostUserId":{"type":"string","description":"Mattermost user ID","example":"mm1234567890abcdef"},"username":{"type":"string","example":"johndoe"},"email":{"type":"string","example":"john.doe@cribnosh.com"},"teamId":{"type":"string","description":"Mattermost team ID","example":"team1234567890abcdef"},"channelId":{"type":"string","description":"Mattermost channel ID","example":"channel1234567890abcdef"},"setupComplete":{"type":"boolean","description":"Whether setup is complete","example":true},"loginUrl":{"type":"string","description":"Mattermost login URL","example":"https://mattermost.cribnosh.com"},"credentials":{"type":"object","properties":{"username":{"type":"string","example":"johndoe"},"password":{"type":"string","description":"Generated password (temporary)","example":"temp123Aa!"}}}}},"message":{"type":"string","example":"Mattermost setup completed successfully"}}}}}},"400":{"description":"Validation error - missing required fields","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}},"401":{"description":"Unauthorized - invalid or missing authentication","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}},"500":{"description":"Internal server error or Mattermost integration error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}}},"security":[{"cookieAuth":[]}]}},"/staff/auth/logout":{"post":{"summary":"Staff Logout","description":"Logout staff user and clear session token","tags":["Staff","Authentication"],"responses":{"200":{"description":"Staff logged out successfully","content":{"application/json":{"schema":{"type":"object","properties":{"success":{"type":"boolean","example":true},"message":{"type":"string","example":"Logged out successfully"}}}}}},"500":{"description":"Internal server error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}}},"security":[{"cookieAuth":[]}]}},"/staff/auth/login":{"post":{"summary":"Staff Login","description":"Authenticate staff members and create session tokens","tags":["Staff","Authentication"],"requestBody":{"required":true,"content":{"application/json":{"schema":{"type":"object","required":["email","password"],"properties":{"email":{"type":"string","format":"email","description":"Staff email address","example":"staff@cribnosh.com"},"password":{"type":"string","description":"Staff password","example":"securePassword123"}}}}}},"responses":{"200":{"description":"Staff login successful","content":{"application/json":{"schema":{"type":"object","properties":{"success":{"type":"boolean","example":true},"data":{"type":"object","properties":{"success":{"type":"boolean","example":true},"sessionToken":{"type":"string","description":"Convex session token","example":"session_token_here"}}},"message":{"type":"string","example":"Success"}}}}},"headers":{"Set-Cookie":{"description":"Convex session token cookie","schema":{"type":"string","example":"convex-auth-token=session_token_here; HttpOnly; Secure; SameSite=Strict"}}}},"401":{"description":"Unauthorized - invalid credentials","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}},"500":{"description":"Internal server error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}}},"security":[]}},"/staff/mattermost/setup":{"post":{"summary":"Setup Mattermost Profile","description":"Initial setup of Mattermost user profile for staff members","tags":["Staff","Mattermost","Integration"],"requestBody":{"required":true,"content":{"application/json":{"schema":{"type":"object","required":["email","username","firstName","lastName"],"properties":{"email":{"type":"string","format":"email","description":"Staff member email address","example":"john.doe@cribnosh.com"},"username":{"type":"string","description":"Desired Mattermost username","example":"johndoe"},"firstName":{"type":"string","description":"Staff member first name","example":"John"},"lastName":{"type":"string","description":"Staff member last name","example":"Doe"},"department":{"type":"string","description":"Staff member department","example":"Customer Support"},"role":{"type":"string","description":"Staff member role","example":"Support Specialist"}}}}}},"responses":{"200":{"description":"Mattermost profile setup completed successfully","content":{"application/json":{"schema":{"type":"object","properties":{"success":{"type":"boolean","example":true},"data":{"type":"object","properties":{"mattermostUserId":{"type":"string","description":"Mattermost user ID","example":"mm1234567890abcdef"},"username":{"type":"string","example":"johndoe"},"email":{"type":"string","example":"john.doe@cribnosh.com"},"profileComplete":{"type":"boolean","description":"Whether profile setup is complete","example":true},"teamMembership":{"type":"object","properties":{"teamId":{"type":"string","example":"team1234567890abcdef"},"teamName":{"type":"string","example":"CribNosh Staff"},"role":{"type":"string","example":"member"}}},"channelMembership":{"type":"object","properties":{"channelId":{"type":"string","example":"channel1234567890abcdef"},"channelName":{"type":"string","example":"general"},"role":{"type":"string","example":"member"}}},"nextSteps":{"type":"array","items":{"type":"string"},"description":"Next steps in setup process","example":["Complete profile","Set preferences","Join channels"]}}},"message":{"type":"string","example":"Mattermost profile setup completed successfully"}}}}}},"400":{"description":"Validation error - missing required fields","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}},"409":{"description":"Conflict - username or email already exists","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}},"500":{"description":"Internal server error or Mattermost integration error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}}}}},"/chef/documents/upload":{"post":{"summary":"Upload Chef Document","description":"Upload a document for chef verification or compliance","tags":["Chef","Documents"],"requestBody":{"required":true,"content":{"application/json":{"schema":{"type":"object","required":["name","document_type","storageId"],"properties":{"name":{"type":"string","description":"Name of the document","example":"Food Safety Certificate"},"document_type":{"type":"string","description":"Type of document being uploaded","example":"food_safety_certificate"},"storageId":{"type":"string","description":"Storage ID from file upload","example":"storage123456789"}}}}}},"responses":{"200":{"description":"Document uploaded successfully","content":{"application/json":{"schema":{"type":"object","properties":{"success":{"type":"boolean","example":true},"data":{"type":"object","properties":{"success":{"type":"boolean","example":true},"document_id":{"type":"string","description":"ID of the uploaded document","example":"j1234567890abcdef"}}},"message":{"type":"string","example":"Success"}}}}}},"400":{"description":"Validation error - missing required fields","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}},"401":{"description":"Unauthorized - invalid or missing authentication","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}},"403":{"description":"Forbidden - only chefs can upload documents","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}},"500":{"description":"Internal server error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}}},"security":[{"bearerAuth":[]}]}},"/chef/documents/submit":{"post":{"summary":"Submit Documents for Review","description":"Submit uploaded documents for admin review and approval","tags":["Chef","Documents"],"requestBody":{"required":true,"content":{"application/json":{"schema":{"type":"object","required":["document_ids"],"properties":{"document_ids":{"type":"array","items":{"type":"string"},"description":"Array of document IDs to submit for review","example":["j1234567890abcdef","j0987654321fedcba"]}}}}}},"responses":{"200":{"description":"Documents submitted for review successfully","content":{"application/json":{"schema":{"type":"object","properties":{"success":{"type":"boolean","example":true},"data":{"type":"object","properties":{"success":{"type":"boolean","example":true},"message":{"type":"string","example":"Documents submitted for review"}}},"message":{"type":"string","example":"Success"}}}}}},"400":{"description":"Validation error - no document IDs provided","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}},"401":{"description":"Unauthorized - invalid or missing authentication","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}},"403":{"description":"Forbidden - only chefs can submit documents","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}},"500":{"description":"Internal server error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}}},"security":[{"bearerAuth":[]}]}},"/chef/cuisines/available":{"get":{"summary":"Get Available Cuisines","description":"Retrieve all approved cuisine types that are available for chefs to use","tags":["Chef","Cuisines"],"responses":{"200":{"description":"Available cuisines retrieved successfully","content":{"application/json":{"schema":{"type":"object","properties":{"success":{"type":"boolean","example":true},"data":{"type":"object","properties":{"cuisines":{"type":"array","description":"Array of approved cuisine types","items":{"type":"string"},"example":["italian","chinese","indian","mexican","thai","french","japanese","mediterranean"]}}},"message":{"type":"string","example":"Success"}}}}}},"500":{"description":"Internal server error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}}},"security":[]}},"/chef/location/location":{"get":{"summary":"Get All Chef Locations","description":"Retrieve location information for all chefs","tags":["Chef","Location"],"responses":{"200":{"description":"Chef locations retrieved successfully","content":{"application/json":{"schema":{"type":"object","properties":{"success":{"type":"boolean","example":true},"data":{"type":"array","description":"Array of chef locations","items":{"type":"object","properties":{"_id":{"type":"string","description":"Chef ID","example":"j1234567890abcdef"},"userId":{"type":"string","description":"User ID","example":"j1234567890abcdef"},"location":{"type":"object","description":"Chef location information","properties":{"coordinates":{"type":"array","items":{"type":"number"},"description":"Array of [longitude, latitude] coordinates","example":[-0.1278,51.5074]},"city":{"type":"string","description":"City name","example":"London"},"address":{"type":"string","description":"Full address","example":"123 Baker Street, London"},"postcode":{"type":"string","description":"Postal code","example":"NW1 6XE"},"country":{"type":"string","description":"Country","example":"UK"}}},"specialties":{"type":"array","items":{"type":"string"},"description":"Chef specialties","example":["italian","pasta","seafood"]},"status":{"type":"string","enum":["active","inactive","pending"],"description":"Chef status","example":"active"},"isAvailable":{"type":"boolean","description":"Whether chef is currently available","example":true}}}},"message":{"type":"string","example":"Success"}}}}}},"500":{"description":"Internal server error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}}},"security":[]}},"/chef/location/nearby":{"get":{"summary":"Find Nearby Chefs","description":"Find chefs within a specified distance from given coordinates","tags":["Chef","Location","Search"],"parameters":[{"in":"query","name":"latitude","required":true,"schema":{"type":"number","format":"float"},"description":"Latitude coordinate","example":51.5074},{"in":"query","name":"longitude","required":true,"schema":{"type":"number","format":"float"},"description":"Longitude coordinate","example":-0.1278},{"in":"query","name":"maxDistanceKm","required":false,"schema":{"type":"number","format":"float","minimum":0.1,"maximum":100},"description":"Maximum distance in kilometers to search","example":10}],"responses":{"200":{"description":"Nearby chefs found successfully","content":{"application/json":{"schema":{"type":"object","properties":{"success":{"type":"boolean","example":true},"data":{"type":"array","description":"Array of nearby chefs","items":{"type":"object","properties":{"_id":{"type":"string","description":"Chef ID","example":"j1234567890abcdef"},"userId":{"type":"string","description":"User ID","example":"j1234567890abcdef"},"location":{"type":"object","description":"Chef location information","properties":{"coordinates":{"type":"array","items":{"type":"number"},"description":"Array of [longitude, latitude] coordinates","example":[-0.1278,51.5074]},"city":{"type":"string","description":"City name","example":"London"},"address":{"type":"string","description":"Full address","example":"123 Baker Street, London"}}},"specialties":{"type":"array","items":{"type":"string"},"description":"Chef specialties","example":["italian","pasta","seafood"]},"status":{"type":"string","enum":["active","inactive","pending"],"description":"Chef status","example":"active"},"distance":{"type":"number","description":"Distance from search point in kilometers","example":2.5},"rating":{"type":"number","nullable":true,"description":"Average rating","example":4.7},"reviewCount":{"type":"number","description":"Number of reviews","example":25}}}},"message":{"type":"string","example":"Success"}}}}}},"400":{"description":"Validation error - missing or invalid coordinates","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}},"500":{"description":"Internal server error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}}},"security":[]}},"/customer/cart/items":{"post":{"summary":"Add Item to Cart","description":"Add a dish item to the customer's shopping cart","tags":["Customer"],"requestBody":{"required":true,"content":{"application/json":{"schema":{"type":"object","required":["dish_id","quantity"],"properties":{"dish_id":{"type":"string","description":"ID of the dish to add","example":"j1234567890abcdef"},"quantity":{"type":"number","minimum":1,"description":"Quantity of the dish","example":2}}}}}},"responses":{"200":{"description":"Item added to cart successfully","content":{"application/json":{"schema":{"type":"object","properties":{"success":{"type":"boolean","example":true},"data":{"type":"object","properties":{"item":{"type":"object","description":"Added cart item with details","properties":{"_id":{"type":"string","description":"Cart item ID","example":"j1234567890abcdef"},"dish_id":{"type":"string","description":"Dish ID","example":"j1234567890abcdef"},"quantity":{"type":"number","example":2},"price":{"type":"number","description":"Price per item","example":15.99},"name":{"type":"string","description":"Dish name","example":"Chicken Tikka Masala"},"chef_id":{"type":"string","description":"Chef ID","example":"j1234567890abcdef"},"added_at":{"type":"number","description":"Timestamp when item was added","example":1640995200000}}}}},"message":{"type":"string","example":"Success"}}}}}},"400":{"description":"Validation error - missing required fields","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}},"401":{"description":"Unauthorized - invalid or missing authentication","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}},"403":{"description":"Forbidden - only customers can add cart items","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}},"500":{"description":"Internal server error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}}},"security":[{"bearerAuth":[]}]}},"/customer/chefs/popular":{"get":{"summary":"Get Popular Chefs","description":"Get a list of popular chefs sorted by rating and review count","tags":["Customer"],"responses":{"200":{"description":"Popular chefs retrieved successfully","content":{"application/json":{"schema":{"type":"object","properties":{"success":{"type":"boolean","example":true},"data":{"type":"object","properties":{"chefs":{"type":"array","description":"Array of popular chefs","items":{"type":"object","properties":{"first_name":{"type":"string","description":"Chef's first name","example":"John"},"last_name":{"type":"string","description":"Chef's last name","example":"Smith"},"profile_image":{"type":"string","nullable":true,"description":"Chef's profile image URL","example":"https://example.com/chef-avatar.jpg"},"latitude":{"type":"number","nullable":true,"description":"Chef's latitude coordinate","example":40.7128},"longitude":{"type":"number","nullable":true,"description":"Chef's longitude coordinate","example":-74.006},"address":{"type":"string","nullable":true,"description":"Chef's city","example":"New York"},"experience":{"type":"string","nullable":true,"description":"Chef's specialties","example":"Italian, Mediterranean, Seafood"},"profile_id":{"type":"string","description":"Chef profile ID","example":"j1234567890abcdef"},"user_id":{"type":"string","description":"Chef user ID","example":"j1234567890abcdef"},"is_approved":{"type":"boolean","description":"Whether chef is approved","example":true},"status":{"type":"string","description":"Chef status","example":"active"},"avg_rating":{"type":"number","description":"Average rating","example":4.5},"total_reviews":{"type":"number","description":"Total number of reviews","example":25},"total_orders":{"type":"number","description":"Total orders (currently 0)","example":0},"is_available":{"type":"boolean","description":"Whether chef is available","example":true},"created_at":{"type":"string","format":"date-time","description":"Profile creation date","example":"2024-01-15T10:30:00.000Z"},"updated_at":{"type":"string","format":"date-time","description":"Profile last update date","example":"2024-01-15T10:30:00.000Z"},"distance":{"type":"number","nullable":true,"description":"Distance from customer (if location provided)"},"relevance_score":{"type":"number","nullable":true,"description":"Relevance score for search"},"matched_cuisines":{"type":"array","nullable":true,"description":"Matched cuisines for search","items":{"type":"string"}},"profile_image_url":{"type":"string","nullable":true,"description":"Profile image URL","example":"https://example.com/chef-avatar.jpg"}}}}}},"message":{"type":"string","example":"Success"}}}}}},"500":{"description":"Internal server error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}}},"security":[]}},"/customer/profile/me":{"get":{"summary":"Get Customer Profile","description":"Get the current customer's profile information","tags":["Customer"],"responses":{"200":{"description":"Customer profile retrieved successfully","content":{"application/json":{"schema":{"type":"object","properties":{"success":{"type":"boolean","example":true},"data":{"type":"object","properties":{"user":{"type":"object","description":"Customer profile (excluding sensitive fields)","properties":{"_id":{"type":"string","description":"Customer ID","example":"j1234567890abcdef"},"email":{"type":"string","format":"email","example":"customer@example.com"},"name":{"type":"string","example":"John Doe"},"roles":{"type":"array","items":{"type":"string"},"example":["customer"]},"_creationTime":{"type":"number","description":"Account creation timestamp","example":1640995200000},"avatar":{"type":"string","nullable":true,"description":"Profile picture URL","example":"https://example.com/avatar.jpg"},"phone":{"type":"string","nullable":true,"description":"Phone number","example":"+1234567890"},"preferences":{"type":"object","nullable":true,"description":"Customer preferences"}}}}},"message":{"type":"string","example":"Success"}}}}}},"401":{"description":"Unauthorized - invalid or missing authentication","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}},"403":{"description":"Forbidden - only customers can access this endpoint","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}},"404":{"description":"User not found","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}},"500":{"description":"Internal server error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}}},"security":[{"bearerAuth":[]}]}},"/admin/orders/bulk-refund-eligibility":{"post":{"summary":"Bulk Refund Eligibility Management","description":"Manage refund eligibility for multiple orders in bulk (admin only)","tags":["Admin","Orders","Refunds"],"requestBody":{"required":true,"content":{"application/json":{"schema":{"type":"object","required":["orders"],"properties":{"orders":{"type":"array","description":"Array of order refund eligibility operations","items":{"type":"object","required":["orderId","action","reason","description"],"properties":{"orderId":{"type":"string","description":"Order ID to modify","example":"j1234567890abcdef"},"action":{"type":"string","enum":["mark_non_refundable","mark_refundable","extend_window"],"description":"Action to perform on the order","example":"mark_non_refundable"},"reason":{"type":"string","description":"Reason for the action","example":"Customer request"},"description":{"type":"string","description":"Detailed description of the action","example":"Customer requested immediate refund ineligibility"},"newWindowHours":{"type":"number","nullable":true,"description":"New refund window in hours (for extend_window action)","example":48},"effectiveImmediately":{"type":"boolean","nullable":true,"description":"Whether to apply immediately (for mark_non_refundable action)","example":true},"metadata":{"type":"object","nullable":true,"description":"Additional metadata for the operation","example":{"adminNote":"Special case handling"}}}}},"globalReason":{"type":"string","nullable":true,"description":"Global reason applied to all orders if not specified individually","example":"Bulk admin operation"},"globalDescription":{"type":"string","nullable":true,"description":"Global description applied to all orders if not specified individually","example":"Bulk refund eligibility update"}}}}}},"responses":{"200":{"description":"Bulk refund eligibility operation completed","content":{"application/json":{"schema":{"type":"object","properties":{"success":{"type":"boolean","example":true},"data":{"type":"object","properties":{"success":{"type":"boolean","example":true},"results":{"type":"object","properties":{"successful":{"type":"array","description":"Successfully processed orders","items":{"type":"object","properties":{"orderId":{"type":"string","example":"j1234567890abcdef"},"action":{"type":"string","example":"mark_non_refundable"},"orderStatus":{"type":"string","example":"completed"},"isRefundable":{"type":"boolean","example":false},"processedAt":{"type":"number","example":1640995200000}}}},"failed":{"type":"array","description":"Failed operations","items":{"type":"object","properties":{"orderId":{"type":"string","example":"j1234567890abcdef"},"error":{"type":"string","example":"Order not found"},"action":{"type":"string","example":"mark_refundable"}}}},"summary":{"type":"object","properties":{"total":{"type":"number","example":10},"successful":{"type":"number","example":8},"failed":{"type":"number","example":2}}}}},"message":{"type":"string","example":"Bulk operation completed: 8 successful, 2 failed"}}},"message":{"type":"string","example":"Success"}}}}}},"400":{"description":"Validation error - invalid request body","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}},"401":{"description":"Unauthorized - invalid or missing authentication","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}},"403":{"description":"Forbidden - admin access required","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}},"500":{"description":"Internal server error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}}},"security":[{"bearerAuth":[]}]}},"/admin/analytics/sales":{"get":{"summary":"Get Sales Analytics","description":"Retrieve comprehensive sales analytics data (admin only)","tags":["Admin","Analytics","Sales"],"parameters":[{"in":"query","name":"start","schema":{"type":"number"},"description":"Start timestamp for date range filter","example":1640995200000},{"in":"query","name":"end","schema":{"type":"number"},"description":"End timestamp for date range filter","example":1641081600000}],"responses":{"200":{"description":"Sales analytics retrieved successfully","content":{"application/json":{"schema":{"type":"object","properties":{"success":{"type":"boolean","example":true},"data":{"type":"object","properties":{"sales_by_status":{"type":"object","description":"Sales breakdown by order status","example":{"confirmed":{"count":150,"revenue":3750},"pending":{"count":25,"revenue":625},"cancelled":{"count":10,"revenue":0}}},"sales_by_cuisine":{"type":"object","description":"Sales breakdown by cuisine type","example":{"italian":{"count":45,"revenue":1125},"chinese":{"count":38,"revenue":950},"indian":{"count":32,"revenue":800}}},"total_revenue":{"type":"number","description":"Total revenue in the period","example":4375},"total_orders":{"type":"number","description":"Total number of orders","example":185},"average_order_value":{"type":"number","description":"Average order value","example":23.65},"period":{"type":"string","description":"Analysis period","example":"2024-01-01T00:00:00.000Z - 2024-01-31T23:59:59.999Z"}}},"message":{"type":"string","example":"Success"}}}}}},"401":{"description":"Unauthorized - invalid or missing authentication","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}},"403":{"description":"Forbidden - only admins can access this endpoint","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}},"500":{"description":"Internal server error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}}},"security":[{"bearerAuth":[]}]}},"/admin/analytics/top-chefs":{"get":{"summary":"Get Top Chefs Analytics","description":"Retrieve the top 5 chefs by order count for admin analytics dashboard","tags":["Admin","Analytics","Chefs"],"responses":{"200":{"description":"Top chefs data retrieved successfully","content":{"application/json":{"schema":{"type":"object","properties":{"success":{"type":"boolean","example":true},"data":{"type":"object","properties":{"topChefs":{"type":"array","description":"Array of top 5 chefs by order count","items":{"type":"object","properties":{"chef_id":{"type":"string","description":"Chef ID","example":"j1234567890abcdef"},"name":{"type":"string","nullable":true,"description":"Chef name","example":"Chef Mario"},"orders":{"type":"number","description":"Total number of orders","example":45},"revenue":{"type":"string","description":"Total revenue formatted as currency","example":"$2,450.75"},"rating":{"type":"number","description":"Average rating","example":4.8},"email":{"type":"string","nullable":true,"description":"Chef email","example":"chef.mario@example.com"},"avatar":{"type":"string","nullable":true,"description":"Chef avatar URL","example":"https://example.com/avatar.jpg"}}}}}},"message":{"type":"string","example":"Success"}}}}}},"401":{"description":"Unauthorized - invalid or missing authentication","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}},"403":{"description":"Forbidden - only admins can access analytics","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}},"500":{"description":"Internal server error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}}},"security":[{"bearerAuth":[]}]}},"/admin/analytics/chefs":{"get":{"summary":"Get Chef Analytics","description":"Retrieve comprehensive analytics data for chefs (admin only)","tags":["Admin","Analytics","Chef"],"parameters":[{"in":"query","name":"start","schema":{"type":"number"},"description":"Start timestamp for date range filter","example":1640995200000},{"in":"query","name":"end","schema":{"type":"number"},"description":"End timestamp for date range filter","example":1641081600000}],"responses":{"200":{"description":"Chef analytics retrieved successfully","content":{"application/json":{"schema":{"type":"object","properties":{"success":{"type":"boolean","example":true},"data":{"type":"object","properties":{"total_chefs":{"type":"number","description":"Total number of chefs","example":150},"approved_chefs":{"type":"number","description":"Number of approved chefs","example":120},"pending_chefs":{"type":"number","description":"Number of pending chef applications","example":25},"active_chefs":{"type":"number","description":"Number of currently active chefs","example":95},"chef_distribution_by_cuisine":{"type":"object","description":"Distribution of chefs by cuisine type","example":{"italian":35,"chinese":28,"indian":22,"mexican":18,"japanese":15}},"period":{"type":"string","description":"Analysis period","example":"2024-01-01T00:00:00.000Z - 2024-01-31T23:59:59.999Z"},"chef_locations":{"type":"array","description":"Geographic distribution of chefs","items":{"type":"object","properties":{"chefId":{"type":"string","example":"j1234567890abcdef"},"name":{"type":"string","example":"Chef Mario"},"location":{"type":"object","properties":{"coordinates":{"type":"array","items":{"type":"number"},"example":[-0.1276,51.5074]},"address":{"type":"string","example":"123 Baker Street, London"}}},"specialties":{"type":"array","items":{"type":"string"},"example":["italian","pasta"]},"status":{"type":"string","example":"active"},"rating":{"type":"number","example":4.8}}}}}},"message":{"type":"string","example":"Success"}}}}}},"401":{"description":"Unauthorized - invalid or missing authentication","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}},"403":{"description":"Forbidden - only admins can access this endpoint","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}},"500":{"description":"Internal server error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}}},"security":[{"bearerAuth":[]}]}},"/admin/analytics/recent-orders":{"get":{"summary":"Get Recent Orders Analytics","description":"Retrieve the 20 most recent orders for admin analytics dashboard","tags":["Admin","Analytics","Orders"],"responses":{"200":{"description":"Recent orders retrieved successfully","content":{"application/json":{"schema":{"type":"object","properties":{"success":{"type":"boolean","example":true},"data":{"type":"object","properties":{"recentOrders":{"type":"array","description":"Array of recent orders (max 20)","items":{"type":"object","properties":{"_id":{"type":"string","description":"Order ID","example":"j1234567890abcdef"},"order_id":{"type":"string","description":"Public order ID","example":"ORD-12345"},"customer_id":{"type":"string","description":"Customer ID","example":"j1234567890abcdef"},"chef_id":{"type":"string","description":"Chef ID","example":"j1234567890abcdef"},"status":{"type":"string","enum":["pending","confirmed","preparing","ready","delivered","completed","cancelled"],"description":"Order status","example":"preparing"},"total_amount":{"type":"number","description":"Total order amount","example":25.99},"payment_status":{"type":"string","enum":["pending","processing","completed","failed","refunded"],"description":"Payment status","example":"completed"},"createdAt":{"type":"string","format":"date-time","description":"Order creation timestamp","example":"2024-01-15T10:00:00.000Z"},"updatedAt":{"type":"string","format":"date-time","description":"Last update timestamp","example":"2024-01-15T15:30:00.000Z"}}}}}},"message":{"type":"string","example":"Success"}}}}}},"401":{"description":"Unauthorized - invalid or missing authentication","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}},"403":{"description":"Forbidden - only admins can access analytics","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}},"500":{"description":"Internal server error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}}},"security":[{"bearerAuth":[]}]}},"/admin/analytics/revenue-chart":{"get":{"summary":"Get Revenue Chart Data","description":"Retrieve revenue data grouped by date for admin analytics dashboard","tags":["Admin","Analytics","Revenue"],"parameters":[{"in":"query","name":"range","required":false,"schema":{"type":"string","enum":["day","week","month"],"default":"day"},"description":"Time range for grouping revenue data","example":"day"}],"responses":{"200":{"description":"Revenue chart data retrieved successfully","content":{"application/json":{"schema":{"type":"object","properties":{"success":{"type":"boolean","example":true},"data":{"type":"object","properties":{"revenueChart":{"type":"array","description":"Array of revenue data points","items":{"type":"object","properties":{"date":{"type":"string","description":"Date in ISO format (YYYY-MM-DD for day, YYYY-MM-DD for week, YYYY-MM for month)","example":"2024-01-15"},"revenue":{"type":"number","description":"Total revenue for the date period","example":1250.75}}}}}},"message":{"type":"string","example":"Success"}}}}}},"401":{"description":"Unauthorized - invalid or missing authentication","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}},"403":{"description":"Forbidden - only admins can access analytics","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}},"500":{"description":"Internal server error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}}},"security":[{"bearerAuth":[]}]}},"/admin/chef/cuisines":{"get":{"summary":"Get All Chef Cuisines","description":"Retrieve all cuisine types available from chefs (admin only)","tags":["Admin","Chef","Cuisines"],"responses":{"200":{"description":"Chef cuisines retrieved successfully","content":{"application/json":{"schema":{"type":"object","properties":{"success":{"type":"boolean","example":true},"data":{"type":"object","properties":{"cuisines":{"type":"array","description":"Array of cuisine types","items":{"type":"object","properties":{"cuisine":{"type":"string","description":"Cuisine type name","example":"italian"},"count":{"type":"number","description":"Number of chefs offering this cuisine","example":25},"chefs":{"type":"array","description":"List of chefs offering this cuisine","items":{"type":"object","properties":{"chefId":{"type":"string","example":"j1234567890abcdef"},"name":{"type":"string","example":"Chef Mario"},"rating":{"type":"number","example":4.8},"location":{"type":"object","properties":{"city":{"type":"string","example":"London"},"coordinates":{"type":"array","items":{"type":"number"},"example":[-0.1276,51.5074]}}}}}},"total_dishes":{"type":"number","description":"Total dishes in this cuisine","example":150},"average_price":{"type":"number","description":"Average price for dishes in this cuisine","example":18.5}}}}}},"message":{"type":"string","example":"Success"}}}}}},"401":{"description":"Unauthorized - invalid or missing authentication","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}},"403":{"description":"Forbidden - only admins can access this endpoint","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}},"500":{"description":"Internal server error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}}},"security":[{"bearerAuth":[]}]}},"/admin/analytics/top-menus":{"get":{"summary":"Get Top Menus Analytics","description":"Retrieve the top 5 menu items by order count for admin analytics dashboard","tags":["Admin","Analytics","Menus"],"responses":{"200":{"description":"Top menus data retrieved successfully","content":{"application/json":{"schema":{"type":"object","properties":{"success":{"type":"boolean","example":true},"data":{"type":"object","properties":{"topMenus":{"type":"array","description":"Array of top 5 menu items by order count","items":{"type":"object","properties":{"menu_id":{"type":"string","description":"Menu item ID","example":"j1234567890abcdef"},"name":{"type":"string","nullable":true,"description":"Menu item name","example":"Spaghetti Carbonara"},"orders":{"type":"number","description":"Total number of orders for this menu item","example":32},"revenue":{"type":"string","description":"Total revenue formatted as currency","example":"$1,280.00"},"chef":{"type":"string","nullable":true,"description":"Chef name who created the menu item","example":"Chef Mario"},"chef_id":{"type":"string","nullable":true,"description":"Chef ID","example":"j1234567890abcdef"},"dish_image":{"type":"string","nullable":true,"description":"Menu item image URL","example":"https://example.com/dish-image.jpg"}}}}}},"message":{"type":"string","example":"Success"}}}}}},"401":{"description":"Unauthorized - invalid or missing authentication","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}},"403":{"description":"Forbidden - only admins can access analytics","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}},"500":{"description":"Internal server error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}}},"security":[{"bearerAuth":[]}]}},"/admin/analytics/users":{"get":{"summary":"Get User Analytics","description":"Retrieve comprehensive user analytics data (admin only)","tags":["Admin","Analytics","User Management"],"parameters":[{"in":"query","name":"start","schema":{"type":"number"},"description":"Start timestamp for date range filter","example":1640995200000},{"in":"query","name":"end","schema":{"type":"number"},"description":"End timestamp for date range filter","example":1641081600000}],"responses":{"200":{"description":"User analytics retrieved successfully","content":{"application/json":{"schema":{"type":"object","properties":{"success":{"type":"boolean","example":true},"data":{"type":"object","properties":{"total_users":{"type":"number","description":"Total number of users","example":1250},"customers":{"type":"number","description":"Number of customer users","example":1100},"chefs":{"type":"number","description":"Number of chef users","example":120},"admins":{"type":"number","description":"Number of admin users","example":5},"staff":{"type":"number","description":"Number of staff users","example":25},"active_users":{"type":"number","description":"Number of active users","example":1180},"user_growth":{"type":"array","description":"Daily user growth data","items":{"type":"object","properties":{"date":{"type":"string","format":"date","example":"2024-01-15"},"total_users":{"type":"number","example":1250},"new_users":{"type":"number","example":15}}}},"user_distribution":{"type":"object","description":"User distribution by role","example":{"customer":88,"chef":9.6,"staff":2,"admin":0.4}},"period":{"type":"string","description":"Analysis period","example":"2024-01-01T00:00:00.000Z - 2024-01-31T23:59:59.999Z"}}},"message":{"type":"string","example":"Success"}}}}}},"401":{"description":"Unauthorized - invalid or missing authentication","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}},"403":{"description":"Forbidden - only admins can access this endpoint","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}},"500":{"description":"Internal server error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}}},"security":[{"bearerAuth":[]}]}}}}